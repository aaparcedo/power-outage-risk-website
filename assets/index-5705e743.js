(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();function H(){return function(){throw new Error("Unimplemented abstract method.")}()}var Ps=0;function nt(i){return i.ol_uid||(i.ol_uid=String(++Ps))}var Ss="6.15.1",Is=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ls=function(i){Is(e,i);function e(t){var r=this,n="v"+Ss.split("-")[0],o="Assertion failed. See https://openlayers.org/en/"+n+"/doc/errors/#"+t+" for details.";return r=i.call(this,o)||this,r.code=t,r.name="AssertionError",r.message=o,r}return e}(Error);const No=Ls;var Ds=function(){function i(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}return i.prototype.preventDefault=function(){this.defaultPrevented=!0},i.prototype.stopPropagation=function(){this.propagationStopped=!0},i}();const ee=Ds,Je={PROPERTYCHANGE:"propertychange"};var Ms=function(){function i(){this.disposed=!1}return i.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},i.prototype.disposeInternal=function(){},i}();const zr=Ms;function Vr(i,e){return i>e?1:i<e?-1:0}function Yn(i,e,t){var r=i.length;if(i[0]<=e)return 0;if(e<=i[r-1])return r-1;var n=void 0;if(t>0){for(n=1;n<r;++n)if(i[n]<e)return n-1}else if(t<0){for(n=1;n<r;++n)if(i[n]<=e)return n}else for(n=1;n<r;++n){if(i[n]==e)return n;if(i[n]<e)return typeof t=="function"?t(e,i[n-1],i[n])>0?n-1:n:i[n-1]-e<e-i[n]?n-1:n}return r-1}function bs(i,e){for(var t=Array.isArray(e)?e:[e],r=t.length,n=0;n<r;n++)i[i.length]=t[n]}function Zn(i,e){var t=i.length;if(t!==e.length)return!1;for(var r=0;r<t;r++)if(i[r]!==e[r])return!1;return!0}function Ns(i,e,t){var r=e||Vr;return i.every(function(n,o){if(o===0)return!0;var a=r(i[o-1],n);return!(a>0||t&&a===0)})}function He(){return!0}function kr(){return!1}function tr(){}function Fs(i){var e=!1,t,r,n;return function(){var o=Array.prototype.slice.call(arguments);return(!e||this!==n||!Zn(o,r))&&(e=!0,n=this,r=o,t=i.apply(this,arguments)),t}}function Gs(i){function e(){var t;try{t=i()}catch(r){return Promise.reject(r)}return t instanceof Promise?t:Promise.resolve(t)}return e()}var tt=typeof Object.assign=="function"?Object.assign:function(i,e){if(i==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(i),r=1,n=arguments.length;r<n;++r){var o=arguments[r];if(o!=null)for(var a in o)o.hasOwnProperty(a)&&(t[a]=o[a])}return t};function nr(i){for(var e in i)delete i[e]}var Us=typeof Object.values=="function"?Object.values:function(i){var e=[];for(var t in i)e.push(i[t]);return e};function js(i){var e;for(e in i)return!1;return!e}var Bs=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Xs=function(i){Bs(e,i);function e(t){var r=i.call(this)||this;return r.eventTarget_=t,r.pendingRemovals_=null,r.dispatching_=null,r.listeners_=null,r}return e.prototype.addEventListener=function(t,r){if(!(!t||!r)){var n=this.listeners_||(this.listeners_={}),o=n[t]||(n[t]=[]);o.indexOf(r)===-1&&o.push(r)}},e.prototype.dispatchEvent=function(t){var r=typeof t=="string",n=r?t:t.type,o=this.listeners_&&this.listeners_[n];if(o){var a=r?new ee(t):t;a.target||(a.target=this.eventTarget_||this);var s=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});n in s||(s[n]=0,l[n]=0),++s[n];for(var u,c=0,h=o.length;c<h;++c)if("handleEvent"in o[c]?u=o[c].handleEvent(a):u=o[c].call(this,a),u===!1||a.propagationStopped){u=!1;break}if(--s[n]===0){var f=l[n];for(delete l[n];f--;)this.removeEventListener(n,tr);delete s[n]}return u}},e.prototype.disposeInternal=function(){this.listeners_&&nr(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_&&this.listeners_[t]||void 0},e.prototype.hasListener=function(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1},e.prototype.removeEventListener=function(t,r){var n=this.listeners_&&this.listeners_[t];if(n){var o=n.indexOf(r);o!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[o]=tr,++this.pendingRemovals_[t]):(n.splice(o,1),n.length===0&&delete this.listeners_[t]))}},e}(zr);const Ge=Xs,M={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function Y(i,e,t,r,n){if(r&&r!==i&&(t=t.bind(r)),n){var o=t;t=function(){i.removeEventListener(e,t),o.apply(this,arguments)}}var a={target:i,type:e,listener:t};return i.addEventListener(e,t),a}function Sr(i,e,t,r){return Y(i,e,t,r,!0)}function et(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),nr(i))}var Ks=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Yr=function(i){Ks(e,i);function e(){var t=i.call(this)||this;return t.on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t}return e.prototype.changed=function(){++this.revision_,this.dispatchEvent(M.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.onInternal=function(t,r){if(Array.isArray(t)){for(var n=t.length,o=new Array(n),a=0;a<n;++a)o[a]=Y(this,t[a],r);return o}else return Y(this,t,r)},e.prototype.onceInternal=function(t,r){var n;if(Array.isArray(t)){var o=t.length;n=new Array(o);for(var a=0;a<o;++a)n[a]=Sr(this,t[a],r)}else n=Sr(this,t,r);return r.ol_key=n,n},e.prototype.unInternal=function(t,r){var n=r.ol_key;if(n)zs(n);else if(Array.isArray(t))for(var o=0,a=t.length;o<a;++o)this.removeEventListener(t[o],r);else this.removeEventListener(t,r)},e}(Ge);Yr.prototype.on;Yr.prototype.once;Yr.prototype.un;function zs(i){if(Array.isArray(i))for(var e=0,t=i.length;e<t;++e)et(i[e]);else et(i)}const Fo=Yr;var Go=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Bi=function(i){Go(e,i);function e(t,r,n){var o=i.call(this,t)||this;return o.key=r,o.oldValue=n,o}return e}(ee),Vs=function(i){Go(e,i);function e(t){var r=i.call(this)||this;return r.on,r.once,r.un,nt(r),r.values_=null,t!==void 0&&r.setProperties(t),r}return e.prototype.get=function(t){var r;return this.values_&&this.values_.hasOwnProperty(t)&&(r=this.values_[t]),r},e.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},e.prototype.getProperties=function(){return this.values_&&tt({},this.values_)||{}},e.prototype.hasProperties=function(){return!!this.values_},e.prototype.notify=function(t,r){var n;n="change:".concat(t),this.hasListener(n)&&this.dispatchEvent(new Bi(n,t,r)),n=Je.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new Bi(n,t,r))},e.prototype.addChangeListener=function(t,r){this.addEventListener("change:".concat(t),r)},e.prototype.removeChangeListener=function(t,r){this.removeEventListener("change:".concat(t),r)},e.prototype.set=function(t,r,n){var o=this.values_||(this.values_={});if(n)o[t]=r;else{var a=o[t];o[t]=r,a!==r&&this.notify(t,a)}},e.prototype.setProperties=function(t,r){for(var n in t)this.set(n,t[n],r)},e.prototype.applyProperties=function(t){t.values_&&tt(this.values_||(this.values_={}),t.values_)},e.prototype.unset=function(t,r){if(this.values_&&t in this.values_){var n=this.values_[t];delete this.values_[t],js(this.values_)&&(this.values_=null),r||this.notify(t,n)}},e}(Fo);const kt=Vs,Pt={ADD:"add",REMOVE:"remove"};var Uo=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Xi={LENGTH:"length"},dr=function(i){Uo(e,i);function e(t,r,n){var o=i.call(this,t)||this;return o.element=r,o.index=n,o}return e}(ee),ks=function(i){Uo(e,i);function e(t,r){var n=i.call(this)||this;n.on,n.once,n.un;var o=r||{};if(n.unique_=!!o.unique,n.array_=t||[],n.unique_)for(var a=0,s=n.array_.length;a<s;++a)n.assertUnique_(n.array_[a],a);return n.updateLength_(),n}return e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var r=0,n=t.length;r<n;++r)this.push(t[r]);return this},e.prototype.forEach=function(t){for(var r=this.array_,n=0,o=r.length;n<o;++n)t(r[n],n,r)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(Xi.LENGTH)},e.prototype.insertAt=function(t,r){this.unique_&&this.assertUnique_(r),this.array_.splice(t,0,r),this.updateLength_(),this.dispatchEvent(new dr(Pt.ADD,r,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var r=this.getLength();return this.insertAt(r,t),this.getLength()},e.prototype.remove=function(t){for(var r=this.array_,n=0,o=r.length;n<o;++n)if(r[n]===t)return this.removeAt(n)},e.prototype.removeAt=function(t){var r=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new dr(Pt.REMOVE,r,t)),r},e.prototype.setAt=function(t,r){var n=this.getLength();if(t<n){this.unique_&&this.assertUnique_(r,t);var o=this.array_[t];this.array_[t]=r,this.dispatchEvent(new dr(Pt.REMOVE,o,t)),this.dispatchEvent(new dr(Pt.ADD,r,t))}else{for(var a=n;a<t;++a)this.insertAt(a,void 0);this.insertAt(t,r)}},e.prototype.updateLength_=function(){this.set(Xi.LENGTH,this.array_.length)},e.prototype.assertUnique_=function(t,r){for(var n=0,o=this.array_.length;n<o;++n)if(this.array_[n]===t&&n!==r)throw new No(58)},e}(kt);const bt=ks;function $(i,e){if(!i)throw new No(e)}const Rt={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};var Mt={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},Ys={9001:Mt.METERS,9002:Mt.FEET,9003:Mt.USFEET,9101:Mt.RADIANS,9102:Mt.DEGREES};function Ki(i){return Ys[i]}var jt={};jt[Mt.RADIANS]=6370997/(2*Math.PI);jt[Mt.DEGREES]=2*Math.PI*6370997/360;jt[Mt.FEET]=.3048;jt[Mt.METERS]=1;jt[Mt.USFEET]=1200/3937;const Jt=Mt;var te=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",Zs=te.indexOf("firefox")!==-1,$s=te.indexOf("safari")!==-1&&te.indexOf("chrom")==-1,Hs=$s&&!!(te.indexOf("version/15.4")>=0||te.match(/cpu (os|iphone os) 15_4 like mac os x/)),Ws=te.indexOf("webkit")!==-1&&te.indexOf("edge")==-1,qs=te.indexOf("macintosh")!==-1,jo=typeof devicePixelRatio<"u"?devicePixelRatio:1,Bo=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Qs=typeof Image<"u"&&Image.prototype.decode,Xo=function(){var i=!1;try{var e=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return i}(),$n=new Array(6);function Ut(){return[1,0,0,1,0,0]}function wr(i){return Zr(i,1,0,0,1,0,0)}function Hn(i,e){var t=i[0],r=i[1],n=i[2],o=i[3],a=i[4],s=i[5],l=e[0],u=e[1],c=e[2],h=e[3],f=e[4],p=e[5];return i[0]=t*l+n*u,i[1]=r*l+o*u,i[2]=t*c+n*h,i[3]=r*c+o*h,i[4]=t*f+n*p+a,i[5]=r*f+o*p+s,i}function Zr(i,e,t,r,n,o,a){return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i[4]=o,i[5]=a,i}function ct(i,e){var t=e[0],r=e[1];return e[0]=i[0]*t+i[2]*r+i[4],e[1]=i[1]*t+i[3]*r+i[5],e}function Ko(i,e){var t=Math.cos(e),r=Math.sin(e);return Hn(i,Zr($n,t,r,-r,t,0,0))}function Sn(i,e,t){return Hn(i,Zr($n,e,0,0,t,0,0))}function Js(i,e,t){return Hn(i,Zr($n,1,0,0,1,e,t))}function he(i,e,t,r,n,o,a,s){var l=Math.sin(o),u=Math.cos(o);return i[0]=r*u,i[1]=n*l,i[2]=-r*l,i[3]=n*u,i[4]=a*r*u-s*r*l+e,i[5]=a*n*l+s*n*u+t,i}function zo(i,e){var t=tl(e);$(t!==0,32);var r=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=e[5];return i[0]=a/t,i[1]=-n/t,i[2]=-o/t,i[3]=r/t,i[4]=(o*l-a*s)/t,i[5]=-(r*l-n*s)/t,i}function tl(i){return i[0]*i[3]-i[1]*i[2]}var zi;function el(i){var e="matrix("+i.join(", ")+")";if(Bo)return e;var t=zi||(zi=document.createElement("div"));return t.style.transform=e,t.style.transform}const ht={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function In(i){for(var e=de(),t=0,r=i.length;t<r;++t)Cr(e,i[t]);return e}function rl(i,e){return e?(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e):i.slice()}function Vo(i,e,t){var r,n;return e<i[0]?r=i[0]-e:i[2]<e?r=e-i[2]:r=0,t<i[1]?n=i[1]-t:i[3]<t?n=t-i[3]:n=0,r*r+n*n}function fe(i,e){return ko(i,e[0],e[1])}function nl(i,e){return i[0]<=e[0]&&e[2]<=i[2]&&i[1]<=e[1]&&e[3]<=i[3]}function ko(i,e,t){return i[0]<=e&&e<=i[2]&&i[1]<=t&&t<=i[3]}function Vi(i,e){var t=i[0],r=i[1],n=i[2],o=i[3],a=e[0],s=e[1],l=ht.UNKNOWN;return a<t?l=l|ht.LEFT:a>n&&(l=l|ht.RIGHT),s<r?l=l|ht.BELOW:s>o&&(l=l|ht.ABOVE),l===ht.UNKNOWN&&(l=ht.INTERSECTING),l}function de(){return[1/0,1/0,-1/0,-1/0]}function be(i,e,t,r,n){return n?(n[0]=i,n[1]=e,n[2]=t,n[3]=r,n):[i,e,t,r]}function $r(i){return be(1/0,1/0,-1/0,-1/0,i)}function il(i,e){var t=i[0],r=i[1];return be(t,r,t,r,e)}function ol(i,e,t,r,n){var o=$r(n);return Yo(o,i,e,t,r)}function Ln(i,e){return i[0]==e[0]&&i[2]==e[2]&&i[1]==e[1]&&i[3]==e[3]}function al(i,e){return e[0]<i[0]&&(i[0]=e[0]),e[2]>i[2]&&(i[2]=e[2]),e[1]<i[1]&&(i[1]=e[1]),e[3]>i[3]&&(i[3]=e[3]),i}function Cr(i,e){e[0]<i[0]&&(i[0]=e[0]),e[0]>i[2]&&(i[2]=e[0]),e[1]<i[1]&&(i[1]=e[1]),e[1]>i[3]&&(i[3]=e[1])}function Yo(i,e,t,r,n){for(;t<r;t+=n)sl(i,e[t],e[t+1]);return i}function sl(i,e,t){i[0]=Math.min(i[0],e),i[1]=Math.min(i[1],t),i[2]=Math.max(i[2],e),i[3]=Math.max(i[3],t)}function Zo(i,e){var t;return t=e(Hr(i)),t||(t=e(Wr(i)),t)||(t=e(qr(i)),t)||(t=e(ve(i)),t)?t:!1}function Dn(i){var e=0;return Jr(i)||(e=ut(i)*St(i)),e}function Hr(i){return[i[0],i[1]]}function Wr(i){return[i[2],i[1]]}function Ne(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function ll(i,e){var t;return e==="bottom-left"?t=Hr(i):e==="bottom-right"?t=Wr(i):e==="top-left"?t=ve(i):e==="top-right"?t=qr(i):$(!1,13),t}function Mn(i,e,t,r,n){var o=bn(i,e,t,r),a=o[0],s=o[1],l=o[2],u=o[3],c=o[4],h=o[5],f=o[6],p=o[7];return be(Math.min(a,l,c,f),Math.min(s,u,h,p),Math.max(a,l,c,f),Math.max(s,u,h,p),n)}function bn(i,e,t,r){var n=e*r[0]/2,o=e*r[1]/2,a=Math.cos(t),s=Math.sin(t),l=n*a,u=n*s,c=o*a,h=o*s,f=i[0],p=i[1];return[f-l+h,p-u-c,f-l-h,p-u+c,f+l-h,p+u+c,f+l+h,p+u-c,f-l+h,p-u-c]}function St(i){return i[3]-i[1]}function Vt(i,e,t){var r=t||de();return Qr(i,e)?(i[0]>e[0]?r[0]=i[0]:r[0]=e[0],i[1]>e[1]?r[1]=i[1]:r[1]=e[1],i[2]<e[2]?r[2]=i[2]:r[2]=e[2],i[3]<e[3]?r[3]=i[3]:r[3]=e[3]):$r(r),r}function ve(i){return[i[0],i[3]]}function qr(i){return[i[2],i[3]]}function ut(i){return i[2]-i[0]}function Qr(i,e){return i[0]<=e[2]&&i[2]>=e[0]&&i[1]<=e[3]&&i[3]>=e[1]}function Jr(i){return i[2]<i[0]||i[3]<i[1]}function ul(i,e){return e?(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e):i}function cl(i,e,t){var r=!1,n=Vi(i,e),o=Vi(i,t);if(n===ht.INTERSECTING||o===ht.INTERSECTING)r=!0;else{var a=i[0],s=i[1],l=i[2],u=i[3],c=e[0],h=e[1],f=t[0],p=t[1],d=(p-h)/(f-c),v=void 0,g=void 0;o&ht.ABOVE&&!(n&ht.ABOVE)&&(v=f-(p-u)/d,r=v>=a&&v<=l),!r&&o&ht.RIGHT&&!(n&ht.RIGHT)&&(g=p-(f-l)*d,r=g>=s&&g<=u),!r&&o&ht.BELOW&&!(n&ht.BELOW)&&(v=f-(p-s)/d,r=v>=a&&v<=l),!r&&o&ht.LEFT&&!(n&ht.LEFT)&&(g=p-(f-a)*d,r=g>=s&&g<=u)}return r}var hl=function(){function i(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}return i.prototype.canWrapX=function(){return this.canWrapX_},i.prototype.getCode=function(){return this.code_},i.prototype.getExtent=function(){return this.extent_},i.prototype.getUnits=function(){return this.units_},i.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||jt[this.units_]},i.prototype.getWorldExtent=function(){return this.worldExtent_},i.prototype.getAxisOrientation=function(){return this.axisOrientation_},i.prototype.isGlobal=function(){return this.global_},i.prototype.setGlobal=function(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)},i.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},i.prototype.setDefaultTileGrid=function(e){this.defaultTileGrid_=e},i.prototype.setExtent=function(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)},i.prototype.setWorldExtent=function(e){this.worldExtent_=e},i.prototype.setGetPointResolution=function(e){this.getPointResolutionFunc_=e},i.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},i}();const Ir=hl;function at(i,e,t){return Math.min(Math.max(i,e),t)}var fl=function(){var i;return"cosh"in Math?i=Math.cosh:i=function(e){var t=Math.exp(e);return(t+1/t)/2},i}(),$o=function(){var i;return"log2"in Math?i=Math.log2:i=function(e){return Math.log(e)*Math.LOG2E},i}();function pl(i,e,t,r,n,o){var a=n-t,s=o-r;if(a!==0||s!==0){var l=((i-t)*a+(e-r)*s)/(a*a+s*s);l>1?(t=n,r=o):l>0&&(t+=a*l,r+=s*l)}return Pe(i,e,t,r)}function Pe(i,e,t,r){var n=t-i,o=r-e;return n*n+o*o}function dl(i){for(var e=i.length,t=0;t<e;t++){for(var r=t,n=Math.abs(i[t][t]),o=t+1;o<e;o++){var a=Math.abs(i[o][t]);a>n&&(n=a,r=o)}if(n===0)return null;var s=i[r];i[r]=i[t],i[t]=s;for(var l=t+1;l<e;l++)for(var u=-i[l][t]/i[t][t],c=t;c<e+1;c++)t==c?i[l][c]=0:i[l][c]+=u*i[t][c]}for(var h=new Array(e),f=e-1;f>=0;f--){h[f]=i[f][e]/i[f][f];for(var p=f-1;p>=0;p--)i[p][e]-=i[p][f]*h[f]}return h}function Or(i){return i*Math.PI/180}function Se(i,e){var t=i%e;return t*e<0?t+e:t}function vl(i,e,t){return i+t*(e-i)}function Ho(i,e){var t=Math.pow(10,e);return Math.round(i*t)/t}function vr(i,e){return Math.floor(Ho(i,e))}function gr(i,e){return Math.ceil(Ho(i,e))}var gl=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),ir=6378137,Ae=Math.PI*ir,_l=[-Ae,-Ae,Ae,Ae],yl=[-180,-85,180,85],_r=ir*Math.log(Math.tan(Math.PI/2)),ye=function(i){gl(e,i);function e(t){return i.call(this,{code:t,units:Jt.METERS,extent:_l,global:!0,worldExtent:yl,getPointResolution:function(r,n){return r/fl(n[1]/ir)}})||this}return e}(Ir),ki=[new ye("EPSG:3857"),new ye("EPSG:102100"),new ye("EPSG:102113"),new ye("EPSG:900913"),new ye("http://www.opengis.net/def/crs/EPSG/0/3857"),new ye("http://www.opengis.net/gml/srs/epsg.xml#3857")];function ml(i,e,t){var r=i.length,n=t>1?t:2,o=e;o===void 0&&(n>2?o=i.slice():o=new Array(r));for(var a=0;a<r;a+=n){o[a]=Ae*i[a]/180;var s=ir*Math.log(Math.tan(Math.PI*(+i[a+1]+90)/360));s>_r?s=_r:s<-_r&&(s=-_r),o[a+1]=s}return o}function El(i,e,t){var r=i.length,n=t>1?t:2,o=e;o===void 0&&(n>2?o=i.slice():o=new Array(r));for(var a=0;a<r;a+=n)o[a]=180*i[a]/Ae,o[a+1]=360*Math.atan(Math.exp(i[a+1]/ir))/Math.PI-90;return o}var Tl=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Rl=6378137,Yi=[-180,-90,180,90],xl=Math.PI*Rl/180,ae=function(i){Tl(e,i);function e(t,r){return i.call(this,{code:t,units:Jt.DEGREES,extent:Yi,axisOrientation:r,global:!0,metersPerUnit:xl,worldExtent:Yi})||this}return e}(Ir),Zi=[new ae("CRS:84"),new ae("EPSG:4326","neu"),new ae("urn:ogc:def:crs:OGC:1.3:CRS84"),new ae("urn:ogc:def:crs:OGC:2:84"),new ae("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new ae("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ae("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],Nn={};function wl(i){return Nn[i]||Nn[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Cl(i,e){Nn[i]=e}var Ie={};function Lr(i,e,t){var r=i.getCode(),n=e.getCode();r in Ie||(Ie[r]={}),Ie[r][n]=t}function Ol(i,e){var t;return i in Ie&&e in Ie[i]&&(t=Ie[i][e]),t}function Al(i,e){return i[0]+=+e[0],i[1]+=+e[1],i}function Dr(i,e){for(var t=!0,r=i.length-1;r>=0;--r)if(i[r]!=e[r]){t=!1;break}return t}function Wn(i,e){var t=Math.cos(e),r=Math.sin(e),n=i[0]*t-i[1]*r,o=i[1]*t+i[0]*r;return i[0]=n,i[1]=o,i}function Pl(i,e){return i[0]*=e,i[1]*=e,i}function Sl(i,e){if(e.canWrapX()){var t=ut(e.getExtent()),r=Il(i,e,t);r&&(i[0]-=r*t)}return i}function Il(i,e,t){var r=e.getExtent(),n=0;if(e.canWrapX()&&(i[0]<r[0]||i[0]>r[2])){var o=t||ut(r);n=Math.floor((i[0]-r[0])/o)}return n}var Ll=63710088e-1;function $i(i,e,t){var r=t||Ll,n=Or(i[1]),o=Or(e[1]),a=(o-n)/2,s=Or(e[0]-i[0])/2,l=Math.sin(a)*Math.sin(a)+Math.sin(s)*Math.sin(s)*Math.cos(n)*Math.cos(o);return 2*r*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}var Fn=!0;function Dl(i){var e=i===void 0?!0:i;Fn=!e}function qn(i,e,t){var r;if(e!==void 0){for(var n=0,o=i.length;n<o;++n)e[n]=i[n];r=e}else r=i.slice();return r}function Wo(i,e,t){if(e!==void 0&&i!==e){for(var r=0,n=i.length;r<n;++r)e[r]=i[r];i=e}return i}function Ml(i){Cl(i.getCode(),i),Lr(i,i,qn)}function bl(i){i.forEach(Ml)}function xt(i){return typeof i=="string"?wl(i):i||null}function Hi(i,e,t,r){i=xt(i);var n,o=i.getPointResolutionFunc();if(o){if(n=o(e,t),r&&r!==i.getUnits()){var a=i.getMetersPerUnit();a&&(n=n*a/jt[r])}}else{var s=i.getUnits();if(s==Jt.DEGREES&&!r||r==Jt.DEGREES)n=e;else{var l=Jn(i,xt("EPSG:4326"));if(l===Wo&&s!==Jt.DEGREES)n=e*i.getMetersPerUnit();else{var u=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];u=l(u,u,2);var c=$i(u.slice(0,2),u.slice(2,4)),h=$i(u.slice(4,6),u.slice(6,8));n=(c+h)/2}var a=r?jt[r]:i.getMetersPerUnit();a!==void 0&&(n/=a)}}return n}function Wi(i){bl(i),i.forEach(function(e){i.forEach(function(t){e!==t&&Lr(e,t,qn)})})}function Nl(i,e,t,r){i.forEach(function(n){e.forEach(function(o){Lr(n,o,t),Lr(o,n,r)})})}function Qn(i,e){return i?typeof i=="string"?xt(i):i:xt(e)}function xe(i,e){if(i===e)return!0;var t=i.getUnits()===e.getUnits();if(i.getCode()===e.getCode())return t;var r=Jn(i,e);return r===qn&&t}function Jn(i,e){var t=i.getCode(),r=e.getCode(),n=Ol(t,r);return n||(n=Wo),n}function Mr(i,e){var t=xt(i),r=xt(e);return Jn(t,r)}function Fl(i,e,t){var r=Mr(e,t);return r(i,void 0,i.length)}var Gl=null;function Ul(){return Gl}function br(i,e){return i}function Xt(i,e){return Fn&&!Dr(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(Fn=!1,console.warn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i}function qo(i,e){return i}function Qt(i,e){return i}function jl(){Wi(ki),Wi(Zi),Nl(Zi,ki,ml,El)}jl();function Bl(i,e,t,r,n,o){for(var a=o||[],s=0,l=e;l<t;l+=r){var u=i[l],c=i[l+1];a[s++]=n[0]*u+n[2]*c+n[4],a[s++]=n[1]*u+n[3]*c+n[5]}return o&&a.length!=s&&(a.length=s),a}function Xl(i,e,t,r,n,o,a){for(var s=a||[],l=Math.cos(n),u=Math.sin(n),c=o[0],h=o[1],f=0,p=e;p<t;p+=r){var d=i[p]-c,v=i[p+1]-h;s[f++]=c+d*l-v*u,s[f++]=h+d*u+v*l;for(var g=p+2;g<p+r;++g)s[f++]=i[g]}return a&&s.length!=f&&(s.length=f),s}function Kl(i,e,t,r,n,o,a,s){for(var l=s||[],u=a[0],c=a[1],h=0,f=e;f<t;f+=r){var p=i[f]-u,d=i[f+1]-c;l[h++]=u+n*p,l[h++]=c+o*d;for(var v=f+2;v<f+r;++v)l[h++]=i[v]}return s&&l.length!=h&&(l.length=h),l}function zl(i,e,t,r,n,o,a){for(var s=a||[],l=0,u=e;u<t;u+=r){s[l++]=i[u]+n,s[l++]=i[u+1]+o;for(var c=u+2;c<u+r;++c)s[l++]=i[c]}return a&&s.length!=l&&(s.length=l),s}var Vl=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),qi=Ut(),kl=function(i){Vl(e,i);function e(){var t=i.call(this)||this;return t.extent_=de(),t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=Fs(function(r,n,o){if(!o)return this.getSimplifiedGeometry(n);var a=this.clone();return a.applyTransform(o),a.getSimplifiedGeometry(n)}),t}return e.prototype.simplifyTransformed=function(t,r){return this.simplifyTransformedInternal(this.getRevision(),t,r)},e.prototype.clone=function(){return H()},e.prototype.closestPointXY=function(t,r,n,o){return H()},e.prototype.containsXY=function(t,r){var n=this.getClosestPoint([t,r]);return n[0]===t&&n[1]===r},e.prototype.getClosestPoint=function(t,r){var n=r||[NaN,NaN];return this.closestPointXY(t[0],t[1],n,1/0),n},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return H()},e.prototype.getExtent=function(t){if(this.extentRevision_!=this.getRevision()){var r=this.computeExtent(this.extent_);(isNaN(r[0])||isNaN(r[1]))&&$r(r),this.extentRevision_=this.getRevision()}return ul(this.extent_,t)},e.prototype.rotate=function(t,r){H()},e.prototype.scale=function(t,r,n){H()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return H()},e.prototype.getType=function(){return H()},e.prototype.applyTransform=function(t){H()},e.prototype.intersectsExtent=function(t){return H()},e.prototype.translate=function(t,r){H()},e.prototype.transform=function(t,r){var n=xt(t),o=n.getUnits()==Jt.TILE_PIXELS?function(a,s,l){var u=n.getExtent(),c=n.getWorldExtent(),h=St(c)/St(u);return he(qi,c[0],c[3],h,-h,0,0,0),Bl(a,0,a.length,l,qi,s),Mr(n,r)(a,s,l)}:Mr(n,r);return this.applyTransform(o),this},e}(kt);const Yl=kl;var Zl=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),$l=function(i){Zl(e,i);function e(){var t=i.call(this)||this;return t.layout=Rt.XY,t.stride=2,t.flatCoordinates=null,t}return e.prototype.computeExtent=function(t){return ol(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return H()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var r=this.getSimplifiedGeometryInternal(t),n=r.getFlatCoordinates();return n.length<this.flatCoordinates.length?r:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,r){this.stride=Qi(t),this.layout=t,this.flatCoordinates=r},e.prototype.setCoordinates=function(t,r){H()},e.prototype.setLayout=function(t,r,n){var o;if(t)o=Qi(t);else{for(var a=0;a<n;++a)if(r.length===0){this.layout=Rt.XY,this.stride=2;return}else r=r[0];o=r.length,t=Hl(o)}this.layout=t,this.stride=o},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,r){var n=this.getFlatCoordinates();if(n){var o=this.getStride();Xl(n,0,n.length,o,t,r,n),this.changed()}},e.prototype.scale=function(t,r,n){var o=r;o===void 0&&(o=t);var a=n;a||(a=Ne(this.getExtent()));var s=this.getFlatCoordinates();if(s){var l=this.getStride();Kl(s,0,s.length,l,t,o,a,s),this.changed()}},e.prototype.translate=function(t,r){var n=this.getFlatCoordinates();if(n){var o=this.getStride();zl(n,0,n.length,o,t,r,n),this.changed()}},e}(Yl);function Hl(i){var e;return i==2?e=Rt.XY:i==3?e=Rt.XYZ:i==4&&(e=Rt.XYZM),e}function Qi(i){var e;return i==Rt.XY?e=2:i==Rt.XYZ||i==Rt.XYM?e=3:i==Rt.XYZM&&(e=4),e}const ti=$l;function Ji(i,e,t,r,n,o,a){var s=i[e],l=i[e+1],u=i[t]-s,c=i[t+1]-l,h;if(u===0&&c===0)h=e;else{var f=((n-s)*u+(o-l)*c)/(u*u+c*c);if(f>1)h=t;else if(f>0){for(var p=0;p<r;++p)a[p]=vl(i[e+p],i[t+p],f);a.length=r;return}else h=e}for(var p=0;p<r;++p)a[p]=i[h+p];a.length=r}function Qo(i,e,t,r,n){var o=i[e],a=i[e+1];for(e+=r;e<t;e+=r){var s=i[e],l=i[e+1],u=Pe(o,a,s,l);u>n&&(n=u),o=s,a=l}return n}function Wl(i,e,t,r,n){for(var o=0,a=t.length;o<a;++o){var s=t[o];n=Qo(i,e,s,r,n),e=s}return n}function Jo(i,e,t,r,n,o,a,s,l,u,c){if(e==t)return u;var h,f;if(n===0)if(f=Pe(a,s,i[e],i[e+1]),f<u){for(h=0;h<r;++h)l[h]=i[e+h];return l.length=r,f}else return u;for(var p=c||[NaN,NaN],d=e+r;d<t;)if(Ji(i,d-r,d,r,a,s,p),f=Pe(a,s,p[0],p[1]),f<u){for(u=f,h=0;h<r;++h)l[h]=p[h];l.length=r,d+=r}else d+=r*Math.max((Math.sqrt(f)-Math.sqrt(u))/n|0,1);if(o&&(Ji(i,t-r,e,r,a,s,p),f=Pe(a,s,p[0],p[1]),f<u)){for(u=f,h=0;h<r;++h)l[h]=p[h];l.length=r}return u}function ql(i,e,t,r,n,o,a,s,l,u,c){for(var h=c||[NaN,NaN],f=0,p=t.length;f<p;++f){var d=t[f];u=Jo(i,e,d,r,n,o,a,s,l,u,h),e=d}return u}function Ql(i,e,t,r){for(var n=0,o=t.length;n<o;++n)i[e++]=t[n];return e}function ta(i,e,t,r){for(var n=0,o=t.length;n<o;++n)for(var a=t[n],s=0;s<r;++s)i[e++]=a[s];return e}function Jl(i,e,t,r,n){for(var o=n||[],a=0,s=0,l=t.length;s<l;++s){var u=ta(i,e,t[s],r);o[a++]=u,e=u}return o.length=a,o}function tu(i,e,t,r,n,o,a){var s=(t-e)/r;if(s<3){for(;e<t;e+=r)o[a++]=i[e],o[a++]=i[e+1];return a}var l=new Array(s);l[0]=1,l[s-1]=1;for(var u=[e,t-r],c=0;u.length>0;){for(var h=u.pop(),f=u.pop(),p=0,d=i[f],v=i[f+1],g=i[h],E=i[h+1],_=f+r;_<h;_+=r){var m=i[_],y=i[_+1],T=pl(m,y,d,v,g,E);T>p&&(c=_,p=T)}p>n&&(l[(c-e)/r]=1,f+r<c&&u.push(f,c),c+r<h&&u.push(c,h))}for(var _=0;_<s;++_)l[_]&&(o[a++]=i[e+_*r],o[a++]=i[e+_*r+1]);return a}function me(i,e){return e*Math.round(i/e)}function eu(i,e,t,r,n,o,a){if(e==t)return a;var s=me(i[e],n),l=me(i[e+1],n);e+=r,o[a++]=s,o[a++]=l;var u,c;do if(u=me(i[e],n),c=me(i[e+1],n),e+=r,e==t)return o[a++]=u,o[a++]=c,a;while(u==s&&c==l);for(;e<t;){var h=me(i[e],n),f=me(i[e+1],n);if(e+=r,!(h==u&&f==c)){var p=u-s,d=c-l,v=h-s,g=f-l;if(p*g==d*v&&(p<0&&v<p||p==v||p>0&&v>p)&&(d<0&&g<d||d==g||d>0&&g>d)){u=h,c=f;continue}o[a++]=u,o[a++]=c,s=u,l=c,u=h,c=f}}return o[a++]=u,o[a++]=c,a}function ru(i,e,t,r,n,o,a,s){for(var l=0,u=t.length;l<u;++l){var c=t[l];a=eu(i,e,c,r,n,o,a),s.push(a),e=c}return a}function ea(i,e,t,r,n){for(var o=n!==void 0?n:[],a=0,s=e;s<t;s+=r)o[a++]=i.slice(s,s+r);return o.length=a,o}function nu(i,e,t,r,n){for(var o=n!==void 0?n:[],a=0,s=0,l=t.length;s<l;++s){var u=t[s];o[a++]=ea(i,e,u,r,o[a]),e=u}return o.length=a,o}function ra(i,e,t,r){for(var n=0,o=i[t-r],a=i[t-r+1];e<t;e+=r){var s=i[e],l=i[e+1];n+=a*s-o*l,o=s,a=l}return n/2}function iu(i,e,t,r){for(var n=0,o=0,a=t.length;o<a;++o){var s=t[o];n+=ra(i,e,s,r),e=s}return n}var ou=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),au=function(i){ou(e,i);function e(t,r){var n=i.call(this)||this;return n.maxDelta_=-1,n.maxDeltaRevision_=-1,r!==void 0&&!Array.isArray(t[0])?n.setFlatCoordinates(r,t):n.setCoordinates(t,r),n}return e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,r,n,o){return o<Vo(this.getExtent(),t,r)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Qo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Jo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,r,n,o))},e.prototype.getArea=function(){return ra(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return ea(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[];return r.length=tu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r,0),new e(r,Rt.XY)},e.prototype.getType=function(){return"LinearRing"},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,r){this.setLayout(r,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ta(this.flatCoordinates,0,t,this.stride),this.changed()},e}(ti);const to=au;var su=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),lu=function(i){su(e,i);function e(t,r){var n=i.call(this)||this;return n.setCoordinates(t,r),n}return e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,r,n,o){var a=this.flatCoordinates,s=Pe(t,r,a[0],a[1]);if(s<o){for(var l=this.stride,u=0;u<l;++u)n[u]=a[u];return n.length=l,s}else return o},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return il(this.flatCoordinates,t)},e.prototype.getType=function(){return"Point"},e.prototype.intersectsExtent=function(t){return ko(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,r){this.setLayout(r,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ql(this.flatCoordinates,0,t,this.stride),this.changed()},e}(ti);const uu=lu;function cu(i,e,t,r,n){var o=Zo(n,function(a){return!ue(i,e,t,r,a[0],a[1])});return!o}function ue(i,e,t,r,n,o){for(var a=0,s=i[t-r],l=i[t-r+1];e<t;e+=r){var u=i[e],c=i[e+1];l<=o?c>o&&(u-s)*(o-l)-(n-s)*(c-l)>0&&a++:c<=o&&(u-s)*(o-l)-(n-s)*(c-l)<0&&a--,s=u,l=c}return a!==0}function na(i,e,t,r,n,o){if(t.length===0||!ue(i,e,t[0],r,n,o))return!1;for(var a=1,s=t.length;a<s;++a)if(ue(i,t[a-1],t[a],r,n,o))return!1;return!0}function hu(i,e,t,r,n,o,a){for(var s,l,u,c,h,f,p,d=n[o+1],v=[],g=0,E=t.length;g<E;++g){var _=t[g];for(c=i[_-r],f=i[_-r+1],s=e;s<_;s+=r)h=i[s],p=i[s+1],(d<=f&&p<=d||f<=d&&d<=p)&&(u=(d-f)/(p-f)*(h-c)+c,v.push(u)),c=h,f=p}var m=NaN,y=-1/0;for(v.sort(Vr),c=v[0],s=1,l=v.length;s<l;++s){h=v[s];var T=Math.abs(h-c);T>y&&(u=(c+h)/2,na(i,e,t,r,u,d)&&(m=u,y=T)),c=h}return isNaN(m)&&(m=n[o]),a?(a.push(m,d,y),a):[m,d,y]}function fu(i,e,t,r,n){var o;for(e+=r;e<t;e+=r)if(o=n(i.slice(e-r,e),i.slice(e,e+r)),o)return o;return!1}function ia(i,e,t,r,n){var o=Yo(de(),i,e,t,r);return Qr(n,o)?nl(n,o)||o[0]>=n[0]&&o[2]<=n[2]||o[1]>=n[1]&&o[3]<=n[3]?!0:fu(i,e,t,r,function(a,s){return cl(n,a,s)}):!1}function oa(i,e,t,r,n){return!!(ia(i,e,t,r,n)||ue(i,e,t,r,n[0],n[1])||ue(i,e,t,r,n[0],n[3])||ue(i,e,t,r,n[2],n[1])||ue(i,e,t,r,n[2],n[3]))}function pu(i,e,t,r,n){if(!oa(i,e,t[0],r,n))return!1;if(t.length===1)return!0;for(var o=1,a=t.length;o<a;++o)if(cu(i,t[o-1],t[o],r,n)&&!ia(i,t[o-1],t[o],r,n))return!1;return!0}function du(i,e,t,r){for(;e<t-r;){for(var n=0;n<r;++n){var o=i[e+n];i[e+n]=i[t-r+n],i[t-r+n]=o}e+=r,t-=r}}function aa(i,e,t,r){for(var n=0,o=i[t-r],a=i[t-r+1];e<t;e+=r){var s=i[e],l=i[e+1];n+=(s-o)*(l+a),o=s,a=l}return n===0?void 0:n>0}function vu(i,e,t,r,n){for(var o=n!==void 0?n:!1,a=0,s=t.length;a<s;++a){var l=t[a],u=aa(i,e,l,r);if(a===0){if(o&&u||!o&&!u)return!1}else if(o&&!u||!o&&u)return!1;e=l}return!0}function eo(i,e,t,r,n){for(var o=n!==void 0?n:!1,a=0,s=t.length;a<s;++a){var l=t[a],u=aa(i,e,l,r),c=a===0?o&&u||!o&&!u:o&&!u||!o&&u;c&&du(i,e,l,r),e=l}return e}var gu=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),sa=function(i){gu(e,i);function e(t,r,n){var o=i.call(this)||this;return o.ends_=[],o.flatInteriorPointRevision_=-1,o.flatInteriorPoint_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,r!==void 0&&n?(o.setFlatCoordinates(r,t),o.ends_=n):o.setCoordinates(t,r),o}return e.prototype.appendLinearRing=function(t){this.flatCoordinates?bs(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,r,n,o){return o<Vo(this.getExtent(),t,r)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Wl(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ql(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,r,n,o))},e.prototype.containsXY=function(t,r){return na(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,r)},e.prototype.getArea=function(){return iu(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var r;return t!==void 0?(r=this.getOrientedFlatCoordinates().slice(),eo(r,0,this.ends_,this.stride,t)):r=this.flatCoordinates,nu(r,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Ne(this.getExtent());this.flatInteriorPoint_=hu(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new uu(this.getFlatInteriorPoint(),Rt.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new to(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,r=this.flatCoordinates,n=this.ends_,o=[],a=0,s=0,l=n.length;s<l;++s){var u=n[s],c=new to(r.slice(a,u),t);o.push(c),a=u}return o},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;vu(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=eo(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[],n=[];return r.length=ru(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),r,0,n),new e(r,Rt.XY,n)},e.prototype.getType=function(){return"Polygon"},e.prototype.intersectsExtent=function(t){return pu(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,r){this.setLayout(r,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=Jl(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()},e}(ti);function ro(i){var e=i[0],t=i[1],r=i[2],n=i[3],o=[e,t,e,n,r,n,r,t,e,t];return new sa(o,Rt.XY,[o.length])}const yt={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},At={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function no(i){return i[0]>0&&i[1]>0}function _u(i,e,t){return t===void 0&&(t=[0,0]),t[0]=i[0]*e+.5|0,t[1]=i[1]*e+.5|0,t}function gt(i,e){return Array.isArray(i)?i:(e===void 0?e=[i,i]:(e[0]=i,e[1]=i),e)}var la=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,ua=/^([a-z]*)$|^hsla?\(.*\)$/i;function yu(i){return typeof i=="string"?i:Eu(i)}function ca(i){var e=document.createElement("div");if(e.style.color=i,e.style.color!==""){document.body.appendChild(e);var t=getComputedStyle(e).color;return document.body.removeChild(e),t}else return""}var ha=function(){var i=1024,e={},t=0;return function(r){var n;if(e.hasOwnProperty(r))n=e[r];else{if(t>=i){var o=0;for(var a in e)o++&3||(delete e[a],--t)}n=mu(r),e[r]=n,++t}return n}}();function Gn(i){return Array.isArray(i)?i:ha(i)}function mu(i){var e,t,r,n,o;if(ua.exec(i)&&(i=ca(i)),la.exec(i)){var a=i.length-1,s=void 0;a<=4?s=1:s=2;var l=a===4||a===8;e=parseInt(i.substr(1+0*s,s),16),t=parseInt(i.substr(1+1*s,s),16),r=parseInt(i.substr(1+2*s,s),16),l?n=parseInt(i.substr(1+3*s,s),16):n=255,s==1&&(e=(e<<4)+e,t=(t<<4)+t,r=(r<<4)+r,l&&(n=(n<<4)+n)),o=[e,t,r,n/255]}else i.indexOf("rgba(")==0?(o=i.slice(5,-1).split(",").map(Number),io(o)):i.indexOf("rgb(")==0?(o=i.slice(4,-1).split(",").map(Number),o.push(1),io(o)):$(!1,14);return o}function io(i){return i[0]=at(i[0]+.5|0,0,255),i[1]=at(i[1]+.5|0,0,255),i[2]=at(i[2]+.5|0,0,255),i[3]=at(i[3],0,1),i}function Eu(i){var e=i[0];e!=(e|0)&&(e=e+.5|0);var t=i[1];t!=(t|0)&&(t=t+.5|0);var r=i[2];r!=(r|0)&&(r=r+.5|0);var n=i[3]===void 0?1:Math.round(i[3]*100)/100;return"rgba("+e+","+t+","+r+","+n+")"}function Tu(i){return ua.test(i)&&(i=ca(i)),la.test(i)||i.indexOf("rgba(")===0||i.indexOf("rgb(")===0}function Nr(i,e,t,r){var n;return t&&t.length?n=t.shift():Bo?n=new OffscreenCanvas(i||300,e||300):n=document.createElement("canvas"),i&&(n.width=i),e&&(n.height=e),n.getContext("2d",r)}function Ru(i){var e=i.canvas;e.width=1,e.height=1,i.clearRect(0,0,1,1)}function oo(i,e){var t=e.parentNode;t&&t.replaceChild(i,e)}function Un(i){return i&&i.parentNode?i.parentNode.removeChild(i):null}function xu(i){for(;i.lastChild;)i.removeChild(i.lastChild)}function wu(i,e){for(var t=i.childNodes,r=0;;++r){var n=t[r],o=e[r];if(!n&&!o)break;if(n!==o){if(!n){i.appendChild(o);continue}if(!o){i.removeChild(n),--r;continue}i.insertBefore(o,n)}}}var yr="ol-hidden",tn="ol-unselectable",ei="ol-control",ao="ol-collapsed",Cu=new kt,Ou=new Ge;Ou.setSize=function(){console.warn("labelCache is deprecated.")};const z={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};var Au=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Pu=function(i){Au(e,i);function e(t){var r=i.call(this)||this;r.on,r.once,r.un,r.background_=t.background;var n=tt({},t);return typeof t.properties=="object"&&(delete n.properties,tt(n,t.properties)),n[z.OPACITY]=t.opacity!==void 0?t.opacity:1,$(typeof n[z.OPACITY]=="number",64),n[z.VISIBLE]=t.visible!==void 0?t.visible:!0,n[z.Z_INDEX]=t.zIndex,n[z.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,n[z.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,n[z.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,n[z.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,r.className_=n.className!==void 0?n.className:"ol-layer",delete n.className,r.setProperties(n),r.state_=null,r}return e.prototype.getBackground=function(){return this.background_},e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var r=this.state_||{layer:this,managed:t===void 0?!0:t},n=this.getZIndex();return r.opacity=at(Math.round(this.getOpacity()*100)/100,0,1),r.visible=this.getVisible(),r.extent=this.getExtent(),r.zIndex=n===void 0&&!r.managed?1/0:n,r.maxResolution=this.getMaxResolution(),r.minResolution=Math.max(this.getMinResolution(),0),r.minZoom=this.getMinZoom(),r.maxZoom=this.getMaxZoom(),this.state_=r,r},e.prototype.getLayersArray=function(t){return H()},e.prototype.getLayerStatesArray=function(t){return H()},e.prototype.getExtent=function(){return this.get(z.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(z.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(z.MIN_RESOLUTION)},e.prototype.getMinZoom=function(){return this.get(z.MIN_ZOOM)},e.prototype.getMaxZoom=function(){return this.get(z.MAX_ZOOM)},e.prototype.getOpacity=function(){return this.get(z.OPACITY)},e.prototype.getSourceState=function(){return H()},e.prototype.getVisible=function(){return this.get(z.VISIBLE)},e.prototype.getZIndex=function(){return this.get(z.Z_INDEX)},e.prototype.setBackground=function(t){this.background_=t,this.changed()},e.prototype.setExtent=function(t){this.set(z.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(z.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(z.MIN_RESOLUTION,t)},e.prototype.setMaxZoom=function(t){this.set(z.MAX_ZOOM,t)},e.prototype.setMinZoom=function(t){this.set(z.MIN_ZOOM,t)},e.prototype.setOpacity=function(t){$(typeof t=="number",64),this.set(z.OPACITY,t)},e.prototype.setVisible=function(t){this.set(z.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(z.Z_INDEX,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),i.prototype.disposeInternal.call(this)},e}(kt);const fa=Pu;var Su=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Iu=function(i){Su(e,i);function e(t){var r=this,n=tt({},t);delete n.source,r=i.call(this,n)||this,r.on,r.once,r.un,r.mapPrecomposeKey_=null,r.mapRenderKey_=null,r.sourceChangeKey_=null,r.renderer_=null,r.rendered=!1,t.render&&(r.render=t.render),t.map&&r.setMap(t.map),r.addChangeListener(z.SOURCE,r.handleSourcePropertyChange_);var o=t.source?t.source:null;return r.setSource(o),r}return e.prototype.getLayersArray=function(t){var r=t||[];return r.push(this),r},e.prototype.getLayerStatesArray=function(t){var r=t||[];return r.push(this.getLayerState()),r},e.prototype.getSource=function(){return this.get(z.SOURCE)||null},e.prototype.getRenderSource=function(){return this.getSource()},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():"undefined"},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(et(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=Y(t,M.CHANGE,this.handleSourceChange_,this)),this.changed()},e.prototype.getFeatures=function(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise(function(r){return r([])})},e.prototype.getData=function(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)},e.prototype.render=function(t,r){var n=this.getRenderer();if(n.prepareFrame(t))return this.rendered=!0,n.renderFrame(t,r)},e.prototype.unrender=function(){this.rendered=!1},e.prototype.setMapInternal=function(t){t||this.unrender(),this.set(z.MAP,t)},e.prototype.getMapInternal=function(){return this.get(z.MAP)},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(et(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(et(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Y(t,yt.PRECOMPOSE,function(r){var n=r,o=n.frameState.layerStatesArray,a=this.getLayerState(!1);$(!o.some(function(s){return s.layer===a.layer}),67),o.push(a)},this),this.mapRenderKey_=Y(this,M.CHANGE,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(z.SOURCE,t)},e.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},e.prototype.hasRenderer=function(){return!!this.renderer_},e.prototype.createRenderer=function(){return null},e.prototype.disposeInternal=function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),i.prototype.disposeInternal.call(this)},e}(fa);function Fr(i,e){if(!i.visible)return!1;var t=e.resolution;if(t<i.minResolution||t>=i.maxResolution)return!1;var r=e.zoom;return r>i.minZoom&&r<=i.maxZoom}const ri=Iu;var Lu=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Du=function(i){Lu(e,i);function e(t){var r=i.call(this)||this;return r.ready=!0,r.boundHandleImageChange_=r.handleImageChange_.bind(r),r.layer_=t,r.declutterExecutorGroup=null,r}return e.prototype.getFeatures=function(t){return H()},e.prototype.getData=function(t){return null},e.prototype.prepareFrame=function(t){return H()},e.prototype.renderFrame=function(t,r){return H()},e.prototype.loadedTileCallback=function(t,r,n){t[r]||(t[r]={}),t[r][n.tileCoord.toString()]=n},e.prototype.createLoadedTileFinder=function(t,r,n){return(function(o,a){var s=this.loadedTileCallback.bind(this,n,o);return t.forEachLoadedTile(r,o,a,s)}).bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,r,n,o,a){},e.prototype.getDataAtPixel=function(t,r,n){return null},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){var r=t.target;r.getState()===At.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var r=t.getState();return r!=At.LOADED&&r!=At.ERROR&&t.addEventListener(M.CHANGE,this.boundHandleImageChange_),r==At.IDLE&&(t.load(),r=t.getState()),r==At.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()},e.prototype.disposeInternal=function(){delete this.layer_,i.prototype.disposeInternal.call(this)},e}(Fo);const pa=Du;var Mu=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),bu=function(i){Mu(e,i);function e(t,r,n,o){var a=i.call(this,t)||this;return a.inversePixelTransform=r,a.frameState=n,a.context=o,a}return e}(ee);const We=bu;var Nu=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),we=null;function Fu(){var i=document.createElement("canvas");i.width=1,i.height=1,we=i.getContext("2d")}var Gu=function(i){Nu(e,i);function e(t){var r=i.call(this,t)||this;return r.container=null,r.renderedResolution,r.tempTransform=Ut(),r.pixelTransform=Ut(),r.inversePixelTransform=Ut(),r.context=null,r.containerReused=!1,r.pixelContext_=null,r.frameState=null,r}return e.prototype.getImageData=function(t,r,n){we||Fu(),we.clearRect(0,0,1,1);var o;try{we.drawImage(t,r,n,1,1,0,0,1,1),o=we.getImageData(0,0,1,1).data}catch{return we=null,null}return o},e.prototype.getBackground=function(t){var r=this.getLayer(),n=r.getBackground();return typeof n=="function"&&(n=n(t.viewState.resolution)),n||void 0},e.prototype.useContainer=function(t,r,n){var o=this.getLayer().getClassName(),a,s;if(t&&t.className===o&&(!n||t&&t.style.backgroundColor&&Zn(Gn(t.style.backgroundColor),Gn(n)))){var l=t.firstElementChild;l instanceof HTMLCanvasElement&&(s=l.getContext("2d"))}if(s&&s.canvas.style.transform===r?(this.container=t,this.context=s,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){a=document.createElement("div"),a.className=o;var u=a.style;u.position="absolute",u.width="100%",u.height="100%",s=Nr();var l=s.canvas;a.appendChild(l),u=l.style,u.position="absolute",u.left="0",u.transformOrigin="top left",this.container=a,this.context=s}!this.containerReused&&n&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=n)},e.prototype.clipUnrotated=function(t,r,n){var o=ve(n),a=qr(n),s=Wr(n),l=Hr(n);ct(r.coordinateToPixelTransform,o),ct(r.coordinateToPixelTransform,a),ct(r.coordinateToPixelTransform,s),ct(r.coordinateToPixelTransform,l);var u=this.inversePixelTransform;ct(u,o),ct(u,a),ct(u,s),ct(u,l),t.save(),t.beginPath(),t.moveTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(l[0]),Math.round(l[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,r,n){var o=this.getLayer();if(o.hasListener(t)){var a=new We(t,this.inversePixelTransform,n,r);o.dispatchEvent(a)}},e.prototype.preRender=function(t,r){this.frameState=r,this.dispatchRenderEvent_(yt.PRERENDER,t,r)},e.prototype.postRender=function(t,r){this.dispatchRenderEvent_(yt.POSTRENDER,t,r)},e.prototype.getRenderTransform=function(t,r,n,o,a,s,l){var u=a/2,c=s/2,h=o/r,f=-h,p=-t[0]+l,d=-t[1];return he(this.tempTransform,u,c,h,f,-n,p,d)},e.prototype.getDataAtPixel=function(t,r,n){var o=ct(this.inversePixelTransform,t.slice()),a=this.context,s=this.getLayer(),l=s.getExtent();if(l){var u=ct(r.pixelToCoordinateTransform,t.slice());if(!fe(l,u))return null}var c=Math.round(o[0]),h=Math.round(o[1]),f=this.pixelContext_;if(!f){var p=document.createElement("canvas");p.width=1,p.height=1,f=p.getContext("2d"),this.pixelContext_=f}f.clearRect(0,0,1,1);var d;try{f.drawImage(a.canvas,c,h,1,1,0,0,1,1),d=f.getImageData(0,0,1,1).data}catch(v){return v.name==="SecurityError"?(this.pixelContext_=null,new Uint8Array):d}return d[3]===0?null:d},e.prototype.disposeInternal=function(){delete this.frameState,i.prototype.disposeInternal.call(this)},e}(pa);const Uu=Gu,Ot={ANIMATING:0,INTERACTING:1};var ju=function(){function i(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return i.prototype.clear=function(){this.cache_={},this.cacheSize_=0},i.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},i.prototype.expire=function(){if(this.canExpireCache()){var e=0;for(var t in this.cache_){var r=this.cache_[t];!(e++&3)&&!r.hasListener()&&(delete this.cache_[t],--this.cacheSize_)}}},i.prototype.get=function(e,t,r){var n=so(e,t,r);return n in this.cache_?this.cache_[n]:null},i.prototype.set=function(e,t,r,n){var o=so(e,t,r);this.cache_[o]=n,++this.cacheSize_},i.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},i}();function so(i,e,t){var r=t?yu(t):"null";return e+":"+i+":"+r}var da=new ju,Bu=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Xu=function(i){Bu(e,i);function e(t,r,n,o){var a=i.call(this)||this;return a.extent=t,a.pixelRatio_=n,a.resolution=r,a.state=o,a}return e.prototype.changed=function(){this.dispatchEvent(M.CHANGE)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return H()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){H()},e}(Ge);const Ku=Xu;var zu=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();(function(i){zu(e,i);function e(t,r,n,o,a,s){var l=i.call(this,t,r,n,At.IDLE)||this;return l.src_=o,l.image_=new Image,a!==null&&(l.image_.crossOrigin=a),l.unlisten_=null,l.state=At.IDLE,l.imageLoadFunction_=s,l}return e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=At.ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){this.resolution===void 0&&(this.resolution=St(this.extent)/this.image_.height),this.state=At.LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){(this.state==At.IDLE||this.state==At.ERROR)&&(this.state=At.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=va(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t,this.resolution=St(this.extent)/this.image_.height},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e})(Ku);function va(i,e,t){var r=i,n=!0,o=!1,a=!1,s=[Sr(r,M.LOAD,function(){a=!0,o||e()})];return r.src&&Qs?(o=!0,r.decode().then(function(){n&&e()}).catch(function(l){n&&(a?e():t())})):s.push(Sr(r,M.ERROR,t)),function(){n=!1,s.forEach(et)}}var Vu=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),ku=function(i){Vu(e,i);function e(t){var r=i.call(this)||this;r.projection=xt(t.projection),r.attributions_=lo(t.attributions),r.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,r.loading=!1,r.state_=t.state!==void 0?t.state:"ready",r.wrapX_=t.wrapX!==void 0?t.wrapX:!1,r.interpolate_=!!t.interpolate,r.viewResolver=null,r.viewRejector=null;var n=r;return r.viewPromise_=new Promise(function(o,a){n.viewResolver=o,n.viewRejector=a}),r}return e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection},e.prototype.getResolutions=function(){return H()},e.prototype.getView=function(){return this.viewPromise_},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.getInterpolate=function(){return this.interpolate_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=lo(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(kt);function lo(i){return i?Array.isArray(i)?function(e){return i}:typeof i=="function"?i:function(e){return[i]}:null}const Yu=ku,O={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function ga(i){return Math.pow(i,3)}function Ue(i){return 1-ga(1-i)}function Zu(i){return 3*i*i-2*i*i*i}function $u(i){return i}var Hu=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Wu=function(i){Hu(e,i);function e(t,r,n){var o=i.call(this)||this,a=n||{};return o.tileCoord=t,o.state=r,o.interimTile=null,o.key="",o.transition_=a.transition===void 0?250:a.transition,o.transitionStarts_={},o.interpolate=!!a.interpolate,o}return e.prototype.changed=function(){this.dispatchEvent(M.CHANGE)},e.prototype.release=function(){},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==O.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,r=this;do{if(t.getState()==O.LOADED){t.interimTile=null;break}else t.getState()==O.LOADING?r=t:t.getState()==O.IDLE?r.interimTile=t.interimTile:r=t;t=r.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){if(this.state!==O.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},e.prototype.load=function(){H()},e.prototype.getAlpha=function(t,r){if(!this.transition_)return 1;var n=this.transitionStarts_[t];if(!n)n=r,this.transitionStarts_[t]=n;else if(n===-1)return 1;var o=r-n+1e3/60;return o>=this.transition_?1:ga(o/this.transition_)},e.prototype.inTransition=function(t){return this.transition_?this.transitionStarts_[t]!==-1:!1},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(Ge);const ni=Wu;var qu=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Qu=function(i){qu(e,i);function e(t,r,n,o,a,s){var l=i.call(this,t,r,s)||this;return l.crossOrigin_=o,l.src_=n,l.key=n,l.image_=new Image,o!==null&&(l.image_.crossOrigin=o),l.unlisten_=null,l.tileLoadFunction_=a,l}return e.prototype.getImage=function(){return this.image_},e.prototype.setImage=function(t){this.image_=t,this.state=O.LOADED,this.unlistenImage_(),this.changed()},e.prototype.handleImageError_=function(){this.state=O.ERROR,this.unlistenImage_(),this.image_=Ju(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=O.LOADED:this.state=O.EMPTY,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==O.ERROR&&(this.state=O.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==O.IDLE&&(this.state=O.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=va(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(ni);function Ju(){var i=Nr(1,1);return i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1),i.canvas}const Gr=Qu;var tc=function(){function i(e,t,r){this.decay_=e,this.minVelocity_=t,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}return i.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},i.prototype.update=function(e,t){this.points_.push(e,t,Date.now())},i.prototype.end=function(){if(this.points_.length<6)return!1;var e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;for(var r=t-3;r>0&&this.points_[r+2]>e;)r-=3;var n=this.points_[t+2]-this.points_[r+2];if(n<1e3/60)return!1;var o=this.points_[t]-this.points_[r],a=this.points_[t+1]-this.points_[r+1];return this.angle_=Math.atan2(a,o),this.initialVelocity_=Math.sqrt(o*o+a*a)/n,this.initialVelocity_>this.minVelocity_},i.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},i.prototype.getAngle=function(){return this.angle_},i}();const ec=tc;var rc=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),nc=function(i){rc(e,i);function e(t){var r=i.call(this)||this;return r.map_=t,r}return e.prototype.dispatchRenderEvent=function(t,r){H()},e.prototype.calculateMatrices2D=function(t){var r=t.viewState,n=t.coordinateToPixelTransform,o=t.pixelToCoordinateTransform;he(n,t.size[0]/2,t.size[1]/2,1/r.resolution,-1/r.resolution,-r.rotation,-r.center[0],-r.center[1]),zo(o,n)},e.prototype.forEachFeatureAtCoordinate=function(t,r,n,o,a,s,l,u){var c,h=r.viewState;function f(j,F,G,L){return a.call(s,F,j?G:null,L)}var p=h.projection,d=Sl(t.slice(),p),v=[[0,0]];if(p.canWrapX()&&o){var g=p.getExtent(),E=ut(g);v.push([-E,0],[E,0])}for(var _=r.layerStatesArray,m=_.length,y=[],T=[],R=0;R<v.length;R++)for(var x=m-1;x>=0;--x){var C=_[x],P=C.layer;if(P.hasRenderer()&&Fr(C,h)&&l.call(u,P)){var I=P.getRenderer(),S=P.getSource();if(I&&S){var X=S.getWrapX()?d:t,V=f.bind(null,C.managed);T[0]=X[0]+v[R][0],T[1]=X[1]+v[R][1],c=I.forEachFeatureAtCoordinate(T,r,n,V,y)}if(c)return c}}if(y.length!==0){var Z=1/y.length;return y.forEach(function(j,F){return j.distanceSq+=F*Z}),y.sort(function(j,F){return j.distanceSq-F.distanceSq}),y.some(function(j){return c=j.callback(j.feature,j.layer,j.geometry)}),c}},e.prototype.forEachLayerAtPixel=function(t,r,n,o,a){return H()},e.prototype.hasFeatureAtCoordinate=function(t,r,n,o,a,s){var l=this.forEachFeatureAtCoordinate(t,r,n,o,He,this,a,s);return l!==void 0},e.prototype.getMap=function(){return this.map_},e.prototype.renderFrame=function(t){H()},e.prototype.scheduleExpireIconCache=function(t){da.canExpireCache()&&t.postRenderFunctions.push(ic)},e}(zr);function ic(i,e){da.expire()}const oc=nc;var ac=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),sc=function(i){ac(e,i);function e(t){var r=i.call(this,t)||this;r.fontChangeListenerKey_=Y(Cu,Je.PROPERTYCHANGE,t.redrawText.bind(t)),r.element_=document.createElement("div");var n=r.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",r.element_.className=tn+" ol-layers";var o=t.getViewport();return o.insertBefore(r.element_,o.firstChild||null),r.children_=[],r.renderedVisible_=!0,r}return e.prototype.dispatchRenderEvent=function(t,r){var n=this.getMap();if(n.hasListener(t)){var o=new We(t,void 0,r);n.dispatchEvent(o)}},e.prototype.disposeInternal=function(){et(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),i.prototype.disposeInternal.call(this)},e.prototype.renderFrame=function(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(yt.PRECOMPOSE,t);var r=t.layerStatesArray.sort(function(p,d){return p.zIndex-d.zIndex}),n=t.viewState;this.children_.length=0;for(var o=[],a=null,s=0,l=r.length;s<l;++s){var u=r[s];t.layerIndex=s;var c=u.layer,h=c.getSourceState();if(!Fr(u,n)||h!="ready"&&h!="undefined"){c.unrender();continue}var f=c.render(t,a);f&&(f!==a&&(this.children_.push(f),a=f),"getDeclutter"in c&&o.push(c))}for(var s=o.length-1;s>=0;--s)o[s].renderDeclutter(t);wu(this.element_,this.children_),this.dispatchRenderEvent(yt.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)},e.prototype.forEachLayerAtPixel=function(t,r,n,o,a){for(var s=r.viewState,l=r.layerStatesArray,u=l.length,c=u-1;c>=0;--c){var h=l[c],f=h.layer;if(f.hasRenderer()&&Fr(h,s)&&a(f)){var p=f.getRenderer(),d=p.getDataAtPixel(t,r,n);if(d){var v=o(f,d);if(v)return v}}}},e}(oc);const lc=sc;var _a=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Wt=function(i){_a(e,i);function e(t,r){var n=i.call(this,t)||this;return n.layer=r,n}return e}(ee),un={LAYERS:"layers"},uc=function(i){_a(e,i);function e(t){var r=this,n=t||{},o=tt({},n);delete o.layers;var a=n.layers;return r=i.call(this,o)||this,r.on,r.once,r.un,r.layersListenerKeys_=[],r.listenerKeys_={},r.addChangeListener(un.LAYERS,r.handleLayersChanged_),a?Array.isArray(a)?a=new bt(a.slice(),{unique:!0}):$(typeof a.getArray=="function",43):a=new bt(void 0,{unique:!0}),r.setLayers(a),r}return e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(et),this.layersListenerKeys_.length=0;var t=this.getLayers();this.layersListenerKeys_.push(Y(t,Pt.ADD,this.handleLayersAdd_,this),Y(t,Pt.REMOVE,this.handleLayersRemove_,this));for(var r in this.listenerKeys_)this.listenerKeys_[r].forEach(et);nr(this.listenerKeys_);for(var n=t.getArray(),o=0,a=n.length;o<a;o++){var s=n[o];this.registerLayerListeners_(s),this.dispatchEvent(new Wt("addlayer",s))}this.changed()},e.prototype.registerLayerListeners_=function(t){var r=[Y(t,Je.PROPERTYCHANGE,this.handleLayerChange_,this),Y(t,M.CHANGE,this.handleLayerChange_,this)];t instanceof e&&r.push(Y(t,"addlayer",this.handleLayerGroupAdd_,this),Y(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[nt(t)]=r},e.prototype.handleLayerGroupAdd_=function(t){this.dispatchEvent(new Wt("addlayer",t.layer))},e.prototype.handleLayerGroupRemove_=function(t){this.dispatchEvent(new Wt("removelayer",t.layer))},e.prototype.handleLayersAdd_=function(t){var r=t.element;this.registerLayerListeners_(r),this.dispatchEvent(new Wt("addlayer",r)),this.changed()},e.prototype.handleLayersRemove_=function(t){var r=t.element,n=nt(r);this.listenerKeys_[n].forEach(et),delete this.listenerKeys_[n],this.dispatchEvent(new Wt("removelayer",r)),this.changed()},e.prototype.getLayers=function(){return this.get(un.LAYERS)},e.prototype.setLayers=function(t){var r=this.getLayers();if(r)for(var n=r.getArray(),o=0,a=n.length;o<a;++o)this.dispatchEvent(new Wt("removelayer",n[o]));this.set(un.LAYERS,t)},e.prototype.getLayersArray=function(t){var r=t!==void 0?t:[];return this.getLayers().forEach(function(n){n.getLayersArray(r)}),r},e.prototype.getLayerStatesArray=function(t){var r=t!==void 0?t:[],n=r.length;this.getLayers().forEach(function(c){c.getLayerStatesArray(r)});var o=this.getLayerState(),a=o.zIndex;!t&&o.zIndex===void 0&&(a=0);for(var s=n,l=r.length;s<l;s++){var u=r[s];u.opacity*=o.opacity,u.visible=u.visible&&o.visible,u.maxResolution=Math.min(u.maxResolution,o.maxResolution),u.minResolution=Math.max(u.minResolution,o.minResolution),u.minZoom=Math.max(u.minZoom,o.minZoom),u.maxZoom=Math.min(u.maxZoom,o.maxZoom),o.extent!==void 0&&(u.extent!==void 0?u.extent=Vt(u.extent,o.extent):u.extent=o.extent),u.zIndex===void 0&&(u.zIndex=a)}return r},e.prototype.getSourceState=function(){return"ready"},e}(fa);const en=uc;var cc=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),hc=function(i){cc(e,i);function e(t,r,n){var o=i.call(this,t)||this;return o.map=r,o.frameState=n!==void 0?n:null,o}return e}(ee);const Ce=hc;var fc=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),pc=function(i){fc(e,i);function e(t,r,n,o,a,s){var l=i.call(this,t,r,a)||this;return l.originalEvent=n,l.pixel_=null,l.coordinate_=null,l.dragging=o!==void 0?o:!1,l.activePointers=s,l}return Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!1,configurable:!0}),e.prototype.preventDefault=function(){i.prototype.preventDefault.call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){i.prototype.stopPropagation.call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()},e}(Ce);const $t=pc,J={SINGLECLICK:"singleclick",CLICK:M.CLICK,DBLCLICK:M.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},jn={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var dc=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),vc=function(i){dc(e,i);function e(t,r){var n=i.call(this,t)||this;n.map_=t,n.clickTimeoutId_,n.emulateClicks_=!1,n.dragging_=!1,n.dragListenerKeys_=[],n.moveTolerance_=r===void 0?1:r,n.down_=null;var o=n.map_.getViewport();return n.activePointers_=[],n.trackedTouches_={},n.element_=o,n.pointerdownListenerKey_=Y(o,jn.POINTERDOWN,n.handlePointerDown_,n),n.originalPointerMoveEvent_,n.relayedListenerKey_=Y(o,jn.POINTERMOVE,n.relayMoveEvent_,n),n.boundHandleTouchMove_=n.handleTouchMove_.bind(n),n.element_.addEventListener(M.TOUCHMOVE,n.boundHandleTouchMove_,Xo?{passive:!1}:!1),n}return e.prototype.emulateClick_=function(t){var r=new $t(J.CLICK,this.map_,t);this.dispatchEvent(r),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,r=new $t(J.DBLCLICK,this.map_,t),this.dispatchEvent(r)):this.clickTimeoutId_=setTimeout((function(){this.clickTimeoutId_=void 0;var n=new $t(J.SINGLECLICK,this.map_,t);this.dispatchEvent(n)}).bind(this),250)},e.prototype.updateActivePointers_=function(t){var r=t,n=r.pointerId;if(r.type==J.POINTERUP||r.type==J.POINTERCANCEL){delete this.trackedTouches_[n];for(var o in this.trackedTouches_)if(this.trackedTouches_[o].target!==r.target){delete this.trackedTouches_[o];break}}else(r.type==J.POINTERDOWN||r.type==J.POINTERMOVE)&&(this.trackedTouches_[n]=r);this.activePointers_=Us(this.trackedTouches_)},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var r=new $t(J.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(r),this.emulateClicks_&&!r.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(et),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},e.prototype.isMouseActionButton_=function(t){return t.button===0},e.prototype.handlePointerDown_=function(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);var r=new $t(J.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(r),this.down_={};for(var n in t){var o=t[n];this.down_[n]=typeof o=="function"?tr:o}if(this.dragListenerKeys_.length===0){var a=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Y(a,J.POINTERMOVE,this.handlePointerMove_,this),Y(a,J.POINTERUP,this.handlePointerUp_,this),Y(this.element_,J.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==a&&this.dragListenerKeys_.push(Y(this.element_.getRootNode(),J.POINTERUP,this.handlePointerUp_,this))}},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;var r=new $t(J.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(r)}},e.prototype.relayMoveEvent_=function(t){this.originalPointerMoveEvent_=t;var r=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new $t(J.POINTERMOVE,this.map_,t,r))},e.prototype.handleTouchMove_=function(t){var r=this.originalPointerMoveEvent_;(!r||r.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(et(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(M.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(et(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(et),this.dragListenerKeys_.length=0,this.element_=null,i.prototype.disposeInternal.call(this)},e}(Ge);const gc=vc,Ht={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},vt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};var Ur=1/0,_c=function(){function i(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return i.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,nr(this.queuedElements_)},i.prototype.dequeue=function(){var e=this.elements_,t=this.priorities_,r=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));var n=this.keyFunction_(r);return delete this.queuedElements_[n],r},i.prototype.enqueue=function(e){$(!(this.keyFunction_(e)in this.queuedElements_),31);var t=this.priorityFunction_(e);return t!=Ur?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1},i.prototype.getCount=function(){return this.elements_.length},i.prototype.getLeftChildIndex_=function(e){return e*2+1},i.prototype.getRightChildIndex_=function(e){return e*2+2},i.prototype.getParentIndex_=function(e){return e-1>>1},i.prototype.heapify_=function(){var e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)},i.prototype.isEmpty=function(){return this.elements_.length===0},i.prototype.isKeyQueued=function(e){return e in this.queuedElements_},i.prototype.isQueued=function(e){return this.isKeyQueued(this.keyFunction_(e))},i.prototype.siftUp_=function(e){for(var t=this.elements_,r=this.priorities_,n=t.length,o=t[e],a=r[e],s=e;e<n>>1;){var l=this.getLeftChildIndex_(e),u=this.getRightChildIndex_(e),c=u<n&&r[u]<r[l]?u:l;t[e]=t[c],r[e]=r[c],e=c}t[e]=o,r[e]=a,this.siftDown_(s,e)},i.prototype.siftDown_=function(e,t){for(var r=this.elements_,n=this.priorities_,o=r[t],a=n[t];t>e;){var s=this.getParentIndex_(t);if(n[s]>a)r[t]=r[s],n[t]=n[s],t=s;else break}r[t]=o,n[t]=a},i.prototype.reprioritize=function(){var e=this.priorityFunction_,t=this.elements_,r=this.priorities_,n=0,o=t.length,a,s,l;for(s=0;s<o;++s)a=t[s],l=e(a),l==Ur?delete this.queuedElements_[this.keyFunction_(a)]:(r[n]=l,t[n++]=a);t.length=n,r.length=n,this.heapify_()},i}();const yc=_c;var mc=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ec=function(i){mc(e,i);function e(t,r){var n=i.call(this,function(o){return t.apply(null,o)},function(o){return o[0].getKey()})||this;return n.boundHandleTileChange_=n.handleTileChange.bind(n),n.tileChangeCallback_=r,n.tilesLoading_=0,n.tilesLoadingKeys_={},n}return e.prototype.enqueue=function(t){var r=i.prototype.enqueue.call(this,t);if(r){var n=t[0];n.addEventListener(M.CHANGE,this.boundHandleTileChange_)}return r},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var r=t.target,n=r.getState();if(n===O.LOADED||n===O.ERROR||n===O.EMPTY){r.removeEventListener(M.CHANGE,this.boundHandleTileChange_);var o=r.getKey();o in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[o],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,r){for(var n=0,o,a,s;this.tilesLoading_<t&&n<r&&this.getCount()>0;)a=this.dequeue()[0],s=a.getKey(),o=a.getState(),o===O.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++n,a.load())},e}(yc);const Tc=Ec;function Rc(i,e,t,r,n){if(!i||!(t in i.wantedTiles)||!i.wantedTiles[t][e.getKey()])return Ur;var o=i.viewState.center,a=r[0]-o[0],s=r[1]-o[1];return 65536*Math.log(n)+Math.sqrt(a*a+s*s)/n}const Lt={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};var xc=42,ii=256;function uo(i,e,t){return function(r,n,o,a,s){if(r){if(!n&&!e)return r;var l=e?0:o[0]*n,u=e?0:o[1]*n,c=s?s[0]:0,h=s?s[1]:0,f=i[0]+l/2+c,p=i[2]-l/2+c,d=i[1]+u/2+h,v=i[3]-u/2+h;f>p&&(f=(p+f)/2,p=f),d>v&&(d=(v+d)/2,v=d);var g=at(r[0],f,p),E=at(r[1],d,v);if(a&&t&&n){var _=30*n;g+=-_*Math.log(1+Math.max(0,f-r[0])/_)+_*Math.log(1+Math.max(0,r[0]-p)/_),E+=-_*Math.log(1+Math.max(0,d-r[1])/_)+_*Math.log(1+Math.max(0,r[1]-v)/_)}return[g,E]}}}function wc(i){return i}function oi(i,e,t,r){var n=ut(e)/t[0],o=St(e)/t[1];return r?Math.min(i,Math.max(n,o)):Math.min(i,Math.min(n,o))}function ai(i,e,t){var r=Math.min(i,e),n=50;return r*=Math.log(1+n*Math.max(0,i/e-1))/n+1,t&&(r=Math.max(r,t),r/=Math.log(1+n*Math.max(0,t/i-1))/n+1),at(r,t/2,e*2)}function Cc(i,e,t,r){return function(n,o,a,s){if(n!==void 0){var l=i[0],u=i[i.length-1],c=t?oi(l,t,a,r):l;if(s){var h=e!==void 0?e:!0;return h?ai(n,c,u):at(n,u,c)}var f=Math.min(c,n),p=Math.floor(Yn(i,f,o));return i[p]>c&&p<i.length-1?i[p+1]:i[p]}else return}}function Oc(i,e,t,r,n,o){return function(a,s,l,u){if(a!==void 0){var c=n?oi(e,n,l,o):e,h=t!==void 0?t:0;if(u){var f=r!==void 0?r:!0;return f?ai(a,c,h):at(a,h,c)}var p=1e-9,d=Math.ceil(Math.log(e/c)/Math.log(i)-p),v=-s*(.5-p)+.5,g=Math.min(c,a),E=Math.floor(Math.log(e/g)/Math.log(i)+v),_=Math.max(d,E),m=e/Math.pow(i,_);return at(m,h,c)}else return}}function co(i,e,t,r,n){return function(o,a,s,l){if(o!==void 0){var u=r?oi(i,r,s,n):i,c=t!==void 0?t:!0;return!c||!l?at(o,e,u):ai(o,u,e)}else return}}function si(i){if(i!==void 0)return 0}function ho(i){if(i!==void 0)return i}function Ac(i){var e=2*Math.PI/i;return function(t,r){if(r)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function Pc(i){var e=i||Or(5);return function(t,r){if(r)return t;if(t!==void 0)return Math.abs(t)<=e?0:t}}var Sc=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),cn=0,Ic=function(i){Sc(e,i);function e(t){var r=i.call(this)||this;r.on,r.once,r.un;var n=tt({},t);return r.hints_=[0,0],r.animations_=[],r.updateAnimationKey_,r.projection_=Qn(n.projection,"EPSG:3857"),r.viewportSize_=[100,100],r.targetCenter_=null,r.targetResolution_,r.targetRotation_,r.nextCenter_=null,r.nextResolution_,r.nextRotation_,r.cancelAnchor_=void 0,n.projection&&Dl(),n.center&&(n.center=Xt(n.center,r.projection_)),n.extent&&(n.extent=Qt(n.extent,r.projection_)),r.applyOptions_(n),r}return e.prototype.applyOptions_=function(t){var r=tt({},t);for(var n in Lt)delete r[n];this.setProperties(r,!0);var o=Dc(t);this.maxResolution_=o.maxResolution,this.minResolution_=o.minResolution,this.zoomFactor_=o.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=o.minZoom;var a=Lc(t),s=o.constraint,l=Mc(t);this.constraints_={center:a,resolution:s,rotation:l},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)},Object.defineProperty(e.prototype,"padding",{get:function(){return this.padding_},set:function(t){var r=this.padding_;this.padding_=t;var n=this.getCenter();if(n){var o=t||[0,0,0,0];r=r||[0,0,0,0];var a=this.getResolution(),s=a/2*(o[3]-r[3]+r[1]-o[1]),l=a/2*(o[0]-r[0]+r[2]-o[2]);this.setCenterInternal([n[0]+s,n[1]-l])}},enumerable:!1,configurable:!0}),e.prototype.getUpdatedOptions_=function(t){var r=this.getProperties();return r.resolution!==void 0?r.resolution=this.getResolution():r.zoom=this.getZoom(),r.center=this.getCenterInternal(),r.rotation=this.getRotation(),tt({},r,t)},e.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var r=new Array(arguments.length),n=0;n<r.length;++n){var o=arguments[n];o.center&&(o=tt({},o),o.center=Xt(o.center,this.getProjection())),o.anchor&&(o=tt({},o),o.anchor=Xt(o.anchor,this.getProjection())),r[n]=o}this.animateInternal.apply(this,r)},e.prototype.animateInternal=function(t){var r=arguments.length,n;r>1&&typeof arguments[r-1]=="function"&&(n=arguments[r-1],--r);for(var o=0;o<r&&!this.isDef();++o){var a=arguments[o];a.center&&this.setCenterInternal(a.center),a.zoom!==void 0?this.setZoom(a.zoom):a.resolution&&this.setResolution(a.resolution),a.rotation!==void 0&&this.setRotation(a.rotation)}if(o===r){n&&mr(n,!0);return}for(var s=Date.now(),l=this.targetCenter_.slice(),u=this.targetResolution_,c=this.targetRotation_,h=[];o<r;++o){var f=arguments[o],p={start:s,complete:!1,anchor:f.anchor,duration:f.duration!==void 0?f.duration:1e3,easing:f.easing||Zu,callback:n};if(f.center&&(p.sourceCenter=l,p.targetCenter=f.center.slice(),l=p.targetCenter),f.zoom!==void 0?(p.sourceResolution=u,p.targetResolution=this.getResolutionForZoom(f.zoom),u=p.targetResolution):f.resolution&&(p.sourceResolution=u,p.targetResolution=f.resolution,u=p.targetResolution),f.rotation!==void 0){p.sourceRotation=c;var d=Se(f.rotation-c+Math.PI,2*Math.PI)-Math.PI;p.targetRotation=c+d,c=p.targetRotation}bc(p)?p.complete=!0:s+=p.duration,h.push(p)}this.animations_.push(h),this.setHint(Ot.ANIMATING,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[Ot.ANIMATING]>0},e.prototype.getInteracting=function(){return this.hints_[Ot.INTERACTING]>0},e.prototype.cancelAnimations=function(){this.setHint(Ot.ANIMATING,-this.hints_[Ot.ANIMATING]);for(var t,r=0,n=this.animations_.length;r<n;++r){var o=this.animations_[r];if(o[0].callback&&mr(o[0].callback,!1),!t)for(var a=0,s=o.length;a<s;++a){var l=o[a];if(!l.complete){t=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN},e.prototype.updateAnimations_=function(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!!this.getAnimating()){for(var t=Date.now(),r=!1,n=this.animations_.length-1;n>=0;--n){for(var o=this.animations_[n],a=!0,s=0,l=o.length;s<l;++s){var u=o[s];if(!u.complete){var c=t-u.start,h=u.duration>0?c/u.duration:1;h>=1?(u.complete=!0,h=1):a=!1;var f=u.easing(h);if(u.sourceCenter){var p=u.sourceCenter[0],d=u.sourceCenter[1],v=u.targetCenter[0],g=u.targetCenter[1];this.nextCenter_=u.targetCenter;var E=p+f*(v-p),_=d+f*(g-d);this.targetCenter_=[E,_]}if(u.sourceResolution&&u.targetResolution){var m=f===1?u.targetResolution:u.sourceResolution+f*(u.targetResolution-u.sourceResolution);if(u.anchor){var y=this.getViewportSize_(this.getRotation()),T=this.constraints_.resolution(m,0,y,!0);this.targetCenter_=this.calculateCenterZoom(T,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=m,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){var R=f===1?Se(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+f*(u.targetRotation-u.sourceRotation);if(u.anchor){var x=this.constraints_.rotation(R,!0);this.targetCenter_=this.calculateCenterRotate(x,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=R}if(this.applyTargetState_(!0),r=!0,!u.complete)break}}if(a){this.animations_[n]=null,this.setHint(Ot.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var C=o[0].callback;C&&mr(C,!0)}}this.animations_=this.animations_.filter(Boolean),r&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},e.prototype.calculateCenterRotate=function(t,r){var n,o=this.getCenterInternal();return o!==void 0&&(n=[o[0]-r[0],o[1]-r[1]],Wn(n,t-this.getRotation()),Al(n,r)),n},e.prototype.calculateCenterZoom=function(t,r){var n,o=this.getCenterInternal(),a=this.getResolution();if(o!==void 0&&a!==void 0){var s=r[0]-t*(r[0]-o[0])/a,l=r[1]-t*(r[1]-o[1])/a;n=[s,l]}return n},e.prototype.getViewportSize_=function(t){var r=this.viewportSize_;if(t){var n=r[0],o=r[1];return[Math.abs(n*Math.cos(t))+Math.abs(o*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(o*Math.cos(t))]}else return r},e.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},e.prototype.getCenter=function(){var t=this.getCenterInternal();return t&&br(t,this.getProjection())},e.prototype.getCenterInternal=function(){return this.get(Lt.CENTER)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getConstrainResolution=function(){return this.get("constrainResolution")},e.prototype.getHints=function(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var r=this.calculateExtentInternal(t);return qo(r,this.getProjection())},e.prototype.calculateExtentInternal=function(t){var r=t||this.getViewportSizeMinusPadding_(),n=this.getCenterInternal();$(n,1);var o=this.getResolution();$(o!==void 0,2);var a=this.getRotation();return $(a!==void 0,3),Mn(n,o,a,r)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(Lt.RESOLUTION)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,r){return this.getResolutionForExtentInternal(Qt(t,this.getProjection()),r)},e.prototype.getResolutionForExtentInternal=function(t,r){var n=r||this.getViewportSizeMinusPadding_(),o=ut(t)/n[0],a=St(t)/n[1];return Math.max(o,a)},e.prototype.getResolutionForValueFunction=function(t){var r=t||2,n=this.getConstrainedResolution(this.maxResolution_),o=this.minResolution_,a=Math.log(n/o)/Math.log(r);return function(s){var l=n/Math.pow(r,s*a);return l}},e.prototype.getRotation=function(){return this.get(Lt.ROTATION)},e.prototype.getValueForResolutionFunction=function(t){var r=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),o=this.minResolution_,a=Math.log(n/o)/r;return function(s){var l=Math.log(n/s)/r/a;return l}},e.prototype.getViewportSizeMinusPadding_=function(t){var r=this.getViewportSize_(t),n=this.padding_;return n&&(r=[r[0]-n[1]-n[3],r[1]-n[0]-n[2]]),r},e.prototype.getState=function(){var t=this.getProjection(),r=this.getResolution(),n=this.getRotation(),o=this.getCenterInternal(),a=this.padding_;if(a){var s=this.getViewportSizeMinusPadding_();o=hn(o,this.getViewportSize_(),[s[0]/2+a[3],s[1]/2+a[0]],r,n)}return{center:o.slice(0),projection:t!==void 0?t:null,resolution:r,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,r=this.getResolution();return r!==void 0&&(t=this.getZoomForResolution(r)),t},e.prototype.getZoomForResolution=function(t){var r=this.minZoom_||0,n,o;if(this.resolutions_){var a=Yn(this.resolutions_,t,1);r=a,n=this.resolutions_[a],a==this.resolutions_.length-1?o=2:o=n/this.resolutions_[a+1]}else n=this.maxResolution_,o=this.zoomFactor_;return r+Math.log(n/t)/Math.log(o)},e.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var r=at(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[r]/this.resolutions_[r+1];return this.resolutions_[r]/Math.pow(n,at(t-r,0,1))}else return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},e.prototype.fit=function(t,r){var n;if($(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function",24),Array.isArray(t)){$(!Jr(t),25);var o=Qt(t,this.getProjection());n=ro(o)}else if(t.getType()==="Circle"){var o=Qt(t.getExtent(),this.getProjection());n=ro(o),n.rotate(this.getRotation(),Ne(o))}else{var a=Ul();a?n=t.clone().transform(a,this.getProjection()):n=t}this.fitInternal(n,r)},e.prototype.rotatedExtentForGeometry=function(t){for(var r=this.getRotation(),n=Math.cos(r),o=Math.sin(-r),a=t.getFlatCoordinates(),s=t.getStride(),l=1/0,u=1/0,c=-1/0,h=-1/0,f=0,p=a.length;f<p;f+=s){var d=a[f]*n-a[f+1]*o,v=a[f]*o+a[f+1]*n;l=Math.min(l,d),u=Math.min(u,v),c=Math.max(c,d),h=Math.max(h,v)}return[l,u,c,h]},e.prototype.fitInternal=function(t,r){var n=r||{},o=n.size;o||(o=this.getViewportSizeMinusPadding_());var a=n.padding!==void 0?n.padding:[0,0,0,0],s=n.nearest!==void 0?n.nearest:!1,l;n.minResolution!==void 0?l=n.minResolution:n.maxZoom!==void 0?l=this.getResolutionForZoom(n.maxZoom):l=0;var u=this.rotatedExtentForGeometry(t),c=this.getResolutionForExtentInternal(u,[o[0]-a[1]-a[3],o[1]-a[0]-a[2]]);c=isNaN(c)?l:Math.max(c,l),c=this.getConstrainedResolution(c,s?0:1);var h=this.getRotation(),f=Math.sin(h),p=Math.cos(h),d=Ne(u);d[0]+=(a[1]-a[3])/2*c,d[1]+=(a[0]-a[2])/2*c;var v=d[0]*p-d[1]*f,g=d[1]*p+d[0]*f,E=this.getConstrainedCenter([v,g],c),_=n.callback?n.callback:tr;n.duration!==void 0?this.animateInternal({resolution:c,center:E,duration:n.duration,easing:n.easing},_):(this.targetResolution_=c,this.targetCenter_=E,this.applyTargetState_(!1,!0),mr(_,!0))},e.prototype.centerOn=function(t,r,n){this.centerOnInternal(Xt(t,this.getProjection()),r,n)},e.prototype.centerOnInternal=function(t,r,n){this.setCenterInternal(hn(t,r,n,this.getResolution(),this.getRotation()))},e.prototype.calculateCenterShift=function(t,r,n,o){var a,s=this.padding_;if(s&&t){var l=this.getViewportSizeMinusPadding_(-n),u=hn(t,o,[l[0]/2+s[3],l[1]/2+s[0]],r,n);a=[t[0]-u[0],t[1]-u[1]]}return a},e.prototype.isDef=function(){return!!this.getCenterInternal()&&this.getResolution()!==void 0},e.prototype.adjustCenter=function(t){var r=br(this.targetCenter_,this.getProjection());this.setCenter([r[0]+t[0],r[1]+t[1]])},e.prototype.adjustCenterInternal=function(t){var r=this.targetCenter_;this.setCenterInternal([r[0]+t[0],r[1]+t[1]])},e.prototype.adjustResolution=function(t,r){var n=r&&Xt(r,this.getProjection());this.adjustResolutionInternal(t,n)},e.prototype.adjustResolutionInternal=function(t,r){var n=this.getAnimating()||this.getInteracting(),o=this.getViewportSize_(this.getRotation()),a=this.constraints_.resolution(this.targetResolution_*t,0,o,n);r&&(this.targetCenter_=this.calculateCenterZoom(a,r)),this.targetResolution_*=t,this.applyTargetState_()},e.prototype.adjustZoom=function(t,r){this.adjustResolution(Math.pow(this.zoomFactor_,-t),r)},e.prototype.adjustRotation=function(t,r){r&&(r=Xt(r,this.getProjection())),this.adjustRotationInternal(t,r)},e.prototype.adjustRotationInternal=function(t,r){var n=this.getAnimating()||this.getInteracting(),o=this.constraints_.rotation(this.targetRotation_+t,n);r&&(this.targetCenter_=this.calculateCenterRotate(o,r)),this.targetRotation_+=t,this.applyTargetState_()},e.prototype.setCenter=function(t){this.setCenterInternal(t&&Xt(t,this.getProjection()))},e.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},e.prototype.setHint=function(t,r){return this.hints_[t]+=r,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},e.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e.prototype.applyTargetState_=function(t,r){var n=this.getAnimating()||this.getInteracting()||r,o=this.constraints_.rotation(this.targetRotation_,n),a=this.getViewportSize_(o),s=this.constraints_.resolution(this.targetResolution_,0,a,n),l=this.constraints_.center(this.targetCenter_,s,a,n,this.calculateCenterShift(this.targetCenter_,s,o,a));this.get(Lt.ROTATION)!==o&&this.set(Lt.ROTATION,o),this.get(Lt.RESOLUTION)!==s&&(this.set(Lt.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(Lt.CENTER)||!Dr(this.get(Lt.CENTER),l))&&this.set(Lt.CENTER,l),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},e.prototype.resolveConstraints=function(t,r,n){var o=t!==void 0?t:200,a=r||0,s=this.constraints_.rotation(this.targetRotation_),l=this.getViewportSize_(s),u=this.constraints_.resolution(this.targetResolution_,a,l),c=this.constraints_.center(this.targetCenter_,u,l,!1,this.calculateCenterShift(this.targetCenter_,u,s,l));if(o===0&&!this.cancelAnchor_){this.targetResolution_=u,this.targetRotation_=s,this.targetCenter_=c,this.applyTargetState_();return}var h=n||(o===0?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,(this.getResolution()!==u||this.getRotation()!==s||!this.getCenterInternal()||!Dr(this.getCenterInternal(),c))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:c,resolution:u,duration:o,easing:Ue,anchor:h}))},e.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(Ot.INTERACTING,1)},e.prototype.endInteraction=function(t,r,n){var o=n&&Xt(n,this.getProjection());this.endInteractionInternal(t,r,o)},e.prototype.endInteractionInternal=function(t,r,n){this.setHint(Ot.INTERACTING,-1),this.resolveConstraints(t,r,n)},e.prototype.getConstrainedCenter=function(t,r){var n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,r||this.getResolution(),n)},e.prototype.getConstrainedZoom=function(t,r){var n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,r))},e.prototype.getConstrainedResolution=function(t,r){var n=r||0,o=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,n,o)},e}(kt);function mr(i,e){setTimeout(function(){i(e)},0)}function Lc(i){if(i.extent!==void 0){var e=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return uo(i.extent,i.constrainOnlyCenter,e)}var t=Qn(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&t.isGlobal()){var r=t.getExtent().slice();return r[0]=-1/0,r[2]=1/0,uo(r,!1,!1)}return wc}function Dc(i){var e,t,r,n=28,o=2,a=i.minZoom!==void 0?i.minZoom:cn,s=i.maxZoom!==void 0?i.maxZoom:n,l=i.zoomFactor!==void 0?i.zoomFactor:o,u=i.multiWorld!==void 0?i.multiWorld:!1,c=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,h=i.showFullExtent!==void 0?i.showFullExtent:!1,f=Qn(i.projection,"EPSG:3857"),p=f.getExtent(),d=i.constrainOnlyCenter,v=i.extent;if(!u&&!v&&f.isGlobal()&&(d=!1,v=p),i.resolutions!==void 0){var g=i.resolutions;t=g[a],r=g[s]!==void 0?g[s]:g[g.length-1],i.constrainResolution?e=Cc(g,c,!d&&v,h):e=co(t,r,c,!d&&v,h)}else{var E=p?Math.max(ut(p),St(p)):360*jt[Jt.DEGREES]/f.getMetersPerUnit(),_=E/ii/Math.pow(o,cn),m=_/Math.pow(o,n-cn);t=i.maxResolution,t!==void 0?a=0:t=_/Math.pow(l,a),r=i.minResolution,r===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?r=t/Math.pow(l,s):r=_/Math.pow(l,s):r=m),s=a+Math.floor(Math.log(t/r)/Math.log(l)),r=t/Math.pow(l,s-a),i.constrainResolution?e=Oc(l,t,r,c,!d&&v,h):e=co(t,r,c,!d&&v,h)}return{constraint:e,maxResolution:t,minResolution:r,minZoom:a,zoomFactor:l}}function Mc(i){var e=i.enableRotation!==void 0?i.enableRotation:!0;if(e){var t=i.constrainRotation;return t===void 0||t===!0?Pc():t===!1?ho:typeof t=="number"?Ac(t):ho}else return si}function bc(i){return!(i.sourceCenter&&i.targetCenter&&!Dr(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function hn(i,e,t,r,n){var o=Math.cos(-n),a=Math.sin(-n),s=i[0]*o-i[1]*a,l=i[1]*o+i[0]*a;s+=(e[0]/2-t[0])*r,l+=(t[1]-e[1]/2)*r,a=-a;var u=s*o-l*a,c=l*o+s*a;return[u,c]}const qt=Ic;var Nc=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function ya(i){if(i instanceof ri){i.setMapInternal(null);return}i instanceof en&&i.getLayers().forEach(ya)}function ma(i,e){if(i instanceof ri){i.setMapInternal(e);return}if(i instanceof en)for(var t=i.getLayers().getArray(),r=0,n=t.length;r<n;++r)ma(t[r],e)}var Fc=function(i){Nc(e,i);function e(t){var r=i.call(this)||this;r.on,r.once,r.un;var n=Gc(t);r.renderComplete_,r.loaded_=!0,r.boundHandleBrowserEvent_=r.handleBrowserEvent.bind(r),r.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,r.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:jo,r.postRenderTimeoutHandle_,r.animationDelayKey_,r.animationDelay_=(function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}).bind(r),r.coordinateToPixelTransform_=Ut(),r.pixelToCoordinateTransform_=Ut(),r.frameIndex_=0,r.frameState_=null,r.previousExtent_=null,r.viewPropertyListenerKey_=null,r.viewChangeListenerKey_=null,r.layerGroupPropertyListenerKeys_=null,r.viewport_=document.createElement("div"),r.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),r.viewport_.style.position="relative",r.viewport_.style.overflow="hidden",r.viewport_.style.width="100%",r.viewport_.style.height="100%",r.overlayContainer_=document.createElement("div"),r.overlayContainer_.style.position="absolute",r.overlayContainer_.style.zIndex="0",r.overlayContainer_.style.width="100%",r.overlayContainer_.style.height="100%",r.overlayContainer_.style.pointerEvents="none",r.overlayContainer_.className="ol-overlaycontainer",r.viewport_.appendChild(r.overlayContainer_),r.overlayContainerStopEvent_=document.createElement("div"),r.overlayContainerStopEvent_.style.position="absolute",r.overlayContainerStopEvent_.style.zIndex="0",r.overlayContainerStopEvent_.style.width="100%",r.overlayContainerStopEvent_.style.height="100%",r.overlayContainerStopEvent_.style.pointerEvents="none",r.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",r.viewport_.appendChild(r.overlayContainerStopEvent_),r.mapBrowserEventHandler_=null,r.moveTolerance_=t.moveTolerance,r.keyboardEventTarget_=n.keyboardEventTarget,r.targetChangeHandlerKeys_=null,r.controls=n.controls||new bt,r.interactions=n.interactions||new bt,r.overlays_=n.overlays,r.overlayIdIndex_={},r.renderer_=null,r.postRenderFunctions_=[],r.tileQueue_=new Tc(r.getTilePriority.bind(r),r.handleTileChange_.bind(r)),r.addChangeListener(vt.LAYERGROUP,r.handleLayerGroupChanged_),r.addChangeListener(vt.VIEW,r.handleViewChanged_),r.addChangeListener(vt.SIZE,r.handleSizeChanged_),r.addChangeListener(vt.TARGET,r.handleTargetChanged_),r.setProperties(n.values);var o=r;return t.view&&!(t.view instanceof qt)&&t.view.then(function(a){o.setView(new qt(a))}),r.controls.addEventListener(Pt.ADD,(function(a){a.element.setMap(this)}).bind(r)),r.controls.addEventListener(Pt.REMOVE,(function(a){a.element.setMap(null)}).bind(r)),r.interactions.addEventListener(Pt.ADD,(function(a){a.element.setMap(this)}).bind(r)),r.interactions.addEventListener(Pt.REMOVE,(function(a){a.element.setMap(null)}).bind(r)),r.overlays_.addEventListener(Pt.ADD,(function(a){this.addOverlayInternal_(a.element)}).bind(r)),r.overlays_.addEventListener(Pt.REMOVE,(function(a){var s=a.element,l=s.getId();l!==void 0&&delete this.overlayIdIndex_[l.toString()],a.element.setMap(null)}).bind(r)),r.controls.forEach((function(a){a.setMap(this)}).bind(r)),r.interactions.forEach((function(a){a.setMap(this)}).bind(r)),r.overlays_.forEach(r.addOverlayInternal_.bind(r)),r}return e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){var r=this.getLayerGroup().getLayers();r.push(t)},e.prototype.handleLayerAdd_=function(t){ma(t.layer,this)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var r=t.getId();r!==void 0&&(this.overlayIdIndex_[r.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.setTarget(null),i.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,r,n){if(!(!this.frameState_||!this.renderer_)){var o=this.getCoordinateFromPixelInternal(t);n=n!==void 0?n:{};var a=n.hitTolerance!==void 0?n.hitTolerance:0,s=n.layerFilter!==void 0?n.layerFilter:He,l=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(o,this.frameState_,a,l,r,null,s,null)}},e.prototype.getFeaturesAtPixel=function(t,r){var n=[];return this.forEachFeatureAtPixel(t,function(o){n.push(o)},r),n},e.prototype.getAllLayers=function(){var t=[];function r(n){n.forEach(function(o){o instanceof en?r(o.getLayers()):t.push(o)})}return r(this.getLayers()),t},e.prototype.forEachLayerAtPixel=function(t,r,n){if(!(!this.frameState_||!this.renderer_)){var o=n||{},a=o.hitTolerance!==void 0?o.hitTolerance:0,s=o.layerFilter||He;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,a,r,s)}},e.prototype.hasFeatureAtPixel=function(t,r){if(!this.frameState_||!this.renderer_)return!1;var n=this.getCoordinateFromPixelInternal(t);r=r!==void 0?r:{};var o=r.layerFilter!==void 0?r.layerFilter:He,a=r.hitTolerance!==void 0?r.hitTolerance:0,s=r.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,a,s,o,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var r=this.viewport_.getBoundingClientRect(),n="changedTouches"in t?t.changedTouches[0]:t;return[n.clientX-r.left,n.clientY-r.top]},e.prototype.getTarget=function(){return this.get(vt.TARGET)},e.prototype.getTargetElement=function(){var t=this.getTarget();return t!==void 0?typeof t=="string"?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){return br(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},e.prototype.getCoordinateFromPixelInternal=function(t){var r=this.frameState_;return r?ct(r.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var r=this.overlayIdIndex_[t.toString()];return r!==void 0?r:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(vt.LAYERGROUP)},e.prototype.setLayers=function(t){var r=this.getLayerGroup();if(t instanceof bt){r.setLayers(t);return}var n=r.getLayers();n.clear(),n.extend(t)},e.prototype.getLayers=function(){var t=this.getLayerGroup().getLayers();return t},e.prototype.getLoadingOrNotReady=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),r=0,n=t.length;r<n;++r){var o=t[r];if(o.visible){var a=o.layer.getRenderer();if(a&&!a.ready)return!0;var s=o.layer.getSource();if(s&&s.loading)return!0}}return!1},e.prototype.getPixelFromCoordinate=function(t){var r=Xt(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(r)},e.prototype.getPixelFromCoordinateInternal=function(t){var r=this.frameState_;return r?ct(r.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(vt.SIZE)},e.prototype.getView=function(){return this.get(vt.VIEW)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getOwnerDocument=function(){var t=this.getTargetElement();return t?t.ownerDocument:document},e.prototype.getTilePriority=function(t,r,n,o){return Rc(this.frameState_,t,r,n,o)},e.prototype.handleBrowserEvent=function(t,r){var n=r||t.type,o=new $t(n,this,t);this.handleMapBrowserEvent(o)},e.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){var r=t.originalEvent,n=r.type;if(n===jn.POINTERDOWN||n===M.WHEEL||n===M.KEYDOWN){var o=this.getOwnerDocument(),a=this.viewport_.getRootNode?this.viewport_.getRootNode():o,s=r.target;if(this.overlayContainerStopEvent_.contains(s)||!(a===o?o.documentElement:a).contains(s))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1)for(var l=this.getInteractions().getArray().slice(),u=l.length-1;u>=0;u--){var c=l[u];if(!(c.getMap()!==this||!c.getActive()||!this.getTargetElement())){var h=c.handleEvent(t);if(!h||t.propagationStopped)break}}}},e.prototype.handlePostRender=function(){var t=this.frameState_,r=this.tileQueue_;if(!r.isEmpty()){var n=this.maxTilesLoading_,o=n;if(t){var a=t.viewHints;if(a[Ot.ANIMATING]||a[Ot.INTERACTING]){var s=Date.now()-t.time>8;n=s?0:8,o=s?0:2}}r.getTilesLoading()<n&&(r.reprioritize(),r.loadMoreTiles(n,o))}t&&this.renderer_&&!t.animate&&(this.renderComplete_===!0?(this.hasListener(yt.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(yt.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Ce(Ht.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Ce(Ht.LOADSTART,this,t))));for(var l=this.postRenderFunctions_,u=0,c=l.length;u<c;++u)l[u](this,t);l.length=0},e.prototype.handleSizeChanged_=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},e.prototype.handleTargetChanged_=function(){if(this.mapBrowserEventHandler_){for(var t=0,r=this.targetChangeHandlerKeys_.length;t<r;++t)et(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(M.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(M.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Un(this.viewport_)}var n=this.getTargetElement();if(!n)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{n.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new gc(this,this.moveTolerance_);for(var o in J)this.mapBrowserEventHandler_.addEventListener(J[o],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(M.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(M.WHEEL,this.boundHandleBrowserEvent_,Xo?{passive:!1}:!1);var a=this.getOwnerDocument().defaultView,s=this.keyboardEventTarget_?this.keyboardEventTarget_:n;this.targetChangeHandlerKeys_=[Y(s,M.KEYDOWN,this.handleBrowserEvent,this),Y(s,M.KEYPRESS,this.handleBrowserEvent,this),Y(a,M.RESIZE,this.updateSize,this)]}this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(et(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(et(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=Y(t,Je.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Y(t,M.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(et),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Wt("addlayer",t)),this.layerGroupPropertyListenerKeys_=[Y(t,Je.PROPERTYCHANGE,this.render,this),Y(t,M.CHANGE,this.render,this),Y(t,"addlayer",this.handleLayerAdd_,this),Y(t,"removelayer",this.handleLayerRemove_,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),r=0,n=t.length;r<n;++r){var o=t[r].layer;o.hasRenderer()&&o.getRenderer().handleFontsChanged()}},e.prototype.render=function(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){var r=this.getLayerGroup().getLayers();return r.remove(t)},e.prototype.handleLayerRemove_=function(t){ya(t.layer)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var r=this,n=this.getSize(),o=this.getView(),a=this.frameState_,s=null;if(n!==void 0&&no(n)&&o&&o.isDef()){var l=o.getHints(this.frameState_?this.frameState_.viewHints:void 0),u=o.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:Mn(u.center,u.resolution,u.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:u,viewHints:l,wantedTiles:{},mapId:nt(this),renderTargets:{}},u.nextCenter&&u.nextResolution){var c=isNaN(u.nextRotation)?u.rotation:u.nextRotation;s.nextExtent=Mn(u.nextCenter,u.nextResolution,c,n)}}if(this.frameState_=s,this.renderer_.renderFrame(s),s){if(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),a){var h=!this.previousExtent_||!Jr(this.previousExtent_)&&!Ln(s.extent,this.previousExtent_);h&&(this.dispatchEvent(new Ce(Ht.MOVESTART,this,a)),this.previousExtent_=$r(this.previousExtent_))}var f=this.previousExtent_&&!s.viewHints[Ot.ANIMATING]&&!s.viewHints[Ot.INTERACTING]&&!Ln(s.extent,this.previousExtent_);f&&(this.dispatchEvent(new Ce(Ht.MOVEEND,this,s)),rl(s.extent,this.previousExtent_))}this.dispatchEvent(new Ce(Ht.POSTRENDER,this,s)),this.renderComplete_=this.hasListener(Ht.LOADSTART)||this.hasListener(Ht.LOADEND)||this.hasListener(yt.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){r.postRenderTimeoutHandle_=void 0,r.handlePostRender()},0))},e.prototype.setLayerGroup=function(t){var r=this.getLayerGroup();r&&this.handleLayerRemove_(new Wt("removelayer",r)),this.set(vt.LAYERGROUP,t)},e.prototype.setSize=function(t){this.set(vt.SIZE,t)},e.prototype.setTarget=function(t){this.set(vt.TARGET,t)},e.prototype.setView=function(t){if(!t||t instanceof qt){this.set(vt.VIEW,t);return}this.set(vt.VIEW,new qt);var r=this;t.then(function(n){r.setView(new qt(n))})},e.prototype.updateSize=function(){var t=this.getTargetElement(),r=void 0;if(t){var n=getComputedStyle(t),o=t.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),a=t.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);!isNaN(o)&&!isNaN(a)&&(r=[o,a],!no(r)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0."))}this.setSize(r),this.updateViewportSize_()},e.prototype.updateViewportSize_=function(){var t=this.getView();if(t){var r=void 0,n=getComputedStyle(this.viewport_);n.width&&n.height&&(r=[parseInt(n.width,10),parseInt(n.height,10)]),t.setViewportSize(r)}},e}(kt);function Gc(i){var e=null;i.keyboardEventTarget!==void 0&&(e=typeof i.keyboardEventTarget=="string"?document.getElementById(i.keyboardEventTarget):i.keyboardEventTarget);var t={},r=i.layers&&typeof i.layers.getLayers=="function"?i.layers:new en({layers:i.layers});t[vt.LAYERGROUP]=r,t[vt.TARGET]=i.target,t[vt.VIEW]=i.view instanceof qt?i.view:new qt;var n;i.controls!==void 0&&(Array.isArray(i.controls)?n=new bt(i.controls.slice()):($(typeof i.controls.getArray=="function",47),n=i.controls));var o;i.interactions!==void 0&&(Array.isArray(i.interactions)?o=new bt(i.interactions.slice()):($(typeof i.interactions.getArray=="function",48),o=i.interactions));var a;return i.overlays!==void 0?Array.isArray(i.overlays)?a=new bt(i.overlays.slice()):($(typeof i.overlays.getArray=="function",49),a=i.overlays):a=new bt,{controls:n,interactions:o,keyboardEventTarget:e,overlays:a,values:t}}const Uc=Fc;var jc=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Bc=function(i){jc(e,i);function e(t){var r=i.call(this)||this,n=t.element;return n&&!t.target&&!n.style.pointerEvents&&(n.style.pointerEvents="auto"),r.element=n||null,r.target_=null,r.map_=null,r.listenerKeys=[],t.render&&(r.render=t.render),t.target&&r.setTarget(t.target),r}return e.prototype.disposeInternal=function(){Un(this.element),i.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&Un(this.element);for(var r=0,n=this.listenerKeys.length;r<n;++r)et(this.listenerKeys[r]);if(this.listenerKeys.length=0,this.map_=t,t){var o=this.target_?this.target_:t.getOverlayContainerStopEvent();o.appendChild(this.element),this.render!==tr&&this.listenerKeys.push(Y(t,Ht.POSTRENDER,this.render,this)),t.render()}},e.prototype.render=function(t){},e.prototype.setTarget=function(t){this.target_=typeof t=="string"?document.getElementById(t):t},e}(kt);const li=Bc;var Xc=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Kc=function(i){Xc(e,i);function e(t){var r=this,n=t||{};r=i.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this,r.ulElement_=document.createElement("ul"),r.collapsed_=n.collapsed!==void 0?n.collapsed:!0,r.userCollapsed_=r.collapsed_,r.overrideCollapsible_=n.collapsible!==void 0,r.collapsible_=n.collapsible!==void 0?n.collapsible:!0,r.collapsible_||(r.collapsed_=!1);var o=n.className!==void 0?n.className:"ol-attribution",a=n.tipLabel!==void 0?n.tipLabel:"Attributions",s=n.expandClassName!==void 0?n.expandClassName:o+"-expand",l=n.collapseLabel!==void 0?n.collapseLabel:"›",u=n.collapseClassName!==void 0?n.collapseClassName:o+"-collapse";typeof l=="string"?(r.collapseLabel_=document.createElement("span"),r.collapseLabel_.textContent=l,r.collapseLabel_.className=u):r.collapseLabel_=l;var c=n.label!==void 0?n.label:"i";typeof c=="string"?(r.label_=document.createElement("span"),r.label_.textContent=c,r.label_.className=s):r.label_=c;var h=r.collapsible_&&!r.collapsed_?r.collapseLabel_:r.label_;r.toggleButton_=document.createElement("button"),r.toggleButton_.setAttribute("type","button"),r.toggleButton_.setAttribute("aria-expanded",String(!r.collapsed_)),r.toggleButton_.title=a,r.toggleButton_.appendChild(h),r.toggleButton_.addEventListener(M.CLICK,r.handleClick_.bind(r),!1);var f=o+" "+tn+" "+ei+(r.collapsed_&&r.collapsible_?" "+ao:"")+(r.collapsible_?"":" ol-uncollapsible"),p=r.element;return p.className=f,p.appendChild(r.toggleButton_),p.appendChild(r.ulElement_),r.renderedAttributions_=[],r.renderedVisible_=!0,r}return e.prototype.collectSourceAttributions_=function(t){for(var r={},n=[],o=!0,a=t.layerStatesArray,s=0,l=a.length;s<l;++s){var u=a[s];if(Fr(u,t.viewState)){var c=u.layer.getSource();if(c){var h=c.getAttributions();if(h){var f=h(t);if(f)if(o=o&&c.getAttributionsCollapsible()!==!1,Array.isArray(f))for(var p=0,d=f.length;p<d;++p)f[p]in r||(n.push(f[p]),r[f[p]]=!0);else f in r||(n.push(f),r[f]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(o),n},e.prototype.updateElement_=function(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}var r=this.collectSourceAttributions_(t),n=r.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!Zn(r,this.renderedAttributions_)){xu(this.ulElement_);for(var o=0,a=r.length;o<a;++o){var s=document.createElement("li");s.innerHTML=r[o],this.ulElement_.appendChild(s)}this.renderedAttributions_=r}},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_},e.prototype.handleToggle_=function(){this.element.classList.toggle(ao),this.collapsed_?oo(this.collapseLabel_,this.label_):oo(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e.prototype.render=function(t){this.updateElement_(t.frameState)},e}(li);const zc=Kc;var Vc=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),kc=function(i){Vc(e,i);function e(t){var r=this,n=t||{};r=i.call(this,{element:document.createElement("div"),render:n.render,target:n.target})||this;var o=n.className!==void 0?n.className:"ol-rotate",a=n.label!==void 0?n.label:"⇧",s=n.compassClassName!==void 0?n.compassClassName:"ol-compass";r.label_=null,typeof a=="string"?(r.label_=document.createElement("span"),r.label_.className=s,r.label_.textContent=a):(r.label_=a,r.label_.classList.add(s));var l=n.tipLabel?n.tipLabel:"Reset rotation",u=document.createElement("button");u.className=o+"-reset",u.setAttribute("type","button"),u.title=l,u.appendChild(r.label_),u.addEventListener(M.CLICK,r.handleClick_.bind(r),!1);var c=o+" "+tn+" "+ei,h=r.element;return h.className=c,h.appendChild(u),r.callResetNorth_=n.resetNorth?n.resetNorth:void 0,r.duration_=n.duration!==void 0?n.duration:250,r.autoHide_=n.autoHide!==void 0?n.autoHide:!0,r.rotation_=void 0,r.autoHide_&&r.element.classList.add(yr),r}return e.prototype.handleClick_=function(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap(),r=t.getView();if(r){var n=r.getRotation();n!==void 0&&(this.duration_>0&&n%(2*Math.PI)!==0?r.animate({rotation:0,duration:this.duration_,easing:Ue}):r.setRotation(0))}},e.prototype.render=function(t){var r=t.frameState;if(r){var n=r.viewState.rotation;if(n!=this.rotation_){var o="rotate("+n+"rad)";if(this.autoHide_){var a=this.element.classList.contains(yr);!a&&n===0?this.element.classList.add(yr):a&&n!==0&&this.element.classList.remove(yr)}this.label_.style.transform=o}this.rotation_=n}},e}(li);const Yc=kc;var Zc=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),$c=function(i){Zc(e,i);function e(t){var r=this,n=t||{};r=i.call(this,{element:document.createElement("div"),target:n.target})||this;var o=n.className!==void 0?n.className:"ol-zoom",a=n.delta!==void 0?n.delta:1,s=n.zoomInClassName!==void 0?n.zoomInClassName:o+"-in",l=n.zoomOutClassName!==void 0?n.zoomOutClassName:o+"-out",u=n.zoomInLabel!==void 0?n.zoomInLabel:"+",c=n.zoomOutLabel!==void 0?n.zoomOutLabel:"–",h=n.zoomInTipLabel!==void 0?n.zoomInTipLabel:"Zoom in",f=n.zoomOutTipLabel!==void 0?n.zoomOutTipLabel:"Zoom out",p=document.createElement("button");p.className=s,p.setAttribute("type","button"),p.title=h,p.appendChild(typeof u=="string"?document.createTextNode(u):u),p.addEventListener(M.CLICK,r.handleClick_.bind(r,a),!1);var d=document.createElement("button");d.className=l,d.setAttribute("type","button"),d.title=f,d.appendChild(typeof c=="string"?document.createTextNode(c):c),d.addEventListener(M.CLICK,r.handleClick_.bind(r,-a),!1);var v=o+" "+tn+" "+ei,g=r.element;return g.className=v,g.appendChild(p),g.appendChild(d),r.duration_=n.duration!==void 0?n.duration:250,r}return e.prototype.handleClick_=function(t,r){r.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var r=this.getMap(),n=r.getView();if(n){var o=n.getZoom();if(o!==void 0){var a=n.getConstrainedZoom(o+t);this.duration_>0?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:a,duration:this.duration_,easing:Ue})):n.setZoom(a)}}},e}(li);const Hc=$c;function Wc(i){var e=i||{},t=new bt,r=e.zoom!==void 0?e.zoom:!0;r&&t.push(new Hc(e.zoomOptions));var n=e.rotate!==void 0?e.rotate:!0;n&&t.push(new Yc(e.rotateOptions));var o=e.attribution!==void 0?e.attribution:!0;return o&&t.push(new zc(e.attributionOptions)),t}const fo={ACTIVE:"active"};var qc=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Qc=function(i){qc(e,i);function e(t){var r=i.call(this)||this;return r.on,r.once,r.un,t&&t.handleEvent&&(r.handleEvent=t.handleEvent),r.map_=null,r.setActive(!0),r}return e.prototype.getActive=function(){return this.get(fo.ACTIVE)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(fo.ACTIVE,t)},e.prototype.setMap=function(t){this.map_=t},e}(kt);function Jc(i,e,t){var r=i.getCenterInternal();if(r){var n=[r[0]+e[0],r[1]+e[1]];i.animateInternal({duration:t!==void 0?t:250,easing:$u,center:i.getConstrainedCenter(n)})}}function ui(i,e,t,r){var n=i.getZoom();if(n!==void 0){var o=i.getConstrainedZoom(n+e),a=i.getResolutionForZoom(o);i.getAnimating()&&i.cancelAnimations(),i.animate({resolution:a,anchor:t,duration:r!==void 0?r:250,easing:Ue})}}const or=Qc;var th=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),eh=function(i){th(e,i);function e(t){var r=i.call(this)||this,n=t||{};return r.delta_=n.delta?n.delta:1,r.duration_=n.duration!==void 0?n.duration:250,r}return e.prototype.handleEvent=function(t){var r=!1;if(t.type==J.DBLCLICK){var n=t.originalEvent,o=t.map,a=t.coordinate,s=n.shiftKey?-this.delta_:this.delta_,l=o.getView();ui(l,s,a,this.duration_),n.preventDefault(),r=!0}return!r},e}(or);const rh=eh;var nh=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),ih=function(i){nh(e,i);function e(t){var r=this,n=t||{};return r=i.call(this,n)||this,n.handleDownEvent&&(r.handleDownEvent=n.handleDownEvent),n.handleDragEvent&&(r.handleDragEvent=n.handleDragEvent),n.handleMoveEvent&&(r.handleMoveEvent=n.handleMoveEvent),n.handleUpEvent&&(r.handleUpEvent=n.handleUpEvent),n.stopDown&&(r.stopDown=n.stopDown),r.handlingDownUpSequence=!1,r.targetPointers=[],r}return e.prototype.getPointerCount=function(){return this.targetPointers.length},e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var r=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==J.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==J.POINTERUP){var n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==J.POINTERDOWN){var o=this.handleDownEvent(t);this.handlingDownUpSequence=o,r=this.stopDown(o)}else t.type==J.POINTERMOVE&&this.handleMoveEvent(t);return!r},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){t.activePointers&&(this.targetPointers=t.activePointers)},e}(or);function ci(i){for(var e=i.length,t=0,r=0,n=0;n<e;n++)t+=i[n].clientX,r+=i[n].clientY;return[t/e,r/e]}const ar=ih;function Bn(i){var e=arguments;return function(t){for(var r=!0,n=0,o=e.length;n<o&&(r=r&&e[n](t),!!r);++n);return r}}var oh=function(i){var e=i.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ah=function(i){var e=i.map.getTargetElement(),t=i.map.getOwnerDocument().activeElement;return e.contains(t)},Ea=function(i){return i.map.getTargetElement().hasAttribute("tabindex")?ah(i):!0},sh=He,Ta=function(i){var e=i.originalEvent;return e.button==0&&!(Ws&&qs&&e.ctrlKey)},Ra=function(i){var e=i.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},lh=function(i){var e=i.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},xa=function(i){var e=i.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},fn=function(i){var e=i.originalEvent;return $(e!==void 0,56),e.pointerType=="mouse"},uh=function(i){var e=i.originalEvent;return $(e!==void 0,56),e.isPrimary&&e.button===0},ch=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),hh=function(i){ch(e,i);function e(t){var r=i.call(this,{stopDown:kr})||this,n=t||{};r.kinetic_=n.kinetic,r.lastCentroid=null,r.lastPointersCount_,r.panning_=!1;var o=n.condition?n.condition:Bn(Ra,uh);return r.condition_=n.onFocusOnly?Bn(Ea,o):o,r.noKinetic_=!1,r}return e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var r=this.targetPointers,n=ci(r);if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){var o=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],a=t.map,s=a.getView();Pl(o,s.getResolution()),Wn(o,s.getRotation()),s.adjustCenterInternal(o)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=n,this.lastPointersCount_=r.length,t.originalEvent.preventDefault()},e.prototype.handleUpEvent=function(t){var r=t.map,n=r.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var o=this.kinetic_.getDistance(),a=this.kinetic_.getAngle(),s=n.getCenterInternal(),l=r.getPixelFromCoordinateInternal(s),u=r.getCoordinateFromPixelInternal([l[0]-o*Math.cos(a),l[1]-o*Math.sin(a)]);n.animateInternal({center:n.getConstrainedCenter(u),duration:500,easing:Ue})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}else return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var r=t.map,n=r.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}else return!1},e}(ar);const fh=hh;var ph=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),dh=function(i){ph(e,i);function e(t){var r=this,n=t||{};return r=i.call(this,{stopDown:kr})||this,r.condition_=n.condition?n.condition:oh,r.lastAngle_=void 0,r.duration_=n.duration!==void 0?n.duration:250,r}return e.prototype.handleDragEvent=function(t){if(fn(t)){var r=t.map,n=r.getView();if(n.getConstraints().rotation!==si){var o=r.getSize(),a=t.pixel,s=Math.atan2(o[1]/2-a[1],a[0]-o[0]/2);if(this.lastAngle_!==void 0){var l=s-this.lastAngle_;n.adjustRotationInternal(-l)}this.lastAngle_=s}}},e.prototype.handleUpEvent=function(t){if(!fn(t))return!0;var r=t.map,n=r.getView();return n.endInteraction(this.duration_),!1},e.prototype.handleDownEvent=function(t){if(!fn(t))return!1;if(Ta(t)&&this.condition_(t)){var r=t.map;return r.getView().beginInteraction(),this.lastAngle_=void 0,!0}else return!1},e}(ar);const vh=dh;var gh=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),_h=function(i){gh(e,i);function e(t){var r=i.call(this)||this;return r.geometry_=null,r.element_=document.createElement("div"),r.element_.style.position="absolute",r.element_.style.pointerEvents="auto",r.element_.className="ol-box "+t,r.map_=null,r.startPixel_=null,r.endPixel_=null,r}return e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,r=this.endPixel_,n="px",o=this.element_.style;o.left=Math.min(t[0],r[0])+n,o.top=Math.min(t[1],r[1])+n,o.width=Math.abs(r[0]-t[0])+n,o.height=Math.abs(r[1]-t[1])+n},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var r=this.element_.style;r.left="inherit",r.top="inherit",r.width="inherit",r.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,r){this.startPixel_=t,this.endPixel_=r,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,r=this.endPixel_,n=[t,[t[0],r[1]],r,[r[0],t[1]]],o=n.map(this.map_.getCoordinateFromPixelInternal,this.map_);o[4]=o[0].slice(),this.geometry_?this.geometry_.setCoordinates([o]):this.geometry_=new sa([o])},e.prototype.getGeometry=function(){return this.geometry_},e}(zr);const yh=_h;var wa=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Er={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},pn=function(i){wa(e,i);function e(t,r,n){var o=i.call(this,t)||this;return o.coordinate=r,o.mapBrowserEvent=n,o}return e}(ee),mh=function(i){wa(e,i);function e(t){var r=i.call(this)||this;r.on,r.once,r.un;var n=t||{};return r.box_=new yh(n.className||"ol-dragbox"),r.minArea_=n.minArea!==void 0?n.minArea:64,n.onBoxEnd&&(r.onBoxEnd=n.onBoxEnd),r.startPixel_=null,r.condition_=n.condition?n.condition:Ta,r.boxEndCondition_=n.boxEndCondition?n.boxEndCondition:r.defaultBoxEndCondition,r}return e.prototype.defaultBoxEndCondition=function(t,r,n){var o=n[0]-r[0],a=n[1]-r[1];return o*o+a*a>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new pn(Er.BOXDRAG,t.coordinate,t))},e.prototype.handleUpEvent=function(t){this.box_.setMap(null);var r=this.boxEndCondition_(t,this.startPixel_,t.pixel);return r&&this.onBoxEnd(t),this.dispatchEvent(new pn(r?Er.BOXEND:Er.BOXCANCEL,t.coordinate,t)),!1},e.prototype.handleDownEvent=function(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new pn(Er.BOXSTART,t.coordinate,t)),!0):!1},e.prototype.onBoxEnd=function(t){},e}(ar);const Eh=mh;var Th=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Rh=function(i){Th(e,i);function e(t){var r=this,n=t||{},o=n.condition?n.condition:lh;return r=i.call(this,{condition:o,className:n.className||"ol-dragzoom",minArea:n.minArea})||this,r.duration_=n.duration!==void 0?n.duration:200,r.out_=n.out!==void 0?n.out:!1,r}return e.prototype.onBoxEnd=function(t){var r=this.getMap(),n=r.getView(),o=this.getGeometry();if(this.out_){var a=n.rotatedExtentForGeometry(o),s=n.getResolutionForExtentInternal(a),l=n.getResolution()/s;o=o.clone(),o.scale(l*l)}n.fitInternal(o,{duration:this.duration_,easing:Ue})},e}(Eh);const xh=Rh,se={LEFT:37,UP:38,RIGHT:39,DOWN:40};var wh=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ch=function(i){wh(e,i);function e(t){var r=i.call(this)||this,n=t||{};return r.defaultCondition_=function(o){return Ra(o)&&xa(o)},r.condition_=n.condition!==void 0?n.condition:r.defaultCondition_,r.duration_=n.duration!==void 0?n.duration:100,r.pixelDelta_=n.pixelDelta!==void 0?n.pixelDelta:128,r}return e.prototype.handleEvent=function(t){var r=!1;if(t.type==M.KEYDOWN){var n=t.originalEvent,o=n.keyCode;if(this.condition_(t)&&(o==se.DOWN||o==se.LEFT||o==se.RIGHT||o==se.UP)){var a=t.map,s=a.getView(),l=s.getResolution()*this.pixelDelta_,u=0,c=0;o==se.DOWN?c=-l:o==se.LEFT?u=-l:o==se.RIGHT?u=l:c=l;var h=[u,c];Wn(h,s.getRotation()),Jc(s,h,this.duration_),n.preventDefault(),r=!0}}return!r},e}(or);const Oh=Ch;var Ah=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ph=function(i){Ah(e,i);function e(t){var r=i.call(this)||this,n=t||{};return r.condition_=n.condition?n.condition:xa,r.delta_=n.delta?n.delta:1,r.duration_=n.duration!==void 0?n.duration:100,r}return e.prototype.handleEvent=function(t){var r=!1;if(t.type==M.KEYDOWN||t.type==M.KEYPRESS){var n=t.originalEvent,o=n.charCode;if(this.condition_(t)&&(o=="+".charCodeAt(0)||o=="-".charCodeAt(0))){var a=t.map,s=o=="+".charCodeAt(0)?this.delta_:-this.delta_,l=a.getView();ui(l,s,void 0,this.duration_),n.preventDefault(),r=!0}}return!r},e}(or);const Sh=Ph;var Ih=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),dn={TRACKPAD:"trackpad",WHEEL:"wheel"},Lh=function(i){Ih(e,i);function e(t){var r=this,n=t||{};r=i.call(this,n)||this,r.totalDelta_=0,r.lastDelta_=0,r.maxDelta_=n.maxDelta!==void 0?n.maxDelta:1,r.duration_=n.duration!==void 0?n.duration:250,r.timeout_=n.timeout!==void 0?n.timeout:80,r.useAnchor_=n.useAnchor!==void 0?n.useAnchor:!0,r.constrainResolution_=n.constrainResolution!==void 0?n.constrainResolution:!1;var o=n.condition?n.condition:sh;return r.condition_=n.onFocusOnly?Bn(Ea,o):o,r.lastAnchor_=null,r.startTime_=void 0,r.timeoutId_,r.mode_=void 0,r.trackpadEventGap_=400,r.trackpadTimeoutId_,r.deltaPerZoom_=300,r}return e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0;var t=this.getMap();if(t){var r=t.getView();r.endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var r=t.type;if(r!==M.WHEEL)return!0;var n=t.map,o=t.originalEvent;o.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);var a;if(t.type==M.WHEEL&&(a=o.deltaY,Zs&&o.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(a/=jo),o.deltaMode===WheelEvent.DOM_DELTA_LINE&&(a*=40)),a===0)return!1;this.lastDelta_=a;var s=Date.now();this.startTime_===void 0&&(this.startTime_=s),(!this.mode_||s-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(a)<4?dn.TRACKPAD:dn.WHEEL);var l=n.getView();if(this.mode_===dn.TRACKPAD&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-a/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=s,!1;this.totalDelta_+=a;var u=Math.max(this.timeout_-(s-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),u),!1},e.prototype.handleWheelZoom_=function(t){var r=t.getView();r.getAnimating()&&r.cancelAnimations();var n=-at(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(r.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),ui(r,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(or);const Dh=Lh;var Mh=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),bh=function(i){Mh(e,i);function e(t){var r=this,n=t||{},o=n;return o.stopDown||(o.stopDown=kr),r=i.call(this,o)||this,r.anchor_=null,r.lastAngle_=void 0,r.rotating_=!1,r.rotationDelta_=0,r.threshold_=n.threshold!==void 0?n.threshold:.3,r.duration_=n.duration!==void 0?n.duration:250,r}return e.prototype.handleDragEvent=function(t){var r=0,n=this.targetPointers[0],o=this.targetPointers[1],a=Math.atan2(o.clientY-n.clientY,o.clientX-n.clientX);if(this.lastAngle_!==void 0){var s=a-this.lastAngle_;this.rotationDelta_+=s,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),r=s}this.lastAngle_=a;var l=t.map,u=l.getView();if(u.getConstraints().rotation!==si){var c=l.getViewport().getBoundingClientRect(),h=ci(this.targetPointers);h[0]-=c.left,h[1]-=c.top,this.anchor_=l.getCoordinateFromPixelInternal(h),this.rotating_&&(l.render(),u.adjustRotationInternal(r,this.anchor_))}},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var r=t.map,n=r.getView();return n.endInteraction(this.duration_),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var r=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||r.getView().beginInteraction(),!0}else return!1},e}(ar);const Nh=bh;var Fh=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Gh=function(i){Fh(e,i);function e(t){var r=this,n=t||{},o=n;return o.stopDown||(o.stopDown=kr),r=i.call(this,o)||this,r.anchor_=null,r.duration_=n.duration!==void 0?n.duration:400,r.lastDistance_=void 0,r.lastScaleDelta_=1,r}return e.prototype.handleDragEvent=function(t){var r=1,n=this.targetPointers[0],o=this.targetPointers[1],a=n.clientX-o.clientX,s=n.clientY-o.clientY,l=Math.sqrt(a*a+s*s);this.lastDistance_!==void 0&&(r=this.lastDistance_/l),this.lastDistance_=l;var u=t.map,c=u.getView();r!=1&&(this.lastScaleDelta_=r);var h=u.getViewport().getBoundingClientRect(),f=ci(this.targetPointers);f[0]-=h.left,f[1]-=h.top,this.anchor_=u.getCoordinateFromPixelInternal(f),u.render(),c.adjustResolutionInternal(r,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var r=t.map,n=r.getView(),o=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,o),!1}else return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var r=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||r.getView().beginInteraction(),!0}else return!1},e}(ar);const Uh=Gh;function jh(i){var e=i||{},t=new bt,r=new ec(-.005,.05,100),n=e.altShiftDragRotate!==void 0?e.altShiftDragRotate:!0;n&&t.push(new vh);var o=e.doubleClickZoom!==void 0?e.doubleClickZoom:!0;o&&t.push(new rh({delta:e.zoomDelta,duration:e.zoomDuration}));var a=e.dragPan!==void 0?e.dragPan:!0;a&&t.push(new fh({onFocusOnly:e.onFocusOnly,kinetic:r}));var s=e.pinchRotate!==void 0?e.pinchRotate:!0;s&&t.push(new Nh);var l=e.pinchZoom!==void 0?e.pinchZoom:!0;l&&t.push(new Uh({duration:e.zoomDuration}));var u=e.keyboard!==void 0?e.keyboard:!0;u&&(t.push(new Oh),t.push(new Sh({delta:e.zoomDelta,duration:e.zoomDuration})));var c=e.mouseWheelZoom!==void 0?e.mouseWheelZoom:!0;c&&t.push(new Dh({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration}));var h=e.shiftDragZoom!==void 0?e.shiftDragZoom:!0;return h&&t.push(new xh({duration:e.zoomDuration})),t}var Bh=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Xh=function(i){Bh(e,i);function e(t){return t=tt({},t),t.controls||(t.controls=Wc()),t.interactions||(t.interactions=jh({onFocusOnly:!0})),i.call(this,t)||this}return e.prototype.createRenderer=function(){return new lc(this)},e}(Uc);const Kh=Xh;var zh=function(){function i(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return i.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark},i.prototype.expireCache=function(e){for(;this.canExpireCache();)this.pop()},i.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},i.prototype.containsKey=function(e){return this.entries_.hasOwnProperty(e)},i.prototype.forEach=function(e){for(var t=this.oldest_;t;)e(t.value_,t.key_,this),t=t.newer},i.prototype.get=function(e,t){var r=this.entries_[e];return $(r!==void 0,15),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_},i.prototype.remove=function(e){var t=this.entries_[e];return $(t!==void 0,15),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_},i.prototype.getCount=function(){return this.count_},i.prototype.getKeys=function(){var e=new Array(this.count_),t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.key_;return e},i.prototype.getValues=function(){var e=new Array(this.count_),t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.value_;return e},i.prototype.peekLast=function(){return this.oldest_.value_},i.prototype.peekLastKey=function(){return this.oldest_.key_},i.prototype.peekFirstKey=function(){return this.newest_.key_},i.prototype.peek=function(e){if(this.containsKey(e))return this.entries_[e].value_},i.prototype.pop=function(){var e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_},i.prototype.replace=function(e,t){this.get(e),this.entries_[e].value_=t},i.prototype.set=function(e,t){$(!(e in this.entries_),16);var r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_},i.prototype.setSize=function(e){this.highWaterMark=e},i}();const Ca=zh;function jr(i,e,t,r){return r!==void 0?(r[0]=i,r[1]=e,r[2]=t,r):[i,e,t]}function sr(i,e,t){return i+"/"+e+"/"+t}function er(i){return sr(i[0],i[1],i[2])}function Vh(i){return i.split("/").map(Number)}function kh(i){return(i[1]<<i[0])+i[2]}function Yh(i,e){var t=i[0],r=i[1],n=i[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;var o=e.getFullTileRange(t);return o?o.containsXY(r,n):!0}var Zh=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),$h=function(i){Zh(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e.prototype.expireCache=function(t){for(;this.canExpireCache();){var r=this.peekLast();if(r.getKey()in t)break;this.pop().release()}},e.prototype.pruneExceptNewestZ=function(){if(this.getCount()!==0){var t=this.peekFirstKey(),r=Vh(t),n=r[0];this.forEach((function(o){o.tileCoord[0]!==n&&(this.remove(er(o.tileCoord)),o.release())}).bind(this))}},e}(Ca);const Oa=$h;var Aa=function(){function i(e,t,r,n){this.minX=e,this.maxX=t,this.minY=r,this.maxY=n}return i.prototype.contains=function(e){return this.containsXY(e[1],e[2])},i.prototype.containsTileRange=function(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY},i.prototype.containsXY=function(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY},i.prototype.equals=function(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY},i.prototype.extend=function(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)},i.prototype.getHeight=function(){return this.maxY-this.minY+1},i.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},i.prototype.getWidth=function(){return this.maxX-this.minX+1},i.prototype.intersects=function(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY},i}();function Ee(i,e,t,r,n){return n!==void 0?(n.minX=i,n.maxX=e,n.minY=t,n.maxY=r,n):new Aa(i,e,t,r)}const hi=Aa,Tr={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};var Hh=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Wh=function(i){Hh(e,i);function e(t){var r=this,n=t||{},o=tt({},n);return delete o.preload,delete o.useInterimTilesOnError,r=i.call(this,o)||this,r.on,r.once,r.un,r.setPreload(n.preload!==void 0?n.preload:0),r.setUseInterimTilesOnError(n.useInterimTilesOnError!==void 0?n.useInterimTilesOnError:!0),r}return e.prototype.getPreload=function(){return this.get(Tr.PRELOAD)},e.prototype.setPreload=function(t){this.set(Tr.PRELOAD,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(Tr.USE_INTERIM_TILES_ON_ERROR)},e.prototype.setUseInterimTilesOnError=function(t){this.set(Tr.USE_INTERIM_TILES_ON_ERROR,t)},e.prototype.getData=function(t){return i.prototype.getData.call(this,t)},e}(ri);const Pa=Wh;var qh=.5,Qh=10,po=.25,Jh=function(){function i(e,t,r,n,o,a){this.sourceProj_=e,this.targetProj_=t;var s={},l=Mr(this.targetProj_,this.sourceProj_);this.transformInv_=function(m){var y=m[0]+"/"+m[1];return s[y]||(s[y]=l(m)),s[y]},this.maxSourceExtent_=n,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&ut(n)==ut(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ut(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ut(this.targetProj_.getExtent()):null;var u=ve(r),c=qr(r),h=Wr(r),f=Hr(r),p=this.transformInv_(u),d=this.transformInv_(c),v=this.transformInv_(h),g=this.transformInv_(f),E=Qh+(a?Math.max(0,Math.ceil($o(Dn(r)/(a*a*256*256)))):0);if(this.addQuad_(u,c,h,f,p,d,v,g,E),this.wrapsXInSource_){var _=1/0;this.triangles_.forEach(function(m,y,T){_=Math.min(_,m.source[0][0],m.source[1][0],m.source[2][0])}),this.triangles_.forEach((function(m){if(Math.max(m.source[0][0],m.source[1][0],m.source[2][0])-_>this.sourceWorldWidth_/2){var y=[[m.source[0][0],m.source[0][1]],[m.source[1][0],m.source[1][1]],[m.source[2][0],m.source[2][1]]];y[0][0]-_>this.sourceWorldWidth_/2&&(y[0][0]-=this.sourceWorldWidth_),y[1][0]-_>this.sourceWorldWidth_/2&&(y[1][0]-=this.sourceWorldWidth_),y[2][0]-_>this.sourceWorldWidth_/2&&(y[2][0]-=this.sourceWorldWidth_);var T=Math.min(y[0][0],y[1][0],y[2][0]),R=Math.max(y[0][0],y[1][0],y[2][0]);R-T<this.sourceWorldWidth_/2&&(m.source=y)}}).bind(this))}s={}}return i.prototype.addTriangle_=function(e,t,r,n,o,a){this.triangles_.push({source:[n,o,a],target:[e,t,r]})},i.prototype.addQuad_=function(e,t,r,n,o,a,s,l,u){var c=In([o,a,s,l]),h=this.sourceWorldWidth_?ut(c)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,p=this.sourceProj_.canWrapX()&&h>.5&&h<1,d=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var v=In([e,t,r,n]),g=ut(v)/this.targetWorldWidth_;d=g>po||d}!p&&this.sourceProj_.isGlobal()&&h&&(d=h>po||d)}if(!(!d&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!Qr(c,this.maxSourceExtent_))){var E=0;if(!d&&(!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(s[0])||!isFinite(s[1])||!isFinite(l[0])||!isFinite(l[1]))){if(u>0)d=!0;else if(E=(!isFinite(o[0])||!isFinite(o[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(s[0])||!isFinite(s[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),E!=1&&E!=2&&E!=4&&E!=8)return}if(u>0){if(!d){var _=[(e[0]+r[0])/2,(e[1]+r[1])/2],m=this.transformInv_(_),y=void 0;if(p){var T=(Se(o[0],f)+Se(s[0],f))/2;y=T-Se(m[0],f)}else y=(o[0]+s[0])/2-m[0];var R=(o[1]+s[1])/2-m[1],x=y*y+R*R;d=x>this.errorThresholdSquared_}if(d){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){var C=[(t[0]+r[0])/2,(t[1]+r[1])/2],P=this.transformInv_(C),I=[(n[0]+e[0])/2,(n[1]+e[1])/2],S=this.transformInv_(I);this.addQuad_(e,t,C,I,o,a,P,S,u-1),this.addQuad_(I,C,r,n,S,P,s,l,u-1)}else{var X=[(e[0]+t[0])/2,(e[1]+t[1])/2],V=this.transformInv_(X),Z=[(r[0]+n[0])/2,(r[1]+n[1])/2],j=this.transformInv_(Z);this.addQuad_(e,X,Z,n,o,V,j,l,u-1),this.addQuad_(X,t,r,Z,V,a,s,j,u-1)}return}}if(p){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}E&11||this.addTriangle_(e,r,n,o,s,l),E&14||this.addTriangle_(e,r,t,o,s,a),E&&(E&13||this.addTriangle_(t,n,e,a,l,o),E&7||this.addTriangle_(t,n,r,a,l,s))}},i.prototype.calculateSourceExtent=function(){var e=de();return this.triangles_.forEach(function(t,r,n){var o=t.source;Cr(e,o[0]),Cr(e,o[1]),Cr(e,o[2])}),e},i.prototype.getTriangles=function(){return this.triangles_},i}();const tf=Jh;var Xn={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},ef={imageSmoothingEnabled:!0,msImageSmoothingEnabled:!0},vn,Sa=[];function vo(i,e,t,r,n){i.beginPath(),i.moveTo(0,0),i.lineTo(e,t),i.lineTo(r,n),i.closePath(),i.save(),i.clip(),i.fillRect(0,0,Math.max(e,r)+1,Math.max(t,n)),i.restore()}function gn(i,e){return Math.abs(i[e*4]-210)>2||Math.abs(i[e*4+3]-.75*255)>2}function rf(){if(vn===void 0){var i=document.createElement("canvas").getContext("2d");i.globalCompositeOperation="lighter",i.fillStyle="rgba(210, 0, 0, 0.75)",vo(i,4,5,4,0),vo(i,4,5,0,5);var e=i.getImageData(0,0,3,3).data;vn=gn(e,0)||gn(e,4)||gn(e,8)}return vn}function go(i,e,t,r){var n=Fl(t,e,i),o=Hi(e,r,t),a=e.getMetersPerUnit();a!==void 0&&(o*=a);var s=i.getMetersPerUnit();s!==void 0&&(o/=s);var l=i.getExtent();if(!l||fe(l,n)){var u=Hi(i,o,n)/o;isFinite(u)&&u>0&&(o/=u)}return o}function nf(i,e,t,r){var n=Ne(t),o=go(i,e,n,r);return(!isFinite(o)||o<=0)&&Zo(t,function(a){return o=go(i,e,a,r),isFinite(o)&&o>0}),o}function of(i,e,t,r,n,o,a,s,l,u,c,h){var f=Nr(Math.round(t*i),Math.round(t*e),Sa);if(h||tt(f,Xn),l.length===0)return f.canvas;f.scale(t,t);function p(y){return Math.round(y*t)/t}f.globalCompositeOperation="lighter";var d=de();l.forEach(function(y,T,R){al(d,y.extent)});var v=ut(d),g=St(d),E=Nr(Math.round(t*v/r),Math.round(t*g/r));h||tt(E,Xn);var _=t/r;l.forEach(function(y,T,R){var x=y.extent[0]-d[0],C=-(y.extent[3]-d[3]),P=ut(y.extent),I=St(y.extent);y.image.width>0&&y.image.height>0&&E.drawImage(y.image,u,u,y.image.width-2*u,y.image.height-2*u,x*_,C*_,P*_,I*_)});var m=ve(a);return s.getTriangles().forEach(function(y,T,R){var x=y.source,C=y.target,P=x[0][0],I=x[0][1],S=x[1][0],X=x[1][1],V=x[2][0],Z=x[2][1],j=p((C[0][0]-m[0])/o),F=p(-(C[0][1]-m[1])/o),G=p((C[1][0]-m[0])/o),L=p(-(C[1][1]-m[1])/o),k=p((C[2][0]-m[0])/o),B=p(-(C[2][1]-m[1])/o),Q=P,pt=I;P=0,I=0,S-=Q,X-=pt,V-=Q,Z-=pt;var st=[[S,X,0,0,G-j],[V,Z,0,0,k-j],[0,0,S,X,L-F],[0,0,V,Z,B-F]],it=dl(st);if(it){if(f.save(),f.beginPath(),rf()||!h){f.moveTo(G,L);for(var U=4,ot=j-G,dt=F-L,q=0;q<U;q++)f.lineTo(G+p((q+1)*ot/U),L+p(q*dt/(U-1))),q!=U-1&&f.lineTo(G+p((q+1)*ot/U),L+p((q+1)*dt/(U-1)));f.lineTo(k,B)}else f.moveTo(G,L),f.lineTo(j,F),f.lineTo(k,B);f.clip(),f.transform(it[0],it[2],it[1],it[3],j,F),f.translate(d[0]-Q,d[3]-pt),f.scale(r/t,-r/t),f.drawImage(E.canvas,0,0),f.restore()}}),c&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,s.getTriangles().forEach(function(y,T,R){var x=y.target,C=(x[0][0]-m[0])/o,P=-(x[0][1]-m[1])/o,I=(x[1][0]-m[0])/o,S=-(x[1][1]-m[1])/o,X=(x[2][0]-m[0])/o,V=-(x[2][1]-m[1])/o;f.beginPath(),f.moveTo(I,S),f.lineTo(C,P),f.lineTo(X,V),f.closePath(),f.stroke()}),f.restore()),f.canvas}var af=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),sf=function(i){af(e,i);function e(t,r,n,o,a,s,l,u,c,h,f,p){var d=i.call(this,a,O.IDLE,{interpolate:!!p})||this;d.renderEdges_=f!==void 0?f:!1,d.pixelRatio_=l,d.gutter_=u,d.canvas_=null,d.sourceTileGrid_=r,d.targetTileGrid_=o,d.wrappedTileCoord_=s||a,d.sourceTiles_=[],d.sourcesListenerKeys_=null,d.sourceZ_=0;var v=o.getTileCoordExtent(d.wrappedTileCoord_),g=d.targetTileGrid_.getExtent(),E=d.sourceTileGrid_.getExtent(),_=g?Vt(v,g):v;if(Dn(_)===0)return d.state=O.EMPTY,d;var m=t.getExtent();m&&(E?E=Vt(E,m):E=m);var y=o.getResolution(d.wrappedTileCoord_[0]),T=nf(t,n,_,y);if(!isFinite(T)||T<=0)return d.state=O.EMPTY,d;var R=h!==void 0?h:qh;if(d.triangulation_=new tf(t,n,_,E,T*R,y),d.triangulation_.getTriangles().length===0)return d.state=O.EMPTY,d;d.sourceZ_=r.getZForResolution(T);var x=d.triangulation_.calculateSourceExtent();if(E&&(t.canWrapX()?(x[1]=at(x[1],E[1],E[3]),x[3]=at(x[3],E[1],E[3])):x=Vt(x,E)),!Dn(x))d.state=O.EMPTY;else{for(var C=r.getTileRangeForExtentAndZ(x,d.sourceZ_),P=C.minX;P<=C.maxX;P++)for(var I=C.minY;I<=C.maxY;I++){var S=c(d.sourceZ_,P,I,l);S&&d.sourceTiles_.push(S)}d.sourceTiles_.length===0&&(d.state=O.EMPTY)}return d}return e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach((function(c,h,f){c&&c.getState()==O.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(c.tileCoord),image:c.getImage()})}).bind(this)),this.sourceTiles_.length=0,t.length===0)this.state=O.ERROR;else{var r=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(r),o=typeof n=="number"?n:n[0],a=typeof n=="number"?n:n[1],s=this.targetTileGrid_.getResolution(r),l=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=of(o,a,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),s,u,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=O.LOADED}this.changed()},e.prototype.load=function(){if(this.state==O.IDLE){this.state=O.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((function(r,n,o){var a=r.getState();if(a==O.IDLE||a==O.LOADING){t++;var s=Y(r,M.CHANGE,function(l){var u=r.getState();(u==O.LOADED||u==O.ERROR||u==O.EMPTY)&&(et(s),t--,t===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(s)}}).bind(this)),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(r,n,o){var a=r.getState();a==O.IDLE&&r.load()})}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(et),this.sourcesListenerKeys_=null},e.prototype.release=function(){this.canvas_&&(Ru(this.canvas_.getContext("2d")),Sa.push(this.canvas_),this.canvas_=null),i.prototype.release.call(this)},e}(ni);const fi=sf;var lf=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),uf=function(i){lf(e,i);function e(t){var r=i.call(this,t)||this;return r.extentChanged=!0,r.renderedExtent_=null,r.renderedPixelRatio,r.renderedProjection=null,r.renderedRevision,r.renderedTiles=[],r.newTiles_=!1,r.tmpExtent=de(),r.tmpTileRange_=new hi(0,0,0,0),r}return e.prototype.isDrawableTile=function(t){var r=this.getLayer(),n=t.getState(),o=r.getUseInterimTilesOnError();return n==O.LOADED||n==O.EMPTY||n==O.ERROR&&!o},e.prototype.getTile=function(t,r,n,o){var a=o.pixelRatio,s=o.viewState.projection,l=this.getLayer(),u=l.getSource(),c=u.getTile(t,r,n,a,s);return c.getState()==O.ERROR&&(l.getUseInterimTilesOnError()?l.getPreload()>0&&(this.newTiles_=!0):c.setState(O.LOADED)),this.isDrawableTile(c)||(c=c.getInterimTile()),c},e.prototype.getData=function(t){var r=this.frameState;if(!r)return null;var n=this.getLayer(),o=ct(r.pixelToCoordinateTransform,t.slice()),a=n.getExtent();if(a&&!fe(a,o))return null;for(var s=r.pixelRatio,l=r.viewState.projection,u=r.viewState,c=n.getRenderSource(),h=c.getTileGridForProjection(u.projection),f=c.getTilePixelRatio(r.pixelRatio),p=h.getZForResolution(u.resolution);p>=h.getMinZoom();--p){var d=h.getTileCoordForCoordAndZ(o,p),v=c.getTile(p,d[1],d[2],s,l);if(!(v instanceof Gr||v instanceof fi))return null;if(v.getState()===O.LOADED){var g=h.getOrigin(p),E=gt(h.getTileSize(p)),_=h.getResolution(p),m=Math.floor(f*((o[0]-g[0])/_-d[1]*E[0])),y=Math.floor(f*((g[1]-o[1])/_-d[2]*E[1])),T=Math.round(f*c.getGutterForProjection(u.projection));return this.getImageData(v.getImage(),m+T,y+T)}}return null},e.prototype.loadedTileCallback=function(t,r,n){return this.isDrawableTile(n)?i.prototype.loadedTileCallback.call(this,t,r,n):!1},e.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},e.prototype.renderFrame=function(t,r){var n=t.layerStatesArray[t.layerIndex],o=t.viewState,a=o.projection,s=o.resolution,l=o.center,u=o.rotation,c=t.pixelRatio,h=this.getLayer(),f=h.getSource(),p=f.getRevision(),d=f.getTileGridForProjection(a),v=d.getZForResolution(s,f.zDirection),g=d.getResolution(v),E=t.extent,_=t.viewState.resolution,m=f.getTilePixelRatio(c),y=Math.round(ut(E)/_*c),T=Math.round(St(E)/_*c),R=n.extent&&Qt(n.extent);R&&(E=Vt(E,Qt(n.extent)));var x=g*y/2/m,C=g*T/2/m,P=[l[0]-x,l[1]-C,l[0]+x,l[1]+C],I=d.getTileRangeForExtentAndZ(E,v),S={};S[v]={};var X=this.createLoadedTileFinder(f,a,S),V=this.tmpExtent,Z=this.tmpTileRange_;this.newTiles_=!1;for(var j=u?bn(o.center,_,u,t.size):void 0,F=I.minX;F<=I.maxX;++F)for(var G=I.minY;G<=I.maxY;++G)if(!(u&&!d.tileCoordIntersectsViewport([v,F,G],j))){var L=this.getTile(v,F,G,t);if(this.isDrawableTile(L)){var k=nt(this);if(L.getState()==O.LOADED){S[v][L.tileCoord.toString()]=L;var B=L.inTransition(k);B&&n.opacity!==1&&(L.endTransition(k),B=!1),!this.newTiles_&&(B||this.renderedTiles.indexOf(L)===-1)&&(this.newTiles_=!0)}if(L.getAlpha(k,t.time)===1)continue}var Q=d.getTileCoordChildTileRange(L.tileCoord,Z,V),pt=!1;Q&&(pt=X(v+1,Q)),pt||d.forEachTileCoordParentTileRange(L.tileCoord,X,Z,V)}var st=g/s*c/m;he(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/c,1/c,u,-y/2,-T/2);var it=el(this.pixelTransform);this.useContainer(r,it,this.getBackground(t));var U=this.context,ot=U.canvas;zo(this.inversePixelTransform,this.pixelTransform),he(this.tempTransform,y/2,T/2,st,st,0,-y/2,-T/2),ot.width!=y||ot.height!=T?(ot.width=y,ot.height=T):this.containerReused||U.clearRect(0,0,y,T),R&&this.clipUnrotated(U,t,R),f.getInterpolate()||tt(U,Xn),this.preRender(U,t),this.renderedTiles.length=0;var dt=Object.keys(S).map(Number);dt.sort(Vr);var q,mt,Et;n.opacity===1&&(!this.containerReused||f.getOpaque(t.viewState.projection))?dt=dt.reverse():(q=[],mt=[]);for(var Yt=dt.length-1;Yt>=0;--Yt){var It=dt[Yt],wt=f.getTilePixelSize(It,c,a),sn=d.getResolution(It),ur=sn/g,ge=wt[0]*ur*st,Xe=wt[1]*ur*st,Ke=d.getTileCoordForCoordAndZ(ve(P),It),oe=d.getTileCoordExtent(Ke),_e=ct(this.tempTransform,[m*(oe[0]-P[0])/g,m*(P[3]-oe[3])/g]),cr=m*f.getGutterForProjection(a),hr=S[It];for(var Fi in hr){var L=hr[Fi],fr=L.tileCoord,Gi=Ke[1]-fr[1],Cs=Math.round(_e[0]-(Gi-1)*ge),Ui=Ke[2]-fr[2],Os=Math.round(_e[1]-(Ui-1)*Xe),F=Math.round(_e[0]-Gi*ge),G=Math.round(_e[1]-Ui*Xe),ze=Cs-F,Ve=Os-G,ji=v===It,B=ji&&L.getAlpha(nt(this),t.time)!==1,ln=!1;if(!B)if(q){Et=[F,G,F+ze,G,F+ze,G+Ve,F,G+Ve];for(var pr=0,As=q.length;pr<As;++pr)if(v!==It&&It<mt[pr]){var Ct=q[pr];Qr([F,G,F+ze,G+Ve],[Ct[0],Ct[3],Ct[4],Ct[7]])&&(ln||(U.save(),ln=!0),U.beginPath(),U.moveTo(Et[0],Et[1]),U.lineTo(Et[2],Et[3]),U.lineTo(Et[4],Et[5]),U.lineTo(Et[6],Et[7]),U.moveTo(Ct[6],Ct[7]),U.lineTo(Ct[4],Ct[5]),U.lineTo(Ct[2],Ct[3]),U.lineTo(Ct[0],Ct[1]),U.clip())}q.push(Et),mt.push(It)}else U.clearRect(F,G,ze,Ve);this.drawTileImage(L,t,F,G,ze,Ve,cr,ji),q&&!B?(ln&&U.restore(),this.renderedTiles.unshift(L)):this.renderedTiles.push(L),this.updateUsedTiles(t.usedTiles,f,L)}}return this.renderedRevision=p,this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!Ln(this.renderedExtent_,P),this.renderedExtent_=P,this.renderedPixelRatio=c,this.renderedProjection=a,this.manageTilePyramid(t,f,d,c,a,E,v,h.getPreload()),this.scheduleExpireCache(t,f),this.postRender(U,t),n.extent&&U.restore(),tt(U,ef),it!==ot.style.transform&&(ot.style.transform=it),this.container},e.prototype.drawTileImage=function(t,r,n,o,a,s,l,u){var c=this.getTileImage(t);if(c){var h=nt(this),f=r.layerStatesArray[r.layerIndex],p=f.opacity*(u?t.getAlpha(h,r.time):1),d=p!==this.context.globalAlpha;d&&(this.context.save(),this.context.globalAlpha=p),this.context.drawImage(c,l,l,c.width-2*l,c.height-2*l,n,o,a,s),d&&this.context.restore(),p!==f.opacity?r.animate=!0:u&&t.endTransition(h)}},e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},e.prototype.getTileImage=function(t){return t.getImage()},e.prototype.scheduleExpireCache=function(t,r){if(r.canExpireCache()){var n=(function(o,a,s){var l=nt(o);l in s.usedTiles&&o.expireCache(s.viewState.projection,s.usedTiles[l])}).bind(null,r);t.postRenderFunctions.push(n)}},e.prototype.updateUsedTiles=function(t,r,n){var o=nt(r);o in t||(t[o]={}),t[o][n.getKey()]=!0},e.prototype.manageTilePyramid=function(t,r,n,o,a,s,l,u,c){var h=nt(r);h in t.wantedTiles||(t.wantedTiles[h]={});var f=t.wantedTiles[h],p=t.tileQueue,d=n.getMinZoom(),v=t.viewState.rotation,g=v?bn(t.viewState.center,t.viewState.resolution,v,t.size):void 0,E=0,_,m,y,T,R,x;for(x=d;x<=l;++x)for(m=n.getTileRangeForExtentAndZ(s,x,m),y=n.getResolution(x),T=m.minX;T<=m.maxX;++T)for(R=m.minY;R<=m.maxY;++R)v&&!n.tileCoordIntersectsViewport([x,T,R],g)||(l-x<=u?(++E,_=r.getTile(x,T,R,o,a),_.getState()==O.IDLE&&(f[_.getKey()]=!0,p.isKeyQueued(_.getKey())||p.enqueue([_,h,n.getTileCoordCenter(_.tileCoord),y])),c!==void 0&&c(_)):r.useTile(x,T,R,a));r.updateCacheSize(E,a)},e}(Uu);const cf=uf;var hf=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),ff=function(i){hf(e,i);function e(t){return i.call(this,t)||this}return e.prototype.createRenderer=function(){return new cf(this)},e}(Pa);const pf=ff,Le={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};var df=[0,0,0],Zt=5,vf=function(){function i(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,$(Ns(this.resolutions_,function(a,s){return s-a},!0),17);var t;if(!e.origins){for(var r=0,n=this.resolutions_.length-1;r<n;++r)if(!t)t=this.resolutions_[r]/this.resolutions_[r+1];else if(this.resolutions_[r]/this.resolutions_[r+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,$(this.origins_.length==this.resolutions_.length,20));var o=e.extent;o!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=ve(o)),$(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,$(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:ii,$(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=o!==void 0?o:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map(function(a,s){var l=new hi(Math.min(0,a[0]),Math.max(a[0]-1,-1),Math.min(0,a[1]),Math.max(a[1]-1,-1));if(o){var u=this.getTileRangeForExtentAndZ(o,s);l.minX=Math.max(u.minX,l.minX),l.maxX=Math.min(u.maxX,l.maxX),l.minY=Math.max(u.minY,l.minY),l.maxY=Math.min(u.maxY,l.maxY)}return l},this):o&&this.calculateTileRanges_(o)}return i.prototype.forEachTileCoord=function(e,t,r){for(var n=this.getTileRangeForExtentAndZ(e,t),o=n.minX,a=n.maxX;o<=a;++o)for(var s=n.minY,l=n.maxY;s<=l;++s)r([t,o,s])},i.prototype.forEachTileCoordParentTileRange=function(e,t,r,n){var o,a,s,l=null,u=e[0]-1;for(this.zoomFactor_===2?(a=e[1],s=e[2]):l=this.getTileCoordExtent(e,n);u>=this.minZoom;){if(this.zoomFactor_===2?(a=Math.floor(a/2),s=Math.floor(s/2),o=Ee(a,a,s,s,r)):o=this.getTileRangeForExtentAndZ(l,u,r),t(u,o))return!0;--u}return!1},i.prototype.getExtent=function(){return this.extent_},i.prototype.getMaxZoom=function(){return this.maxZoom},i.prototype.getMinZoom=function(){return this.minZoom},i.prototype.getOrigin=function(e){return this.origin_?this.origin_:this.origins_[e]},i.prototype.getResolution=function(e){return this.resolutions_[e]},i.prototype.getResolutions=function(){return this.resolutions_},i.prototype.getTileCoordChildTileRange=function(e,t,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){var n=e[1]*2,o=e[2]*2;return Ee(n,n+1,o,o+1,t)}var a=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e[0]+1,t)}return null},i.prototype.getTileRangeForTileCoordAndZ=function(e,t,r){if(t>this.maxZoom||t<this.minZoom)return null;var n=e[0],o=e[1],a=e[2];if(t===n)return Ee(o,a,o,a,r);if(this.zoomFactor_){var s=Math.pow(this.zoomFactor_,t-n),l=Math.floor(o*s),u=Math.floor(a*s);if(t<n)return Ee(l,l,u,u,r);var c=Math.floor(s*(o+1))-1,h=Math.floor(s*(a+1))-1;return Ee(l,c,u,h,r)}var f=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(f,t,r)},i.prototype.getTileRangeExtent=function(e,t,r){var n=this.getOrigin(e),o=this.getResolution(e),a=gt(this.getTileSize(e),this.tmpSize_),s=n[0]+t.minX*a[0]*o,l=n[0]+(t.maxX+1)*a[0]*o,u=n[1]+t.minY*a[1]*o,c=n[1]+(t.maxY+1)*a[1]*o;return be(s,u,l,c,r)},i.prototype.getTileRangeForExtentAndZ=function(e,t,r){var n=df;this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,n);var o=n[1],a=n[2];return this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,n),Ee(o,n[1],a,n[2],r)},i.prototype.getTileCoordCenter=function(e){var t=this.getOrigin(e[0]),r=this.getResolution(e[0]),n=gt(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*n[0]*r,t[1]-(e[2]+.5)*n[1]*r]},i.prototype.getTileCoordExtent=function(e,t){var r=this.getOrigin(e[0]),n=this.getResolution(e[0]),o=gt(this.getTileSize(e[0]),this.tmpSize_),a=r[0]+e[1]*o[0]*n,s=r[1]-(e[2]+1)*o[1]*n,l=a+o[0]*n,u=s+o[1]*n;return be(a,s,l,u,t)},i.prototype.getTileCoordForCoordAndResolution=function(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)},i.prototype.getTileCoordForXYAndResolution_=function(e,t,r,n,o){var a=this.getZForResolution(r),s=r/this.getResolution(a),l=this.getOrigin(a),u=gt(this.getTileSize(a),this.tmpSize_),c=s*(e-l[0])/r/u[0],h=s*(l[1]-t)/r/u[1];return n?(c=gr(c,Zt)-1,h=gr(h,Zt)-1):(c=vr(c,Zt),h=vr(h,Zt)),jr(a,c,h,o)},i.prototype.getTileCoordForXYAndZ_=function(e,t,r,n,o){var a=this.getOrigin(r),s=this.getResolution(r),l=gt(this.getTileSize(r),this.tmpSize_),u=(e-a[0])/s/l[0],c=(a[1]-t)/s/l[1];return n?(u=gr(u,Zt)-1,c=gr(c,Zt)-1):(u=vr(u,Zt),c=vr(c,Zt)),jr(r,u,c,o)},i.prototype.getTileCoordForCoordAndZ=function(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)},i.prototype.getTileCoordResolution=function(e){return this.resolutions_[e[0]]},i.prototype.getTileSize=function(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]},i.prototype.getFullTileRange=function(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null},i.prototype.getZForResolution=function(e,t){var r=Yn(this.resolutions_,e,t||0);return at(r,this.minZoom,this.maxZoom)},i.prototype.tileCoordIntersectsViewport=function(e,t){return oa(t,0,t.length,2,this.getTileCoordExtent(e))},i.prototype.calculateTileRanges_=function(e){for(var t=this.resolutions_.length,r=new Array(t),n=this.minZoom;n<t;++n)r[n]=this.getTileRangeForExtentAndZ(e,n);this.fullTileRanges_=r},i}();const pi=vf;function Ia(i){var e=i.getDefaultTileGrid();return e||(e=yf(i),i.setDefaultTileGrid(e)),e}function gf(i,e,t){var r=e[0],n=i.getTileCoordCenter(e),o=rn(t);if(fe(o,n))return e;var a=ut(o),s=Math.ceil((o[0]-n[0])/a);return n[0]+=a*s,i.getTileCoordForCoordAndZ(n,r)}function _f(i,e,t,r){var n=r!==void 0?r:"top-left",o=Da(i,e,t);return new pi({extent:i,origin:ll(i,n),resolutions:o,tileSize:t})}function La(i){var e=i||{},t=e.extent||xt("EPSG:3857").getExtent(),r={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Da(t,e.maxZoom,e.tileSize,e.maxResolution)};return new pi(r)}function Da(i,e,t,r){for(var n=e!==void 0?e:xc,o=St(i),a=ut(i),s=gt(t!==void 0?t:ii),l=r>0?r:Math.max(a/s[0],o/s[1]),u=n+1,c=new Array(u),h=0;h<u;++h)c[h]=l/Math.pow(2,h);return c}function yf(i,e,t,r){var n=rn(i);return _f(n,e,t,r)}function rn(i){i=xt(i);var e=i.getExtent();if(!e){var t=180*jt[Jt.DEGREES]/i.getMetersPerUnit();e=be(-t,-t,t,t)}return e}var Ma=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),mf=function(i){Ma(e,i);function e(t){var r=i.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate})||this;r.on,r.once,r.un,r.opaque_=t.opaque!==void 0?t.opaque:!1,r.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,r.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;var n=[256,256];return r.tileGrid&&gt(r.tileGrid.getTileSize(r.tileGrid.getMinZoom()),n),r.tileCache=new Oa(t.cacheSize||0),r.tmpSize=[0,0],r.key_=t.key||"",r.tileOptions={transition:t.transition,interpolate:t.interpolate},r.zDirection=t.zDirection?t.zDirection:0,r}return e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,r){var n=this.getTileCacheForProjection(t);n&&n.expireCache(r)},e.prototype.forEachLoadedTile=function(t,r,n,o){var a=this.getTileCacheForProjection(t);if(!a)return!1;for(var s=!0,l,u,c,h=n.minX;h<=n.maxX;++h)for(var f=n.minY;f<=n.maxY;++f)u=sr(r,h,f),c=!1,a.containsKey(u)&&(l=a.get(u),c=l.getState()===O.LOADED,c&&(c=o(l)!==!1)),c||(s=!1);return s},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid?this.tileGrid.getResolutions():null},e.prototype.getTile=function(t,r,n,o,a){return H()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:Ia(t)},e.prototype.getTileCacheForProjection=function(t){var r=this.getProjection();return $(r===null||xe(r,t),68),this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,r,n){var o=this.getTileGridForProjection(n),a=this.getTilePixelRatio(r),s=gt(o.getTileSize(t),this.tmpSize);return a==1?s:_u(s,a,this.tmpSize)},e.prototype.getTileCoordForTileUrlFunction=function(t,r){var n=r!==void 0?r:this.getProjection(),o=this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(t=gf(o,t,n)),Yh(t,o)?t:null},e.prototype.clear=function(){this.tileCache.clear()},e.prototype.refresh=function(){this.clear(),i.prototype.refresh.call(this)},e.prototype.updateCacheSize=function(t,r){var n=this.getTileCacheForProjection(r);t>n.highWaterMark&&(n.highWaterMark=t)},e.prototype.useTile=function(t,r,n,o){},e}(Yu),ba=function(i){Ma(e,i);function e(t,r){var n=i.call(this,t)||this;return n.tile=r,n}return e}(ee);const Na=mf;function Ef(i,e){var t=/\{z\}/g,r=/\{x\}/g,n=/\{y\}/g,o=/\{-y\}/g;return function(a,s,l){if(a)return i.replace(t,a[0].toString()).replace(r,a[1].toString()).replace(n,a[2].toString()).replace(o,function(){var u=a[0],c=e.getFullTileRange(u);$(c,55);var h=c.getHeight()-a[2]-1;return h.toString()})}}function Tf(i,e){for(var t=i.length,r=new Array(t),n=0;n<t;++n)r[n]=Ef(i[n],e);return Rf(r)}function Rf(i){return i.length===1?i[0]:function(e,t,r){if(e){var n=kh(e),o=Se(n,i.length);return i[o](e,t,r)}else return}}function xf(i){var e=[],t=/\{([a-z])-([a-z])\}/.exec(i);if(t){var r=t[1].charCodeAt(0),n=t[2].charCodeAt(0),o=void 0;for(o=r;o<=n;++o)e.push(i.replace(t[0],String.fromCharCode(o)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(i),t){for(var a=parseInt(t[2],10),s=parseInt(t[1],10);s<=a;s++)e.push(i.replace(t[0],s.toString()));return e}return e.push(i),e}var wf=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Cf=function(i){wf(e,i);function e(t){var r=i.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return r.generateTileUrlFunction_=r.tileUrlFunction===e.prototype.tileUrlFunction,r.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(r.tileUrlFunction=t.tileUrlFunction),r.urls=null,t.urls?r.setUrls(t.urls):t.url&&r.setUrl(t.url),r.tileLoadingKeys_={},r}return e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var r=t.target,n=nt(r),o=r.getState(),a;o==O.LOADING?(this.tileLoadingKeys_[n]=!0,a=Le.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],a=o==O.ERROR?Le.TILELOADERROR:o==O.LOADED?Le.TILELOADEND:void 0),a!=null&&this.dispatchEvent(new ba(a,r))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,r){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),typeof r<"u"?this.setKey(r):this.changed()},e.prototype.setUrl=function(t){var r=xf(t);this.urls=r,this.setUrls(r)},e.prototype.setUrls=function(t){this.urls=t;var r=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Tf(t,this.tileGrid),r):this.setKey(r)},e.prototype.tileUrlFunction=function(t,r,n){},e.prototype.useTile=function(t,r,n){var o=sr(t,r,n);this.tileCache.containsKey(o)&&this.tileCache.get(o)},e}(Na);const Of=Cf;var Af=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Pf=function(i){Af(e,i);function e(t){var r=this,n=t.imageSmoothing!==void 0?t.imageSmoothing:!0;return t.interpolate!==void 0&&(n=t.interpolate),r=i.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Sf,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:n,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this,r.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,r.tileClass=t.tileClass!==void 0?t.tileClass:Gr,r.tileCacheForProjection={},r.tileGridForProjection={},r.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,r.renderReprojectionEdges_=!1,r}return e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,r){var n=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==n?r:{});for(var o in this.tileCacheForProjection){var a=this.tileCacheForProjection[o];a.expireCache(a==n?r:{})}},e.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!xe(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getKey=function(){var t=i.prototype.getKey.call(this);return this.getInterpolate()||(t+=":disable-interpolation"),t},e.prototype.getOpaque=function(t){return this.getProjection()&&t&&!xe(this.getProjection(),t)?!1:i.prototype.getOpaque.call(this,t)},e.prototype.getTileGridForProjection=function(t){var r=this.getProjection();if(this.tileGrid&&(!r||xe(r,t)))return this.tileGrid;var n=nt(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=Ia(t)),this.tileGridForProjection[n]},e.prototype.getTileCacheForProjection=function(t){var r=this.getProjection();if(!r||xe(r,t))return this.tileCache;var n=nt(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new Oa(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]},e.prototype.createTile_=function(t,r,n,o,a,s){var l=[t,r,n],u=this.getTileCoordForTileUrlFunction(l,a),c=u?this.tileUrlFunction(u,o,a):void 0,h=new this.tileClass(l,c!==void 0?O.IDLE:O.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=s,h.addEventListener(M.CHANGE,this.handleTileChange.bind(this)),h},e.prototype.getTile=function(t,r,n,o,a){var s=this.getProjection();if(!s||!a||xe(s,a))return this.getTileInternal(t,r,n,o,s||a);var l=this.getTileCacheForProjection(a),u=[t,r,n],c=void 0,h=er(u);l.containsKey(h)&&(c=l.get(h));var f=this.getKey();if(c&&c.key==f)return c;var p=this.getTileGridForProjection(s),d=this.getTileGridForProjection(a),v=this.getTileCoordForTileUrlFunction(u,a),g=new fi(s,p,a,d,u,v,this.getTilePixelRatio(o),this.getGutter(),(function(E,_,m,y){return this.getTileInternal(E,_,m,y,s)}).bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return g.key=f,c?(g.interimTile=c,g.refreshInterimChain(),l.replace(h,g)):l.set(h,g),g},e.prototype.getTileInternal=function(t,r,n,o,a){var s=null,l=sr(t,r,n),u=this.getKey();if(!this.tileCache.containsKey(l))s=this.createTile_(t,r,n,o,a,u),this.tileCache.set(l,s);else if(s=this.tileCache.get(l),s.key!=u){var c=s;s=this.createTile_(t,r,n,o,a,u),c.getState()==O.IDLE?s.interimTile=c.interimTile:s.interimTile=c,s.refreshInterimChain(),this.tileCache.replace(l,s)}return s},e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(var r in this.tileCacheForProjection)this.tileCacheForProjection[r].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,r){{var n=xt(t);if(n){var o=nt(n);o in this.tileGridForProjection||(this.tileGridForProjection[o]=r)}}},e}(Of);function Sf(i,e){i.getImage().src=e}const If=Pf;var Lf=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Df=function(i){Lf(e,i);function e(t){var r=this,n=t||{},o=n.imageSmoothing!==void 0?n.imageSmoothing:!0;n.interpolate!==void 0&&(o=n.interpolate);var a=n.projection!==void 0?n.projection:"EPSG:3857",s=n.tileGrid!==void 0?n.tileGrid:La({extent:rn(a),maxResolution:n.maxResolution,maxZoom:n.maxZoom,minZoom:n.minZoom,tileSize:n.tileSize});return r=i.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,interpolate:o,opaque:n.opaque,projection:a,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileGrid:s,tileLoadFunction:n.tileLoadFunction,tilePixelRatio:n.tilePixelRatio,tileUrlFunction:n.tileUrlFunction,url:n.url,urls:n.urls,wrapX:n.wrapX!==void 0?n.wrapX:!0,transition:n.transition,attributionsCollapsible:n.attributionsCollapsible,zDirection:n.zDirection})||this,r.gutter_=n.gutter!==void 0?n.gutter:0,r}return e.prototype.getGutter=function(){return this.gutter_},e}(If);const Mf=Df;var bf=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Nf='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',Ff=function(i){bf(e,i);function e(t){var r=t||{},n=r.imageSmoothing!==void 0?r.imageSmoothing:!0;r.interpolate!==void 0&&(n=r.interpolate);var o;r.attributions!==void 0?o=r.attributions:o=[Nf];var a=r.crossOrigin!==void 0?r.crossOrigin:"anonymous",s=r.url!==void 0?r.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";return i.call(this,{attributions:o,attributionsCollapsible:!1,cacheSize:r.cacheSize,crossOrigin:a,interpolate:n,maxZoom:r.maxZoom!==void 0?r.maxZoom:19,opaque:r.opaque!==void 0?r.opaque:!0,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileLoadFunction:r.tileLoadFunction,transition:r.transition,url:s,wrapX:r.wrapX,zDirection:r.zDirection})||this}return e}(Mf);const Gf=Ff;var Uf=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),jf=function(i){Uf(e,i);function e(t){var r=this,n=O.IDLE;return r=i.call(this,t.tileCoord,n,{transition:t.transition,interpolate:t.interpolate})||this,r.loader_=t.loader,r.data_=null,r.error_=null,r.size_=t.size||[256,256],r}return e.prototype.getSize=function(){return this.size_},e.prototype.getData=function(){return this.data_},e.prototype.getError=function(){return this.error_},e.prototype.load=function(){if(!(this.state!==O.IDLE&&this.state!==O.ERROR)){this.state=O.LOADING,this.changed();var t=this;this.loader_().then(function(r){t.data_=r,t.state=O.LOADED,t.changed()}).catch(function(r){t.error_=r,t.state=O.ERROR,t.changed()})}},e}(ni);const Fa=jf;var Bf=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Xf=function(i){Bf(e,i);function e(t){var r=this,n=t.projection===void 0?"EPSG:3857":t.projection,o=t.tileGrid;if(o===void 0&&n&&(o=La({extent:rn(n),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize})),r=i.call(this,{cacheSize:.1,attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:n,tileGrid:o,opaque:t.opaque,state:t.state,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate})||this,r.gutter_=t.gutter!==void 0?t.gutter:0,r.tileSize_=t.tileSize?gt(t.tileSize):null,!r.tileSize_&&t.tilePixelRatio&&o){var a=gt(o.getTileSize(0));r.tileSize_=[a[0]*t.tilePixelRatio,a[1]*t.tilePixelRatio]}return r.tileSizes_=null,r.tileLoadingKeys_={},r.loader_=t.loader,r.handleTileChange_=r.handleTileChange_.bind(r),r.bandCount=t.bandCount===void 0?4:t.bandCount,r}return e.prototype.setTileSizes=function(t){this.tileSizes_=t},e.prototype.getTileSize=function(t){if(this.tileSizes_)return this.tileSizes_[t];if(this.tileSize_)return this.tileSize_;var r=this.getTileGrid();return r?gt(r.getTileSize(t)):[256,256]},e.prototype.getGutterForProjection=function(t){return this.gutter_},e.prototype.setLoader=function(t){this.loader_=t},e.prototype.getTile=function(t,r,n,o,a){var s=this.getTileSize(t),l=sr(t,r,n);if(this.tileCache.containsKey(l))return this.tileCache.get(l);var u=this.loader_;function c(){return Gs(function(){return u(t,r,n)})}var h=tt({tileCoord:[t,r,n],loader:c,size:s},this.tileOptions),f=new Fa(h);return f.key=this.getKey(),f.addEventListener(M.CHANGE,this.handleTileChange_),this.tileCache.set(l,f),f},e.prototype.handleTileChange_=function(t){var r=t.target,n=nt(r),o=r.getState(),a;o==O.LOADING?(this.tileLoadingKeys_[n]=!0,a=Le.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],a=o==O.ERROR?Le.TILELOADERROR:o==O.LOADED?Le.TILELOADEND:void 0),a&&this.dispatchEvent(new ba(a,r))},e}(Na);const Kf=Xf;function ft(i){return(e,...t)=>zf(i,e,t)}function je(i,e){return ft(Ga(i,e).get)}const{apply:zf,construct:Sv,defineProperty:Iv,get:Lv,getOwnPropertyDescriptor:Ga,getPrototypeOf:di,has:Dv,ownKeys:Vf,set:Mv,setPrototypeOf:bv}=Reflect,{iterator:lr,species:Nv,toStringTag:kf,for:Fv}=Symbol,Yf=Object,{create:vi,defineProperty:Zf,freeze:Gv,is:Uv}=Yf,$f=Array,Hf=$f.prototype,Ua=Hf[lr],Wf=ft(Ua),ja=ArrayBuffer,qf=ja.prototype;je(qf,"byteLength");const _o=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null;_o&&je(_o.prototype,"byteLength");const Ba=di(Uint8Array);Ba.from;const _t=Ba.prototype;_t[lr];ft(_t.keys);ft(_t.values);ft(_t.entries);ft(_t.set);ft(_t.reverse);ft(_t.fill);ft(_t.copyWithin);ft(_t.sort);ft(_t.slice);ft(_t.subarray);je(_t,"buffer");je(_t,"byteOffset");je(_t,"length");je(_t,kf);const Qf=Uint8Array,Xa=Uint16Array,gi=Uint32Array,Jf=Float32Array,rr=di([][lr]()),Ka=ft(rr.next),tp=ft(function*(){}().next),ep=di(rr),rp=DataView.prototype,np=ft(rp.getUint16),_i=WeakMap,za=_i.prototype,Va=ft(za.get),ip=ft(za.set),ka=new _i,op=vi(null,{next:{value:function(){const e=Va(ka,this);return Ka(e)}},[lr]:{value:function(){return this}}});function ap(i){if(i[lr]===Ua&&rr.next===Ka)return i;const e=vi(op);return ip(ka,e,Wf(i)),e}const sp=new _i,lp=vi(ep,{next:{value:function(){const e=Va(sp,this);return tp(e)},writable:!0,configurable:!0}});for(const i of Vf(rr))i!=="next"&&Zf(lp,i,Ga(rr,i));const Ya=new ja(4),up=new Jf(Ya),cp=new gi(Ya),Nt=new Xa(512),Ft=new Qf(512);for(let i=0;i<256;++i){const e=i-127;e<-24?(Nt[i]=0,Nt[i|256]=32768,Ft[i]=24,Ft[i|256]=24):e<-14?(Nt[i]=1024>>-e-14,Nt[i|256]=1024>>-e-14|32768,Ft[i]=-e-1,Ft[i|256]=-e-1):e<=15?(Nt[i]=e+15<<10,Nt[i|256]=e+15<<10|32768,Ft[i]=13,Ft[i|256]=13):e<128?(Nt[i]=31744,Nt[i|256]=64512,Ft[i]=24,Ft[i|256]=24):(Nt[i]=31744,Nt[i|256]=64512,Ft[i]=13,Ft[i|256]=13)}const yi=new gi(2048);for(let i=1;i<1024;++i){let e=i<<13,t=0;for(;!(e&8388608);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,yi[i]=e|t}for(let i=1024;i<2048;++i)yi[i]=939524096+(i-1024<<13);const Be=new gi(64);for(let i=1;i<31;++i)Be[i]=i<<23;Be[31]=1199570944;Be[32]=2147483648;for(let i=33;i<63;++i)Be[i]=2147483648+(i-32<<23);Be[63]=3347054592;const Za=new Xa(64);for(let i=1;i<64;++i)i!==32&&(Za[i]=1024);function hp(i){const e=i>>10;return cp[0]=yi[Za[e]+(i&1023)]+Be[e],up[0]}function $a(i,e,...t){return hp(np(i,e,...ap(t)))}function mi(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Ei={exports:{}};function Ha(i,e,t){const r=t&&t.debug||!1;r&&console.log("[xml-utils] getting "+e+" in "+i);const n=typeof i=="object"?i.outer:i,o=n.slice(0,n.indexOf(">")+1),a=['"',"'"];for(let s=0;s<a.length;s++){const l=a[s],u=e+"\\="+l+"([^"+l+"]*)"+l;r&&console.log("[xml-utils] pattern:",u);const h=new RegExp(u).exec(o);if(r&&console.log("[xml-utils] match:",h),h)return h[1]}}Ei.exports=Ha;Ei.exports.default=Ha;var fp=Ei.exports;const _n=mi(fp);var Ti={exports:{}},Ri={exports:{}},xi={exports:{}};function Wa(i,e,t){const n=new RegExp(e).exec(i.slice(t));return n?t+n.index:-1}xi.exports=Wa;xi.exports.default=Wa;var pp=xi.exports,wi={exports:{}};function qa(i,e,t){const n=new RegExp(e).exec(i.slice(t));return n?t+n.index+n[0].length-1:-1}wi.exports=qa;wi.exports.default=qa;var dp=wi.exports,Ci={exports:{}};function Qa(i,e){const t=new RegExp(e,"g"),r=i.match(t);return r?r.length:0}Ci.exports=Qa;Ci.exports.default=Qa;var vp=Ci.exports;const gp=pp,yn=dp,yo=vp;function Ja(i,e,t){const r=t&&t.debug||!1,n=!(t&&typeof t.nested===!1),o=t&&t.startIndex||0;r&&console.log("[xml-utils] starting findTagByName with",e," and ",t);const a=gp(i,`<${e}[ 
>/]`,o);if(r&&console.log("[xml-utils] start:",a),a===-1)return;const s=i.slice(a+e.length);let l=yn(s,"^[^<]*[ /]>",0);const u=l!==-1&&s[l-1]==="/";if(r&&console.log("[xml-utils] selfClosing:",u),u===!1)if(n){let p=0,d=1,v=0;for(;(l=yn(s,"[ /]"+e+">",p))!==-1;){const g=s.substring(p,l+1);if(d+=yo(g,"<"+e+`[ 
	>]`),v+=yo(g,"</"+e+">"),v>=d)break;p=l}}else l=yn(s,"[ /]"+e+">",0);const c=a+e.length+l+1;if(r&&console.log("[xml-utils] end:",c),c===-1)return;const h=i.slice(a,c);let f;return u?f=null:f=h.slice(h.indexOf(">")+1,h.lastIndexOf("<")),{inner:f,outer:h,start:a,end:c}}Ri.exports=Ja;Ri.exports.default=Ja;var _p=Ri.exports;const yp=_p;function ts(i,e,t){const r=[],n=t&&t.debug||!1,o=t&&typeof t.nested=="boolean"?t.nested:!0;let a=t&&t.startIndex||0,s;for(;s=yp(i,e,{debug:n,startIndex:a});)o?a=s.start+1+e.length:a=s.end,r.push(s);return n&&console.log("findTagsByName found",r.length,"tags"),r}Ti.exports=ts;Ti.exports.default=ts;var mp=Ti.exports;const Ep=mi(mp),qe={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},Gt={};for(const i in qe)qe.hasOwnProperty(i)&&(Gt[qe[i]]=parseInt(i,10));const Tp=[Gt.BitsPerSample,Gt.ExtraSamples,Gt.SampleFormat,Gt.StripByteCounts,Gt.StripOffsets,Gt.StripRowCounts,Gt.TileByteCounts,Gt.TileOffsets,Gt.SubIFDs],mn={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},b={};for(const i in mn)mn.hasOwnProperty(i)&&(b[mn[i]]=parseInt(i,10));const Tt={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},Rp={Unspecified:0,Assocalpha:1,Unassalpha:2},jv={Version:0,AddCompression:1},Bv={None:0,Deflate:1},xp={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};function wp(i,e){const{width:t,height:r}=i,n=new Uint8Array(t*r*3);let o;for(let a=0,s=0;a<i.length;++a,s+=3)o=256-i[a]/e*256,n[s]=o,n[s+1]=o,n[s+2]=o;return n}function Cp(i,e){const{width:t,height:r}=i,n=new Uint8Array(t*r*3);let o;for(let a=0,s=0;a<i.length;++a,s+=3)o=i[a]/e*256,n[s]=o,n[s+1]=o,n[s+2]=o;return n}function Op(i,e){const{width:t,height:r}=i,n=new Uint8Array(t*r*3),o=e.length/3,a=e.length/3*2;for(let s=0,l=0;s<i.length;++s,l+=3){const u=i[s];n[l]=e[u]/65536*256,n[l+1]=e[u+o]/65536*256,n[l+2]=e[u+a]/65536*256}return n}function Ap(i){const{width:e,height:t}=i,r=new Uint8Array(e*t*3);for(let n=0,o=0;n<i.length;n+=4,o+=3){const a=i[n],s=i[n+1],l=i[n+2],u=i[n+3];r[o]=255*((255-a)/256)*((255-u)/256),r[o+1]=255*((255-s)/256)*((255-u)/256),r[o+2]=255*((255-l)/256)*((255-u)/256)}return r}function Pp(i){const{width:e,height:t}=i,r=new Uint8ClampedArray(e*t*3);for(let n=0,o=0;n<i.length;n+=3,o+=3){const a=i[n],s=i[n+1],l=i[n+2];r[o]=a+1.402*(l-128),r[o+1]=a-.34414*(s-128)-.71414*(l-128),r[o+2]=a+1.772*(s-128)}return r}const Sp=.95047,Ip=1,Lp=1.08883;function Dp(i){const{width:e,height:t}=i,r=new Uint8Array(e*t*3);for(let n=0,o=0;n<i.length;n+=3,o+=3){const a=i[n+0],s=i[n+1]<<24>>24,l=i[n+2]<<24>>24;let u=(a+16)/116,c=s/500+u,h=u-l/200,f,p,d;c=Sp*(c*c*c>.008856?c*c*c:(c-16/116)/7.787),u=Ip*(u*u*u>.008856?u*u*u:(u-16/116)/7.787),h=Lp*(h*h*h>.008856?h*h*h:(h-16/116)/7.787),f=c*3.2406+u*-1.5372+h*-.4986,p=c*-.9689+u*1.8758+h*.0415,d=c*.0557+u*-.204+h*1.057,f=f>.0031308?1.055*f**(1/2.4)-.055:12.92*f,p=p>.0031308?1.055*p**(1/2.4)-.055:12.92*p,d=d>.0031308?1.055*d**(1/2.4)-.055:12.92*d,r[o]=Math.max(0,Math.min(1,f))*255,r[o+1]=Math.max(0,Math.min(1,p))*255,r[o+2]=Math.max(0,Math.min(1,d))*255}return r}const Mp="modulepreload",bp=function(i){return"/power-outage-risk-website/"+i},mo={},re=function(e,t,r){if(!t||t.length===0)return e();const n=document.getElementsByTagName("link");return Promise.all(t.map(o=>{if(o=bp(o),o in mo)return;mo[o]=!0;const a=o.endsWith(".css"),s=a?'[rel="stylesheet"]':"";if(!!r)for(let c=n.length-1;c>=0;c--){const h=n[c];if(h.href===o&&(!a||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${s}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":Mp,a||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),a)return new Promise((c,h)=>{u.addEventListener("load",c),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o})},es=new Map;function ne(i,e){Array.isArray(i)||(i=[i]),i.forEach(t=>es.set(t,e))}async function rs(i){const e=es.get(i.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${i.Compression}`);const t=await e();return new t(i)}ne([void 0,1],()=>re(()=>import("./raw-7a0fe838.js"),["assets/raw-7a0fe838.js","assets/basedecoder-3573ccae.js"]).then(i=>i.default));ne(5,()=>re(()=>import("./lzw-901d9363.js"),["assets/lzw-901d9363.js","assets/basedecoder-3573ccae.js"]).then(i=>i.default));ne(6,()=>{throw new Error("old style JPEG compression is not supported.")});ne(7,()=>re(()=>import("./jpeg-2f15dd85.js"),["assets/jpeg-2f15dd85.js","assets/basedecoder-3573ccae.js"]).then(i=>i.default));ne([8,32946],()=>re(()=>import("./deflate-29fb883b.js"),["assets/deflate-29fb883b.js","assets/pako.esm-bae9e474.js","assets/basedecoder-3573ccae.js"]).then(i=>i.default));ne(32773,()=>re(()=>import("./packbits-90020365.js"),["assets/packbits-90020365.js","assets/basedecoder-3573ccae.js"]).then(i=>i.default));ne(34887,()=>re(()=>import("./lerc-fa9483a1.js"),["assets/lerc-fa9483a1.js","assets/pako.esm-bae9e474.js","assets/basedecoder-3573ccae.js"]).then(i=>i.default));ne(50001,()=>re(()=>import("./webimage-aa764004.js"),["assets/webimage-aa764004.js","assets/basedecoder-3573ccae.js"]).then(i=>i.default));function nn(i,e,t,r=1){return new(Object.getPrototypeOf(i)).constructor(e*t*r)}function Np(i,e,t,r,n){const o=e/r,a=t/n;return i.map(s=>{const l=nn(s,r,n);for(let u=0;u<n;++u){const c=Math.min(Math.round(a*u),t-1);for(let h=0;h<r;++h){const f=Math.min(Math.round(o*h),e-1),p=s[c*e+f];l[u*r+h]=p}}return l})}function De(i,e,t){return(1-t)*i+t*e}function Fp(i,e,t,r,n){const o=e/r,a=t/n;return i.map(s=>{const l=nn(s,r,n);for(let u=0;u<n;++u){const c=a*u,h=Math.floor(c),f=Math.min(Math.ceil(c),t-1);for(let p=0;p<r;++p){const d=o*p,v=d%1,g=Math.floor(d),E=Math.min(Math.ceil(d),e-1),_=s[h*e+g],m=s[h*e+E],y=s[f*e+g],T=s[f*e+E],R=De(De(_,m,v),De(y,T,v),c%1);l[u*r+p]=R}}return l})}function Gp(i,e,t,r,n,o="nearest"){switch(o.toLowerCase()){case"nearest":return Np(i,e,t,r,n);case"bilinear":case"linear":return Fp(i,e,t,r,n);default:throw new Error(`Unsupported resampling method: '${o}'`)}}function Up(i,e,t,r,n,o){const a=e/r,s=t/n,l=nn(i,r,n,o);for(let u=0;u<n;++u){const c=Math.min(Math.round(s*u),t-1);for(let h=0;h<r;++h){const f=Math.min(Math.round(a*h),e-1);for(let p=0;p<o;++p){const d=i[c*e*o+f*o+p];l[u*r*o+h*o+p]=d}}}return l}function jp(i,e,t,r,n,o){const a=e/r,s=t/n,l=nn(i,r,n,o);for(let u=0;u<n;++u){const c=s*u,h=Math.floor(c),f=Math.min(Math.ceil(c),t-1);for(let p=0;p<r;++p){const d=a*p,v=d%1,g=Math.floor(d),E=Math.min(Math.ceil(d),e-1);for(let _=0;_<o;++_){const m=i[h*e*o+g*o+_],y=i[h*e*o+E*o+_],T=i[f*e*o+g*o+_],R=i[f*e*o+E*o+_],x=De(De(m,y,v),De(T,R,v),c%1);l[u*r*o+p*o+_]=x}}}return l}function Bp(i,e,t,r,n,o,a="nearest"){switch(a.toLowerCase()){case"nearest":return Up(i,e,t,r,n,o);case"bilinear":case"linear":return jp(i,e,t,r,n,o);default:throw new Error(`Unsupported resampling method: '${a}'`)}}function Xp(i,e,t){let r=0;for(let n=e;n<t;++n)r+=i[n];return r}function Kn(i,e,t){switch(i){case 1:if(e<=8)return new Uint8Array(t);if(e<=16)return new Uint16Array(t);if(e<=32)return new Uint32Array(t);break;case 2:if(e===8)return new Int8Array(t);if(e===16)return new Int16Array(t);if(e===32)return new Int32Array(t);break;case 3:switch(e){case 16:case 32:return new Float32Array(t);case 64:return new Float64Array(t)}break}throw Error("Unsupported data format/bitsPerSample")}function Kp(i,e){return(i===1||i===2)&&e<=32&&e%8===0?!1:!(i===3&&(e===16||e===32||e===64))}function zp(i,e,t,r,n,o,a){const s=new DataView(i),l=t===2?a*o:a*o*r,u=t===2?1:r,c=Kn(e,n,l),h=parseInt("1".repeat(n),2);if(e===1){let f;t===1?f=r*n:f=n;let p=o*f;p&7&&(p=p+7&-8);for(let d=0;d<a;++d){const v=d*p;for(let g=0;g<o;++g){const E=v+g*u*n;for(let _=0;_<u;++_){const m=E+_*n,y=(d*o+g)*u+_,T=Math.floor(m/8),R=m%8;if(R+n<=8)c[y]=s.getUint8(T)>>8-n-R&h;else if(R+n<=16)c[y]=s.getUint16(T)>>16-n-R&h;else if(R+n<=24){const x=s.getUint16(T)<<8|s.getUint8(T+2);c[y]=x>>24-n-R&h}else c[y]=s.getUint32(T)>>32-n-R&h}}}}return c.buffer}class Vp{constructor(e,t,r,n,o,a){this.fileDirectory=e,this.geoKeys=t,this.dataView=r,this.littleEndian=n,this.tiles=o?{}:null,this.isTiled=!e.StripOffsets;const s=e.PlanarConfiguration;if(this.planarConfiguration=typeof s>"u"?1:s,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=a}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel<"u"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip<"u"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(e){return this.isTiled||(e+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-e*this.getTileHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t)e+=this.getSampleByteSize(t);return e}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[e]/8)}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,r=this.fileDirectory.BitsPerSample[e];switch(t){case 1:if(r<=8)return DataView.prototype.getUint8;if(r<=16)return DataView.prototype.getUint16;if(r<=32)return DataView.prototype.getUint32;break;case 2:if(r<=8)return DataView.prototype.getInt8;if(r<=16)return DataView.prototype.getInt16;if(r<=32)return DataView.prototype.getInt32;break;case 3:switch(r){case 16:return function(n,o){return $a(this,n,o)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(e=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1}getBitsPerSample(e=0){return this.fileDirectory.BitsPerSample[e]}getArrayForSample(e,t){const r=this.getSampleFormat(e),n=this.getBitsPerSample(e);return Kn(r,n,t)}async getTileOrStrip(e,t,r,n,o){const a=Math.ceil(this.getWidth()/this.getTileWidth()),s=Math.ceil(this.getHeight()/this.getTileHeight());let l;const{tiles:u}=this;this.planarConfiguration===1?l=t*a+e:this.planarConfiguration===2&&(l=r*a*s+t*a+e);let c,h;this.isTiled?(c=this.fileDirectory.TileOffsets[l],h=this.fileDirectory.TileByteCounts[l]):(c=this.fileDirectory.StripOffsets[l],h=this.fileDirectory.StripByteCounts[l]);const f=(await this.source.fetch([{offset:c,length:h}],o))[0];let p;return u===null||!u[l]?(p=(async()=>{let d=await n.decode(this.fileDirectory,f);const v=this.getSampleFormat(),g=this.getBitsPerSample();return Kp(v,g)&&(d=zp(d,v,this.planarConfiguration,this.getSamplesPerPixel(),g,this.getTileWidth(),this.getBlockHeight(t))),d})(),u!==null&&(u[l]=p)):p=u[l],{x:e,y:t,sample:r,data:await p}}async _readRaster(e,t,r,n,o,a,s,l,u){const c=this.getTileWidth(),h=this.getTileHeight(),f=this.getWidth(),p=this.getHeight(),d=Math.max(Math.floor(e[0]/c),0),v=Math.min(Math.ceil(e[2]/c),Math.ceil(f/c)),g=Math.max(Math.floor(e[1]/h),0),E=Math.min(Math.ceil(e[3]/h),Math.ceil(p/h)),_=e[2]-e[0];let m=this.getBytesPerPixel();const y=[],T=[];for(let C=0;C<t.length;++C)this.planarConfiguration===1?y.push(Xp(this.fileDirectory.BitsPerSample,0,t[C])/8):y.push(0),T.push(this.getReaderForSample(t[C]));const R=[],{littleEndian:x}=this;for(let C=g;C<E;++C)for(let P=d;P<v;++P)for(let I=0;I<t.length;++I){const S=I,X=t[I];this.planarConfiguration===2&&(m=this.getSampleByteSize(I));const V=this.getTileOrStrip(P,C,X,o,u);R.push(V),V.then(Z=>{const j=Z.data,F=new DataView(j),G=this.getBlockHeight(Z.y),L=Z.y*h,k=Z.x*c,B=L+G,Q=(Z.x+1)*c,pt=T[S],st=Math.min(G,G-(B-e[3]),p-L),it=Math.min(c,c-(Q-e[2]),f-k);for(let U=Math.max(0,e[1]-L);U<st;++U)for(let ot=Math.max(0,e[0]-k);ot<it;++ot){const dt=(U*c+ot)*m,q=pt.call(F,dt+y[S],x);let mt;n?(mt=(U+L-e[1])*_*t.length+(ot+k-e[0])*t.length+S,r[mt]=q):(mt=(U+L-e[1])*_+ot+k-e[0],r[S][mt]=q)}})}if(await Promise.all(R),a&&e[2]-e[0]!==a||s&&e[3]-e[1]!==s){let C;return n?C=Bp(r,e[2]-e[0],e[3]-e[1],a,s,t.length,l):C=Gp(r,e[2]-e[0],e[3]-e[1],a,s,l),C.width=a,C.height=s,C}return r.width=a||e[2]-e[0],r.height=s||e[3]-e[1],r}async readRasters({window:e,samples:t=[],interleave:r,pool:n=null,width:o,height:a,resampleMethod:s,fillValue:l,signal:u}={}){const c=e||[0,0,this.getWidth(),this.getHeight()];if(c[0]>c[2]||c[1]>c[3])throw new Error("Invalid subsets");const h=c[2]-c[0],f=c[3]-c[1],p=h*f,d=this.getSamplesPerPixel();if(!t||!t.length)for(let _=0;_<d;++_)t.push(_);else for(let _=0;_<t.length;++_)if(t[_]>=d)return Promise.reject(new RangeError(`Invalid sample index '${t[_]}'.`));let v;if(r){const _=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,m=Math.max.apply(null,this.fileDirectory.BitsPerSample);v=Kn(_,m,p*t.length),l&&v.fill(l)}else{v=[];for(let _=0;_<t.length;++_){const m=this.getArrayForSample(t[_],p);Array.isArray(l)&&_<l.length?m.fill(l[_]):l&&!Array.isArray(l)&&m.fill(l),v.push(m)}}const g=n||await rs(this.fileDirectory);return await this._readRaster(c,t,v,r,g,o,a,s,u)}async readRGB({window:e,interleave:t=!0,pool:r=null,width:n,height:o,resampleMethod:a,enableAlpha:s=!1,signal:l}={}){const u=e||[0,0,this.getWidth(),this.getHeight()];if(u[0]>u[2]||u[1]>u[3])throw new Error("Invalid subsets");const c=this.fileDirectory.PhotometricInterpretation;if(c===Tt.RGB){let E=[0,1,2];if(this.fileDirectory.ExtraSamples!==Rp.Unspecified&&s){E=[];for(let _=0;_<this.fileDirectory.BitsPerSample.length;_+=1)E.push(_)}return this.readRasters({window:e,interleave:t,samples:E,pool:r,width:n,height:o,resampleMethod:a,signal:l})}let h;switch(c){case Tt.WhiteIsZero:case Tt.BlackIsZero:case Tt.Palette:h=[0];break;case Tt.CMYK:h=[0,1,2,3];break;case Tt.YCbCr:case Tt.CIELab:h=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const f={window:u,interleave:!0,samples:h,pool:r,width:n,height:o,resampleMethod:a,signal:l},{fileDirectory:p}=this,d=await this.readRasters(f),v=2**this.fileDirectory.BitsPerSample[0];let g;switch(c){case Tt.WhiteIsZero:g=wp(d,v);break;case Tt.BlackIsZero:g=Cp(d,v);break;case Tt.Palette:g=Op(d,p.ColorMap);break;case Tt.CMYK:g=Ap(d);break;case Tt.YCbCr:g=Pp(d);break;case Tt.CIELab:g=Dp(d);break;default:throw new Error("Unsupported photometric interpretation.")}if(!t){const E=new Uint8Array(g.length/3),_=new Uint8Array(g.length/3),m=new Uint8Array(g.length/3);for(let y=0,T=0;y<g.length;y+=3,++T)E[T]=g[y],_[T]=g[y+1],m[T]=g[y+2];g=[E,_,m]}return g.width=d.width,g.height=d.height,g}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const r=this.fileDirectory.GDAL_METADATA;let n=Ep(r,"Item");e===null?n=n.filter(o=>_n(o,"sample")===void 0):n=n.filter(o=>Number(_n(o,"sample"))===e);for(let o=0;o<n.length;++o){const a=n[o];t[_n(a,"name")]=a.inner}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&e.length===6)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,r=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(r)return[r[0],r[5],r[10]];if(e){const[n,o,a]=e.getResolution();return[n*e.getWidth()/this.getWidth(),o*e.getHeight()/this.getHeight(),a*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(){const e=this.getOrigin(),t=this.getResolution(),r=e[0],n=e[1],o=r+t[0]*this.getWidth(),a=n+t[1]*this.getHeight();return[Math.min(r,o),Math.min(n,a),Math.max(r,o),Math.max(n,a)]}}const ns=Vp;class kp{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const r=this.getUint32(e,t),n=this.getUint32(e+4,t);let o;if(t){if(o=r+2**32*n,!Number.isSafeInteger(o))throw new Error(`${o} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return o}if(o=2**32*r+n,!Number.isSafeInteger(o))throw new Error(`${o} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return o}getInt64(e,t){let r=0;const n=(this._dataView.getUint8(e+(t?7:0))&128)>0;let o=!0;for(let a=0;a<8;a++){let s=this._dataView.getUint8(e+(t?a:7-a));n&&(o?s!==0&&(s=~(s-1)&255,o=!1):s=~s&255),r+=s*256**a}return n&&(r=-r),r}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat16(e,t){return $a(this._dataView,e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}class Yp{constructor(e,t,r,n){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=r,this._bigTiff=n}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),r=this.readUint32(e+4);let n;if(this._littleEndian){if(n=t+2**32*r,!Number.isSafeInteger(n))throw new Error(`${n} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return n}if(n=2**32*t+r,!Number.isSafeInteger(n))throw new Error(`${n} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return n}readInt64(e){let t=0;const r=(this._dataView.getUint8(e+(this._littleEndian?7:0))&128)>0;let n=!0;for(let o=0;o<8;o++){let a=this._dataView.getUint8(e+(this._littleEndian?o:7-o));r&&(n?a!==0&&(a=~(a-1)&255,n=!1):a=~a&255),t+=a*256**o}return r&&(t=-t),t}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}const Zp=typeof navigator<"u"&&navigator.hardwareConcurrency||2;class $p{constructor(e=Zp,t){this.workers=null,this._awaitingDecoder=null,this.size=e,this.messageId=0,e&&(this._awaitingDecoder=t?Promise.resolve(t):new Promise(r=>{re(()=>import("./decoder-c05d4535.js"),[]).then(n=>{r(n.create)})}),this._awaitingDecoder.then(r=>{this._awaitingDecoder=null,this.workers=[];for(let n=0;n<e;n++)this.workers.push({worker:r(),idle:!0})}))}async decode(e,t){return this._awaitingDecoder&&await this._awaitingDecoder,this.size===0?rs(e).then(r=>r.decode(e,t)):new Promise(r=>{const n=this.workers.find(s=>s.idle)||this.workers[Math.floor(Math.random()*this.size)];n.idle=!1;const o=this.messageId++,a=s=>{s.data.id===o&&(n.idle=!0,r(s.data.decoded),n.worker.removeEventListener("message",a))};n.worker.addEventListener("message",a),n.worker.postMessage({fileDirectory:e,buffer:t,id:o},[t])})}destroy(){this.workers&&(this.workers.forEach(e=>{e.worker.terminate()}),this.workers=null)}}const Hp=$p,Eo=`\r
\r
`;function is(i){if(typeof Object.fromEntries<"u")return Object.fromEntries(i);const e={};for(const[t,r]of i)e[t.toLowerCase()]=r;return e}function Wp(i){const e=i.split(`\r
`).map(t=>{const r=t.split(":").map(n=>n.trim());return r[0]=r[0].toLowerCase(),r});return is(e)}function qp(i){const[e,...t]=i.split(";").map(n=>n.trim()),r=t.map(n=>n.split("="));return{type:e,params:is(r)}}function zn(i){let e,t,r;return i&&([,e,t,r]=i.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),t=parseInt(t,10),r=parseInt(r,10)),{start:e,end:t,total:r}}function Qp(i,e){let t=null;const r=new TextDecoder("ascii"),n=[],o=`--${e}`,a=`${o}--`;for(let s=0;s<10;++s)r.decode(new Uint8Array(i,s,o.length))===o&&(t=s);if(t===null)throw new Error("Could not find initial boundary");for(;t<i.byteLength;){const s=r.decode(new Uint8Array(i,t,Math.min(o.length+1024,i.byteLength-t)));if(s.length===0||s.startsWith(a))break;if(!s.startsWith(o))throw new Error("Part does not start with boundary");const l=s.substr(o.length+2);if(l.length===0)break;const u=l.indexOf(Eo),c=Wp(l.substr(0,u)),{start:h,end:f,total:p}=zn(c["content-range"]),d=t+o.length+u+Eo.length,v=parseInt(f,10)+1-parseInt(h,10);n.push({headers:c,data:i.slice(d,d+v),offset:h,length:v,fileSize:p}),t=d+v+4}return n}class Oi{async fetch(e,t=void 0){return Promise.all(e.map(r=>this.fetchSlice(r,t)))}async fetchSlice(e){throw new Error(`fetching of slice ${e} not possible, not implemented`)}get fileSize(){return null}async close(){}}var En,To;function Jp(){return To||(To=1,En=function(i){i.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),En}var td=K;K.Node=pe;K.create=K;function K(i){var e=this;if(e instanceof K||(e=new K),e.tail=null,e.head=null,e.length=0,i&&typeof i.forEach=="function")i.forEach(function(n){e.push(n)});else if(arguments.length>0)for(var t=0,r=arguments.length;t<r;t++)e.push(arguments[t]);return e}K.prototype.removeNode=function(i){if(i.list!==this)throw new Error("removing node which does not belong to this list");var e=i.next,t=i.prev;return e&&(e.prev=t),t&&(t.next=e),i===this.head&&(this.head=e),i===this.tail&&(this.tail=t),i.list.length--,i.next=null,i.prev=null,i.list=null,e};K.prototype.unshiftNode=function(i){if(i!==this.head){i.list&&i.list.removeNode(i);var e=this.head;i.list=this,i.next=e,e&&(e.prev=i),this.head=i,this.tail||(this.tail=i),this.length++}};K.prototype.pushNode=function(i){if(i!==this.tail){i.list&&i.list.removeNode(i);var e=this.tail;i.list=this,i.prev=e,e&&(e.next=i),this.tail=i,this.head||(this.head=i),this.length++}};K.prototype.push=function(){for(var i=0,e=arguments.length;i<e;i++)rd(this,arguments[i]);return this.length};K.prototype.unshift=function(){for(var i=0,e=arguments.length;i<e;i++)nd(this,arguments[i]);return this.length};K.prototype.pop=function(){if(this.tail){var i=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,i}};K.prototype.shift=function(){if(this.head){var i=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,i}};K.prototype.forEach=function(i,e){e=e||this;for(var t=this.head,r=0;t!==null;r++)i.call(e,t.value,r,this),t=t.next};K.prototype.forEachReverse=function(i,e){e=e||this;for(var t=this.tail,r=this.length-1;t!==null;r--)i.call(e,t.value,r,this),t=t.prev};K.prototype.get=function(i){for(var e=0,t=this.head;t!==null&&e<i;e++)t=t.next;if(e===i&&t!==null)return t.value};K.prototype.getReverse=function(i){for(var e=0,t=this.tail;t!==null&&e<i;e++)t=t.prev;if(e===i&&t!==null)return t.value};K.prototype.map=function(i,e){e=e||this;for(var t=new K,r=this.head;r!==null;)t.push(i.call(e,r.value,this)),r=r.next;return t};K.prototype.mapReverse=function(i,e){e=e||this;for(var t=new K,r=this.tail;r!==null;)t.push(i.call(e,r.value,this)),r=r.prev;return t};K.prototype.reduce=function(i,e){var t,r=this.head;if(arguments.length>1)t=e;else if(this.head)r=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var n=0;r!==null;n++)t=i(t,r.value,n),r=r.next;return t};K.prototype.reduceReverse=function(i,e){var t,r=this.tail;if(arguments.length>1)t=e;else if(this.tail)r=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var n=this.length-1;r!==null;n--)t=i(t,r.value,n),r=r.prev;return t};K.prototype.toArray=function(){for(var i=new Array(this.length),e=0,t=this.head;t!==null;e++)i[e]=t.value,t=t.next;return i};K.prototype.toArrayReverse=function(){for(var i=new Array(this.length),e=0,t=this.tail;t!==null;e++)i[e]=t.value,t=t.prev;return i};K.prototype.slice=function(i,e){e=e||this.length,e<0&&(e+=this.length),i=i||0,i<0&&(i+=this.length);var t=new K;if(e<i||e<0)return t;i<0&&(i=0),e>this.length&&(e=this.length);for(var r=0,n=this.head;n!==null&&r<i;r++)n=n.next;for(;n!==null&&r<e;r++,n=n.next)t.push(n.value);return t};K.prototype.sliceReverse=function(i,e){e=e||this.length,e<0&&(e+=this.length),i=i||0,i<0&&(i+=this.length);var t=new K;if(e<i||e<0)return t;i<0&&(i=0),e>this.length&&(e=this.length);for(var r=this.length,n=this.tail;n!==null&&r>e;r--)n=n.prev;for(;n!==null&&r>i;r--,n=n.prev)t.push(n.value);return t};K.prototype.splice=function(i,e,...t){i>this.length&&(i=this.length-1),i<0&&(i=this.length+i);for(var r=0,n=this.head;n!==null&&r<i;r++)n=n.next;for(var o=[],r=0;n&&r<e;r++)o.push(n.value),n=this.removeNode(n);n===null&&(n=this.tail),n!==this.head&&n!==this.tail&&(n=n.prev);for(var r=0;r<t.length;r++)n=ed(this,n,t[r]);return o};K.prototype.reverse=function(){for(var i=this.head,e=this.tail,t=i;t!==null;t=t.prev){var r=t.prev;t.prev=t.next,t.next=r}return this.head=e,this.tail=i,this};function ed(i,e,t){var r=e===i.head?new pe(t,null,e,i):new pe(t,e,e.next,i);return r.next===null&&(i.tail=r),r.prev===null&&(i.head=r),i.length++,r}function rd(i,e){i.tail=new pe(e,i.tail,null,i),i.head||(i.head=i.tail),i.length++}function nd(i,e){i.head=new pe(e,null,i.head,i),i.tail||(i.tail=i.head),i.length++}function pe(i,e,t,r){if(!(this instanceof pe))return new pe(i,e,t,r);this.list=r,this.value=i,e?(e.next=this,this.prev=e):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{Jp()(K)}catch{}const id=td,le=Symbol("max"),zt=Symbol("length"),Te=Symbol("lengthCalculator"),Qe=Symbol("allowStale"),ce=Symbol("maxAge"),Kt=Symbol("dispose"),Ro=Symbol("noDisposeOnSet"),lt=Symbol("lruList"),Dt=Symbol("cache"),os=Symbol("updateAgeOnGet"),Tn=()=>1;class od{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");this[le]=e.max||1/0;const t=e.length||Tn;if(this[Te]=typeof t!="function"?Tn:t,this[Qe]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[ce]=e.maxAge||0,this[Kt]=e.dispose,this[Ro]=e.noDisposeOnSet||!1,this[os]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[le]=e||1/0,ke(this)}get max(){return this[le]}set allowStale(e){this[Qe]=!!e}get allowStale(){return this[Qe]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[ce]=e,ke(this)}get maxAge(){return this[ce]}set lengthCalculator(e){typeof e!="function"&&(e=Tn),e!==this[Te]&&(this[Te]=e,this[zt]=0,this[lt].forEach(t=>{t.length=this[Te](t.value,t.key),this[zt]+=t.length})),ke(this)}get lengthCalculator(){return this[Te]}get length(){return this[zt]}get itemCount(){return this[lt].length}rforEach(e,t){t=t||this;for(let r=this[lt].tail;r!==null;){const n=r.prev;xo(this,e,r,t),r=n}}forEach(e,t){t=t||this;for(let r=this[lt].head;r!==null;){const n=r.next;xo(this,e,r,t),r=n}}keys(){return this[lt].toArray().map(e=>e.key)}values(){return this[lt].toArray().map(e=>e.value)}reset(){this[Kt]&&this[lt]&&this[lt].length&&this[lt].forEach(e=>this[Kt](e.key,e.value)),this[Dt]=new Map,this[lt]=new id,this[zt]=0}dump(){return this[lt].map(e=>Br(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[lt]}set(e,t,r){if(r=r||this[ce],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const n=r?Date.now():0,o=this[Te](t,e);if(this[Dt].has(e)){if(o>this[le])return Me(this,this[Dt].get(e)),!1;const l=this[Dt].get(e).value;return this[Kt]&&(this[Ro]||this[Kt](e,l.value)),l.now=n,l.maxAge=r,l.value=t,this[zt]+=o-l.length,l.length=o,this.get(e),ke(this),!0}const a=new ad(e,t,o,n,r);return a.length>this[le]?(this[Kt]&&this[Kt](e,t),!1):(this[zt]+=a.length,this[lt].unshift(a),this[Dt].set(e,this[lt].head),ke(this),!0)}has(e){if(!this[Dt].has(e))return!1;const t=this[Dt].get(e).value;return!Br(this,t)}get(e){return Rn(this,e,!0)}peek(e){return Rn(this,e,!1)}pop(){const e=this[lt].tail;return e?(Me(this,e),e.value):null}del(e){Me(this,this[Dt].get(e))}load(e){this.reset();const t=Date.now();for(let r=e.length-1;r>=0;r--){const n=e[r],o=n.e||0;if(o===0)this.set(n.k,n.v);else{const a=o-t;a>0&&this.set(n.k,n.v,a)}}}prune(){this[Dt].forEach((e,t)=>Rn(this,t,!1))}}const Rn=(i,e,t)=>{const r=i[Dt].get(e);if(r){const n=r.value;if(Br(i,n)){if(Me(i,r),!i[Qe])return}else t&&(i[os]&&(r.value.now=Date.now()),i[lt].unshiftNode(r));return n.value}},Br=(i,e)=>{if(!e||!e.maxAge&&!i[ce])return!1;const t=Date.now()-e.now;return e.maxAge?t>e.maxAge:i[ce]&&t>i[ce]},ke=i=>{if(i[zt]>i[le])for(let e=i[lt].tail;i[zt]>i[le]&&e!==null;){const t=e.prev;Me(i,e),e=t}},Me=(i,e)=>{if(e){const t=e.value;i[Kt]&&i[Kt](t.key,t.value),i[zt]-=t.length,i[Dt].delete(t.key),i[lt].removeNode(e)}};class ad{constructor(e,t,r,n,o){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=o||0}}const xo=(i,e,t,r)=>{let n=t.value;Br(i,n)&&(Me(i,t),i[Qe]||(n=void 0)),n&&e.call(r,n.value,n.key,i)};var sd=od;const ld=mi(sd);async function ud(i){return new Promise(e=>setTimeout(e,i))}function wo(i,e){const t=Array.isArray(i)?i:Array.from(i),r=Array.isArray(e)?e:Array.from(e);return t.map((n,o)=>[n,r[o]])}class Fe extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,Fe),this.name="AbortError"}}class cd extends Error{constructor(e,t){super(t),this.errors=e,this.message=t,this.name="AggregateError"}}const hd=cd;class fd{constructor(e,t,r=null){this.offset=e,this.length=t,this.data=r}get top(){return this.offset+this.length}}class Co{constructor(e,t,r){this.offset=e,this.length=t,this.blockIds=r}}class pd extends Oi{constructor(e,{blockSize:t=65536,cacheSize:r=100}={}){super(),this.source=e,this.blockSize=t,this.blockCache=new ld({max:r}),this.blockRequests=new Map,this.blockIdsToFetch=new Set}get fileSize(){return this.source.fileSize}async fetch(e,t){const r=new Map,n=new Map,o=new Set;for(const{offset:u,length:c}of e){let h=u+c;const{fileSize:f}=this;f!==null&&(h=Math.min(h,f));const p=Math.floor(u/this.blockSize)*this.blockSize;for(let d=p;d<h;d+=this.blockSize){const v=Math.floor(d/this.blockSize);this.blockCache.has(v)?r.set(v,this.blockCache.get(v)):this.blockRequests.has(v)?n.set(v,this.blockRequests.get(v)):(this.blockIdsToFetch.has(v)||this.blockIdsToFetch.add(v),o.add(v))}}await ud(),this.fetchBlocks(t);for(const u of o){const c=this.blockRequests.get(u),h=this.blockCache.get(u);if(c)n.set(u,c);else if(h)r.set(u,h);else throw new Error(`Block ${u} is not in the block requests`)}let a=await Promise.allSettled(Array.from(n.values()));if(a.some(u=>u.status==="rejected")){const u=new Set;for(const[c,h]of wo(n.keys(),a)){const{rejected:f,reason:p}=h;f&&p.name==="AbortError"&&p.signal!==t&&(this.blockIdsToFetch.add(c),u.add(c))}if(this.blockIdsToFetch.length>0){this.fetchBlocks(t);for(const c of u){const h=this.blockRequests.get(c);if(!h)throw new Error(`Block ${c} is not in the block requests`);n.set(c,h)}a=await Promise.allSettled(Array.from(n.values()))}}if(a.some(u=>u.status==="rejected"))throw t&&t.aborted?new Fe("Request was aborted"):new hd(a.filter(u=>u.status==="rejected").map(u=>u.reason),"Request failed");const s=a.map(u=>u.value),l=new Map(wo(Array.from(n.keys()),s));for(const[u,c]of r)l.set(u,c);return this.readSliceData(e,l)}fetchBlocks(e){if(this.blockIdsToFetch.size>0){const t=this.groupBlocks(this.blockIdsToFetch),r=this.source.fetch(t,e);for(let n=0;n<t.length;++n){const o=t[n];for(const a of o.blockIds){const s=(async()=>{try{const l=(await r)[n],u=a*this.blockSize,c=u-l.offset,h=Math.min(c+this.blockSize,l.data.byteLength),f=l.data.slice(c,h),p=new fd(u,f.byteLength,f);return this.blockCache.set(a,p),p}catch(l){throw l.name==="AbortError"&&(l.signal=e),l}finally{this.blockRequests.delete(a)}})();this.blockRequests.set(a,s)}}this.blockIdsToFetch.clear()}}groupBlocks(e){const t=Array.from(e).sort((a,s)=>a-s);if(t.length===0)return[];let r=[],n=null;const o=[];for(const a of t)n===null||n+1===a?(r.push(a),n=a):(o.push(new Co(r[0]*this.blockSize,r.length*this.blockSize,r)),r=[a],n=a);return o.push(new Co(r[0]*this.blockSize,r.length*this.blockSize,r)),o}readSliceData(e,t){return e.map(r=>{const n=r.offset+r.length,o=Math.floor(r.offset/this.blockSize),a=Math.floor((r.offset+r.length)/this.blockSize),s=new ArrayBuffer(r.length),l=new Uint8Array(s);for(let u=o;u<=a;++u){const c=t.get(u),h=c.offset-r.offset,f=c.top-n;let p=0,d=0,v;h<0?p=-h:h>0&&(d=h),f<0?v=c.length-p:v=n-c.offset-p;const g=new Uint8Array(c.data,p,v);l.set(g,d)}return s})}}class Ai{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(e){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class Pi{constructor(e){this.url=e}async request({headers:e,credentials:t,signal:r}={}){throw new Error("request is not implemented")}}class dd extends Ai{constructor(e){super(),this.response=e}get status(){return this.response.status}getHeader(e){return this.response.headers.get(e)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class vd extends Pi{constructor(e,t){super(e),this.credentials=t}async request({headers:e,credentials:t,signal:r}={}){const n=await fetch(this.url,{headers:e,credentials:t,signal:r});return new dd(n)}}class gd extends Ai{constructor(e,t){super(),this.xhr=e,this.data=t}get status(){return this.xhr.status}getHeader(e){return this.xhr.getResponseHeader(e)}async getData(){return this.data}}class _d extends Pi{constructRequest(e,t){return new Promise((r,n)=>{const o=new XMLHttpRequest;o.open("GET",this.url),o.responseType="arraybuffer";for(const[a,s]of Object.entries(e))o.setRequestHeader(a,s);o.onload=()=>{const a=o.response;r(new gd(o,a))},o.onerror=n,o.onabort=()=>n(new Fe("Request aborted")),o.send(),t&&(t.aborted&&o.abort(),t.addEventListener("abort",()=>o.abort()))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}const xn={};class yd extends Ai{constructor(e,t){super(),this.response=e,this.dataPromise=t}get status(){return this.response.statusCode}getHeader(e){return this.response.headers[e]}async getData(){return await this.dataPromise}}class md extends Pi{constructor(e){super(e),this.parsedUrl=xn.parse(this.url),this.httpApi=(this.parsedUrl.protocol==="http:",xn)}constructRequest(e,t){return new Promise((r,n)=>{const o=this.httpApi.get({...this.parsedUrl,headers:e},a=>{const s=new Promise(l=>{const u=[];a.on("data",c=>{u.push(c)}),a.on("end",()=>{const c=Buffer.concat(u).buffer;l(c)}),a.on("error",n)});r(new yd(a,s))});o.on("error",n),t&&(t.aborted&&o.destroy(new Fe("Request aborted")),t.addEventListener("abort",()=>o.destroy(new Fe("Request aborted"))))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}class Si extends Oi{constructor(e,t,r,n){super(),this.client=e,this.headers=t,this.maxRanges=r,this.allowFullFile=n,this._fileSize=null}async fetch(e,t){return this.maxRanges>=e.length?this.fetchSlices(e,t):(this.maxRanges>0&&e.length>1,Promise.all(e.map(r=>this.fetchSlice(r,t))))}async fetchSlices(e,t){const r=await this.client.request({headers:{...this.headers,Range:`bytes=${e.map(({offset:n,length:o})=>`${n}-${n+o}`).join(",")}`},signal:t});if(r.ok)if(r.status===206){const{type:n,params:o}=qp(r.getHeader("content-type"));if(n==="multipart/byteranges"){const h=Qp(await r.getData(),o.boundary);return this._fileSize=h[0].fileSize||null,h}const a=await r.getData(),{start:s,end:l,total:u}=zn(r.getHeader("content-range"));this._fileSize=u||null;const c=[{data:a,offset:s,length:l-s}];if(e.length>1){const h=await Promise.all(e.slice(1).map(f=>this.fetchSlice(f,t)));return c.concat(h)}return c}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const n=await r.getData();return this._fileSize=n.byteLength,[{data:n,offset:0,length:n.byteLength}]}else throw new Error("Error fetching data.")}async fetchSlice(e,t){const{offset:r,length:n}=e,o=await this.client.request({headers:{...this.headers,Range:`bytes=${r}-${r+n}`},signal:t});if(o.ok)if(o.status===206){const a=await o.getData(),{total:s}=zn(o.getHeader("content-range"));return this._fileSize=s||null,{data:a,offset:r,length:n}}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const a=await o.getData();return this._fileSize=a.byteLength,{data:a,offset:0,length:a.byteLength}}else throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function Ii(i,{blockSize:e,cacheSize:t}){return e===null?i:new pd(i,e,t)}function Ed(i,{headers:e={},credentials:t,maxRanges:r=0,allowFullFile:n=!1,...o}={}){const a=new vd(i,t),s=new Si(a,e,r,n);return Ii(s,o)}function Td(i,{headers:e={},maxRanges:t=0,allowFullFile:r=!1,...n}={}){const o=new _d(i),a=new Si(o,e,t,r);return Ii(a,n)}function Rd(i,{headers:e={},maxRanges:t=0,allowFullFile:r=!1,...n}={}){const o=new md(i),a=new Si(o,e,t,r);return Ii(a,n)}function Vn(i,{forceXHR:e=!1,...t}={}){return typeof fetch=="function"&&!e?Ed(i,t):typeof XMLHttpRequest<"u"?Td(i,t):Rd(i,t)}class xd extends Oi{constructor(e){super(),this.file=e}async fetchSlice(e,t){return new Promise((r,n)=>{const o=this.file.slice(e.offset,e.offset+e.length),a=new FileReader;a.onload=s=>r(s.target.result),a.onerror=n,a.onabort=n,a.readAsArrayBuffer(o),t&&t.addEventListener("abort",()=>a.abort())})}}function wd(i){return new xd(i)}function kn(i){switch(i){case b.BYTE:case b.ASCII:case b.SBYTE:case b.UNDEFINED:return 1;case b.SHORT:case b.SSHORT:return 2;case b.LONG:case b.SLONG:case b.FLOAT:case b.IFD:return 4;case b.RATIONAL:case b.SRATIONAL:case b.DOUBLE:case b.LONG8:case b.SLONG8:case b.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${i}`)}}function Cd(i){const e=i.GeoKeyDirectory;if(!e)return null;const t={};for(let r=4;r<=e[3]*4;r+=4){const n=xp[e[r]],o=e[r+1]?qe[e[r+1]]:null,a=e[r+2],s=e[r+3];let l=null;if(!o)l=s;else{if(l=i[o],typeof l>"u"||l===null)throw new Error(`Could not get value of geoKey '${n}'.`);typeof l=="string"?l=l.substring(s,s+a-1):l.subarray&&(l=l.subarray(s,s+a),a===1&&(l=l[0]))}t[n]=l}return t}function Re(i,e,t,r){let n=null,o=null;const a=kn(e);switch(e){case b.BYTE:case b.ASCII:case b.UNDEFINED:n=new Uint8Array(t),o=i.readUint8;break;case b.SBYTE:n=new Int8Array(t),o=i.readInt8;break;case b.SHORT:n=new Uint16Array(t),o=i.readUint16;break;case b.SSHORT:n=new Int16Array(t),o=i.readInt16;break;case b.LONG:case b.IFD:n=new Uint32Array(t),o=i.readUint32;break;case b.SLONG:n=new Int32Array(t),o=i.readInt32;break;case b.LONG8:case b.IFD8:n=new Array(t),o=i.readUint64;break;case b.SLONG8:n=new Array(t),o=i.readInt64;break;case b.RATIONAL:n=new Uint32Array(t*2),o=i.readUint32;break;case b.SRATIONAL:n=new Int32Array(t*2),o=i.readInt32;break;case b.FLOAT:n=new Float32Array(t),o=i.readFloat32;break;case b.DOUBLE:n=new Float64Array(t),o=i.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e===b.RATIONAL||e===b.SRATIONAL)for(let s=0;s<t;s+=2)n[s]=o.call(i,r+s*a),n[s+1]=o.call(i,r+(s*a+4));else for(let s=0;s<t;++s)n[s]=o.call(i,r+s*a);return e===b.ASCII?new TextDecoder("utf-8").decode(n):n}class Od{constructor(e,t,r){this.fileDirectory=e,this.geoKeyDirectory=t,this.nextIFDByteOffset=r}}class Rr extends Error{constructor(e){super(`No image at index ${e}`),this.index=e}}class as{async readRasters(e={}){const{window:t,width:r,height:n}=e;let{resX:o,resY:a,bbox:s}=e;const l=await this.getImage();let u=l;const c=await this.getImageCount(),h=l.getBoundingBox();if(t&&s)throw new Error('Both "bbox" and "window" passed.');if(r||n){if(t){const[d,v]=l.getOrigin(),[g,E]=l.getResolution();s=[d+t[0]*g,v+t[1]*E,d+t[2]*g,v+t[3]*E]}const p=s||h;if(r){if(o)throw new Error("Both width and resX passed");o=(p[2]-p[0])/r}if(n){if(a)throw new Error("Both width and resY passed");a=(p[3]-p[1])/n}}if(o||a){const p=[];for(let d=0;d<c;++d){const v=await this.getImage(d),{SubfileType:g,NewSubfileType:E}=v.fileDirectory;(d===0||g===2||E&1)&&p.push(v)}p.sort((d,v)=>d.getWidth()-v.getWidth());for(let d=0;d<p.length;++d){const v=p[d],g=(h[2]-h[0])/v.getWidth(),E=(h[3]-h[1])/v.getHeight();if(u=v,o&&o>g||a&&a>E)break}}let f=t;if(s){const[p,d]=l.getOrigin(),[v,g]=u.getResolution(l);f=[Math.round((s[0]-p)/v),Math.round((s[1]-d)/g),Math.round((s[2]-p)/v),Math.round((s[3]-d)/g)],f=[Math.min(f[0],f[2]),Math.min(f[1],f[3]),Math.max(f[0],f[2]),Math.max(f[1],f[3])]}return u.readRasters({...e,window:f})}}let Xr=class ss extends as{constructor(e,t,r,n,o={}){super(),this.source=e,this.littleEndian=t,this.bigTiff=r,this.firstIFDOffset=n,this.cache=o.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(e,t){const r=this.bigTiff?4048:1024;return new Yp((await this.source.fetch([{offset:e,length:typeof t<"u"?t:r}]))[0],e,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(e){const t=this.bigTiff?20:12,r=this.bigTiff?8:2;let n=await this.getSlice(e);const o=this.bigTiff?n.readUint64(e):n.readUint16(e),a=o*t+(this.bigTiff?16:6);n.covers(e,a)||(n=await this.getSlice(e,a));const s={};let l=e+(this.bigTiff?8:2);for(let h=0;h<o;l+=t,++h){const f=n.readUint16(l),p=n.readUint16(l+2),d=this.bigTiff?n.readUint64(l+4):n.readUint32(l+4);let v,g;const E=kn(p),_=l+(this.bigTiff?12:8);if(E*d<=(this.bigTiff?8:4))v=Re(n,p,d,_);else{const m=n.readOffset(_),y=kn(p)*d;if(n.covers(m,y))v=Re(n,p,d,m);else{const T=await this.getSlice(m,y);v=Re(T,p,d,m)}}d===1&&Tp.indexOf(f)===-1&&!(p===b.RATIONAL||p===b.SRATIONAL)?g=v[0]:g=v,s[qe[f]]=g}const u=Cd(s),c=n.readOffset(e+r+t*o);return new Od(s,u,c)}async requestIFD(e){if(this.ifdRequests[e])return this.ifdRequests[e];if(e===0)return this.ifdRequests[e]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[e];if(!this.ifdRequests[e-1])try{this.ifdRequests[e-1]=this.requestIFD(e-1)}catch(t){throw t instanceof Rr?new Rr(e):t}return this.ifdRequests[e]=(async()=>{const t=await this.ifdRequests[e-1];if(t.nextIFDByteOffset===0)throw new Rr(e);return this.parseFileDirectoryAt(t.nextIFDByteOffset)})(),this.ifdRequests[e]}async getImage(e=0){const t=await this.requestIFD(e);return new ns(t.fileDirectory,t.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let e=0,t=!0;for(;t;)try{await this.requestIFD(e),++e}catch(r){if(r instanceof Rr)t=!1;else throw r}return e}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",r=t.length+100;let n=await this.getSlice(e,r);if(t===Re(n,b.ASCII,t.length,e)){const a=Re(n,b.ASCII,r,e).split(`
`)[0],s=Number(a.split("=")[1].split(" ")[0])+a.length;s>r&&(n=await this.getSlice(e,s));const l=Re(n,b.ASCII,s,e);this.ghostValues={},l.split(`
`).filter(u=>u.length>0).map(u=>u.split("=")).forEach(([u,c])=>{this.ghostValues[u]=c})}return this.ghostValues}static async fromSource(e,t,r){const n=(await e.fetch([{offset:0,length:1024}],r))[0],o=new kp(n),a=o.getUint16(0,0);let s;if(a===18761)s=!0;else if(a===19789)s=!1;else throw new TypeError("Invalid byte order value.");const l=o.getUint16(2,s);let u;if(l===42)u=!1;else if(l===43){if(u=!0,o.getUint16(4,s)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const c=u?o.getUint64(8,s):o.getUint32(4,s);return new ss(e,s,u,c,t)}close(){return typeof this.source.close=="function"?this.source.close():!1}};class Ad extends as{constructor(e,t){super(),this.mainFile=e,this.overviewFiles=t,this.imageFiles=[e].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(t=>t.parseFileDirectoryAt(t.firstIFDOffset)));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){await this.getImageCount(),await this.parseFileDirectoriesPerFile();let t=0,r=0;for(let n=0;n<this.imageFiles.length;n++){const o=this.imageFiles[n];for(let a=0;a<this.imageCounts[n];a++){if(e===t){const s=await o.requestIFD(r);return new ns(s.fileDirectory,s.geoKeyDirectory,o.dataView,o.littleEndian,o.cache,o.source)}t++,r++}r=0}throw new RangeError("Invalid image index")}async getImageCount(){if(this.imageCount!==null)return this.imageCount;const e=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(t=>t.getImageCount()));return this.imageCounts=await Promise.all(e),this.imageCount=this.imageCounts.reduce((t,r)=>t+r,0),this.imageCount}}async function Pd(i,e={},t){return Xr.fromSource(Vn(i,e),t)}async function Sd(i,e){return Xr.fromSource(wd(i),e)}async function Id(i,e=[],t={},r){const n=await Xr.fromSource(Vn(i,t),r),o=await Promise.all(e.map(a=>Xr.fromSource(Vn(a,t))));return new Ad(n,o)}var Ld=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Oo="STATISTICS_MAXIMUM",Ao="STATISTICS_MINIMUM",wn;function Dd(){return wn||(wn=new Hp),wn}function Md(i){try{return i.getBoundingBox()}catch{var e=i.fileDirectory;return[0,0,e.ImageWidth,e.ImageLength]}}function bd(i){try{return i.getOrigin().slice(0,2)}catch{return[0,i.fileDirectory.ImageLength]}}function Nd(i,e){try{return i.getResolution(e)}catch{return[e.fileDirectory.ImageWidth/i.fileDirectory.ImageWidth,e.fileDirectory.ImageHeight/i.fileDirectory.ImageHeight]}}function Fd(i){var e=i.geoKeys;if(!e)return null;if(e.ProjectedCSTypeGeoKey){var t="EPSG:"+e.ProjectedCSTypeGeoKey,r=xt(t);if(!r){var n=Ki(e.ProjLinearUnitsGeoKey);n&&(r=new Ir({code:t,units:n}))}return r}if(e.GeographicTypeGeoKey){var t="EPSG:"+e.GeographicTypeGeoKey,r=xt(t);if(!r){var n=Ki(e.GeogAngularUnitsGeoKey);n&&(r=new Ir({code:t,units:n}))}return r}return null}function Gd(i){return i.getImageCount().then(function(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=i.getImage(r);return Promise.all(t)})}function Ud(i,e){var t;return i.blob?t=Sd(i.blob):i.overviews?t=Id(i.url,i.overviews,e):t=Pd(i.url,e),t.then(Gd)}function Ze(i,e,t,r,n){if(Array.isArray(i)){var o=i.length;if(!Array.isArray(e)||o!=e.length){var a=new Error(r);throw n(a),a}for(var s=0;s<o;++s)Ze(i[s],e[s],t,r,n);return}if(e=e,Math.abs(i-e)>t*i)throw new Error(r)}function jd(i){return i instanceof Int8Array?-128:i instanceof Int16Array?-32768:i instanceof Int32Array?-2147483648:i instanceof Float32Array?12e-39:0}function Bd(i){return i instanceof Int8Array?127:i instanceof Uint8Array||i instanceof Uint8ClampedArray?255:i instanceof Int16Array?32767:i instanceof Uint16Array?65535:i instanceof Int32Array?2147483647:i instanceof Uint32Array?4294967295:i instanceof Float32Array?34e37:255}var ls=function(i){Ld(e,i);function e(t){var r=i.call(this,{state:"loading",tileGrid:null,projection:null,opaque:t.opaque,transition:t.transition,interpolate:t.interpolate!==!1,wrapX:t.wrapX})||this;r.sourceInfo_=t.sources;var n=r.sourceInfo_.length;r.sourceOptions_=t.sourceOptions,r.sourceImagery_=new Array(n),r.resolutionFactors_=new Array(n),r.samplesPerPixel_,r.nodataValues_,r.metadata_,r.normalize_=t.normalize!==!1,r.addAlpha_=!1,r.error_=null,r.readMethod_=t.convertToRGB?"readRGB":"readRasters",r.setKey(r.sourceInfo_.map(function(l){return l.url}).join(","));for(var o=r,a=new Array(n),s=0;s<n;++s)a[s]=Ud(r.sourceInfo_[s],r.sourceOptions_);return Promise.all(a).then(function(l){o.configure_(l)}).catch(function(l){console.error(l),o.error_=l,o.setState("error")}),r}return e.prototype.getError=function(){return this.error_},e.prototype.configure_=function(t){for(var r,n,o,a,s,l=new Array(t.length),u=new Array(t.length),c=new Array(t.length),h=0,f=t.length,p=function(S){var X=t[S],V=X.length,Z=void 0,j=void 0,F=new Array(V),G=new Array(V),L=new Array(V);u[S]=new Array(V),c[S]=new Array(V);for(var k=0;k<V;++k){var B=X[k],Q=B.getGDALNoData();c[S][k]=B.getGDALMetadata(0),u[S][k]=Q;var pt=d.sourceInfo_[S].bands;l[S]=pt?pt.length:B.getSamplesPerPixel();var st=V-(k+1);Z||(Z=Md(B)),j||(j=bd(B));var it=Nd(B,X[0]);L[st]=it[0];var U=[B.getTileWidth(),B.getTileHeight()];F[st]=U;var ot=it[0]/Math.abs(it[1]);G[st]=[U[0],U[1]/ot]}if(r?Vt(r,Z,r):r=Z,!n)n=j;else{var dt="Origin mismatch for source ".concat(S,", got [").concat(j,"] but expected [").concat(n,"]");Ze(n,j,0,dt,d.viewRejector)}if(!s)s=L,d.resolutionFactors_[S]=1;else{s.length-h>L.length&&(h=s.length-L.length);var q=s[s.length-1]/L[L.length-1];d.resolutionFactors_[S]=q;var mt=L.map(function(Yt){return Yt*=q}),dt="Resolution mismatch for source ".concat(S,", got [").concat(mt,"] but expected [").concat(s,"]");Ze(s.slice(h,s.length),mt,.02,dt,d.viewRejector)}o?Ze(o.slice(h,o.length),G,.01,"Tile size mismatch for source ".concat(S),d.viewRejector):o=G,a?Ze(a.slice(h,a.length),F,0,"Tile size mismatch for source ".concat(S),d.viewRejector):a=F,d.sourceImagery_[S]=X.reverse()},d=this,v=0;v<f;++v)p(v);for(var g=0,E=this.sourceImagery_.length;g<E;++g)for(var _=this.sourceImagery_[g];_.length<s.length;)_.unshift(void 0);if(!this.getProjection())for(var m=t[0],g=m.length-1;g>=0;--g){var y=m[g],T=Fd(y);if(T){this.projection=T;break}}this.samplesPerPixel_=l,this.nodataValues_=u,this.metadata_=c;t:for(var v=0;v<f;++v){if(this.sourceInfo_[v].nodata!==void 0){this.addAlpha_=!0;break}var R=u[v],x=this.sourceInfo_[v].bands;if(x){for(var g=0;g<x.length;++g)if(R[x[g]-1]!==null){this.addAlpha_=!0;break t}continue}for(var C=0;C<R.length;++C)if(R[C]!==null){this.addAlpha_=!0;break t}}var P=this.addAlpha_?1:0;this.bandCount=l.reduce(function(S,X){return S+=X,S},0)+P;var I=new pi({extent:r,minZoom:h,origin:n,resolutions:s,tileSizes:o});this.tileGrid=I,this.setTileSizes(a),this.setLoader(this.loadTile_.bind(this)),this.setState("ready"),this.viewResolver({projection:this.projection,resolutions:s,center:br(Ne(r),this.projection),extent:qo(r,this.projection),zoom:0})},e.prototype.loadTile_=function(t,r,n){for(var o=this.getTileSize(t),a=this.sourceImagery_.length,s=new Array(a),l=this.addAlpha_,u=this.bandCount,c=this.samplesPerPixel_,h=this.nodataValues_,f=this.sourceInfo_,p=function(y){var T=f[y],R=d.resolutionFactors_[y],x=[Math.round(r*(o[0]*R)),Math.round(n*(o[1]*R)),Math.round((r+1)*(o[0]*R)),Math.round((n+1)*(o[1]*R))],C=d.sourceImagery_[y][t],P=void 0;T.bands&&(P=T.bands.map(function(S){return S-1}));var I=void 0;"nodata"in T&&T.nodata!==null?I=T.nodata:P?I=P.map(function(S){return h[y][S]}):I=h[y],s[y]=C[d.readMethod_]({window:x,width:o[0],height:o[1],samples:P,fillValue:I,pool:Dd(),interleave:!1})},d=this,v=0;v<a;++v)p(v);var g=o[0]*o[1],E=g*u,_=this.normalize_,m=this.metadata_;return Promise.all(s).then(function(y){var T;_?T=new Uint8Array(E):T=new Float32Array(E);for(var R=0,x=0;x<g;++x){for(var C=l,P=0;P<a;++P){var I=f[P],S=I.min,X=I.max,V=void 0,Z=void 0;if(_){var j=m[P][0];S===void 0&&(j&&Ao in j?S=parseFloat(j[Ao]):S=jd(y[P][0])),X===void 0&&(j&&Oo in j?X=parseFloat(j[Oo]):X=Bd(y[P][0])),V=255/(X-S),Z=-S*V}for(var F=0;F<c[P];++F){var G=y[P][F][x],L=void 0;if(_?L=at(V*G+Z,0,255):L=G,!l)T[R]=L;else{var k=I.nodata;if(k===void 0){var B=void 0;I.bands?B=I.bands[F]-1:B=F,k=h[P][B]}var Q=isNaN(k);(!Q&&G!==k||Q&&!isNaN(G))&&(C=!1,T[R]=L)}R++}}l&&(C||(T[R]=255),R++)}return T}).catch(function(y){throw console.error(y),y})},e}(Kf);ls.prototype.getView;const Xd=ls;var Li=34962,Di=34963,Kd=35040,Mi=35044,zd=35048,Vd=5121,kd=5123,Yd=5125,us=5126,Po=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function cs(i,e){for(var t=tt({preserveDrawingBuffer:!0,antialias:!Hs},e),r=Po.length,n=0;n<r;++n)try{var o=i.getContext(Po[n],t);if(o)return o}catch{}return null}var Zd={STATIC_DRAW:Mi,STREAM_DRAW:Kd,DYNAMIC_DRAW:zd},$d=function(){function i(e,t){this.array=null,this.type=e,$(e===Li||e===Di,62),this.usage=t!==void 0?t:Zd.STATIC_DRAW}return i.prototype.ofSize=function(e){this.array=new(Cn(this.type))(e)},i.prototype.fromArray=function(e){var t=Cn(this.type);this.array=t.from?t.from(e):new t(e)},i.prototype.fromArrayBuffer=function(e){this.array=new(Cn(this.type))(e)},i.prototype.getType=function(){return this.type},i.prototype.getArray=function(){return this.array},i.prototype.getUsage=function(){return this.usage},i.prototype.getSize=function(){return this.array?this.array.length:0},i}();function Cn(i){switch(i){case Li:return Float32Array;case Di:return Uint32Array;default:return Float32Array}}const hs=$d;var Hd=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function fs(i,e,t){var r=t?i.LINEAR:i.NEAREST;i.bindTexture(i.TEXTURE_2D,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,r)}function Wd(i,e,t,r){fs(i,e,r),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t)}function So(i,e,t,r,n,o){var a=i.getGL(),s,l;if(t instanceof Float32Array){s=a.FLOAT,i.getExtension("OES_texture_float");var u=i.getExtension("OES_texture_float_linear");l=u!==null}else s=a.UNSIGNED_BYTE,l=!0;fs(a,e,o&&l);var c=t.byteLength/r[1],h=1;c%8===0?h=8:c%4===0?h=4:c%2===0&&(h=2);var f;switch(n){case 1:{f=a.LUMINANCE;break}case 2:{f=a.LUMINANCE_ALPHA;break}case 3:{f=a.RGB;break}case 4:{f=a.RGBA;break}default:throw new Error("Unsupported number of bands: ".concat(n))}var p=a.getParameter(a.UNPACK_ALIGNMENT);a.pixelStorei(a.UNPACK_ALIGNMENT,h),a.texImage2D(a.TEXTURE_2D,0,f,r[0],r[1],0,f,s,t),a.pixelStorei(a.UNPACK_ALIGNMENT,p)}var Oe=null;function qd(){var i=document.createElement("canvas");i.width=1,i.height=1,Oe=i.getContext("2d")}var Qd=function(i){Hd(e,i);function e(t){var r=i.call(this)||this;r.tile,r.textures=[],r.handleTileChange_=r.handleTileChange_.bind(r),r.renderSize_=gt(t.grid.getTileSize(t.tile.tileCoord[0])),r.gutter_=t.gutter||0,r.bandCount=NaN,r.helper_=t.helper;var n=new hs(Li,Mi);return n.fromArray([0,1,1,1,1,0,0,0]),r.helper_.flushBufferData(n),r.coords=n,r.setTile(t.tile),r}return e.prototype.setTile=function(t){if(t!==this.tile)if(this.tile&&this.tile.removeEventListener(M.CHANGE,this.handleTileChange_),this.tile=t,this.textures.length=0,this.loaded=t.getState()===O.LOADED,this.loaded)this.uploadTile_();else{if(t instanceof Gr){var r=t.getImage();r instanceof Image&&!r.crossOrigin&&(r.crossOrigin="anonymous")}t.addEventListener(M.CHANGE,this.handleTileChange_)}},e.prototype.uploadTile_=function(){var t=this.helper_,r=t.getGL(),n=this.tile;if(n instanceof Gr||n instanceof fi){var o=r.createTexture();this.textures.push(o),this.bandCount=4,Wd(r,o,n.getImage(),n.interpolate);return}var a=n.getSize(),s=[a[0]+2*this.gutter_,a[1]+2*this.gutter_],l=n.getData(),u=l instanceof Float32Array,c=s[0]*s[1],h=u?Float32Array:Uint8Array,f=h.BYTES_PER_ELEMENT,p=l.byteLength/s[1];this.bandCount=Math.floor(p/f/s[0]);var d=Math.ceil(this.bandCount/4);if(d===1){var o=r.createTexture();this.textures.push(o),So(t,o,l,s,this.bandCount,n.interpolate);return}for(var v=new Array(d),g=0;g<d;++g){var o=r.createTexture();this.textures.push(o);var E=g<d-1?4:this.bandCount%4;v[g]=new h(c*E)}for(var _=0,m=0,y=s[0]*this.bandCount,T=0;T<s[1];++T){for(var R=0;R<y;++R){var x=l[m+R],C=Math.floor(_/this.bandCount),P=R%this.bandCount,g=Math.floor(P/4),I=v[g],E=I.length/c,S=P%4;I[C*E+S]=x,++_}m+=p/f}for(var g=0;g<d;++g){var o=this.textures[g],I=v[g],E=I.length/c;So(t,o,I,s,E,n.interpolate)}},e.prototype.handleTileChange_=function(){this.tile.getState()===O.LOADED&&(this.loaded=!0,this.uploadTile_(),this.dispatchEvent(M.CHANGE))},e.prototype.disposeInternal=function(){var t=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(var r=0;r<this.textures.length;++r)t.deleteTexture(this.textures[r]);this.tile.removeEventListener(M.CHANGE,this.handleTileChange_)},e.prototype.getPixelData=function(t,r){if(!this.loaded)return null;var n=this.renderSize_[0],o=this.renderSize_[1],a=this.gutter_;if(this.tile instanceof Fa){var s=this.tile.getSize(),l=s[0],u=s[1],c=l+2*a,h=u+2*a,f=a+Math.floor(l*(t/n)),p=a+Math.floor(u*(r/o)),d=this.tile.getData();if(d instanceof DataView){var v=d.byteLength/(c*h),g=v*(p*c+f),E=d.buffer.slice(g,g+v);return new DataView(E)}var _=this.bandCount*(p*c+f);return d.slice(_,_+this.bandCount)}Oe||qd(),Oe.clearRect(0,0,1,1);var m=this.tile.getImage(),y=m.width,T=m.height,R=y-2*a,x=T-2*a,C=a+Math.floor(R*(t/n)),P=a+Math.floor(x*(r/o)),I;try{Oe.drawImage(m,C,P,1,1,0,0,1,1),I=Oe.getImageData(0,0,1,1).data}catch{return Oe=null,null}return I},e}(Ge);const Jd=Qd,xr={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};var tv=`
  precision mediump float;
  
  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;
  
  uniform vec2 u_screenSize;
   
  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,ev=`
  precision mediump float;
   
  uniform sampler2D u_image;
  uniform float u_opacity;
   
  varying vec2 v_texCoord;
   
  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`,rv=function(){function i(e){this.gl_=e.webGlContext;var t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer();var r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e.vertexShader||tv),t.compileShader(r);var n=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(n,e.fragmentShader||ev),t.compileShader(n),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,r),t.attachShader(this.renderTargetProgram_,n),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();var o=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(o),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach((function(a){this.uniforms_.push({value:e.uniforms[a],location:t.getUniformLocation(this.renderTargetProgram_,a)})}).bind(this))}return i.prototype.getGL=function(){return this.gl_},i.prototype.init=function(e){var t=this.getGL(),r=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;var n=0,o=t.RGBA,a=0,s=t.RGBA,l=t.UNSIGNED_BYTE,u=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,n,o,r[0],r[1],a,s,l,u),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0)}},i.prototype.apply=function(e,t,r,n){var o=this.getGL(),a=e.size;if(o.bindFramebuffer(o.FRAMEBUFFER,t?t.getFrameBuffer():null),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,this.renderTargetTexture_),!t){var s=nt(o.canvas);if(!e.renderTargets[s]){var l=o.getContextAttributes();l&&l.preserveDrawingBuffer&&(o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT)),e.renderTargets[s]=!0}}o.enable(o.BLEND),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),o.viewport(0,0,o.drawingBufferWidth,o.drawingBufferHeight),o.bindBuffer(o.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),o.useProgram(this.renderTargetProgram_),o.enableVertexAttribArray(this.renderTargetAttribLocation_),o.vertexAttribPointer(this.renderTargetAttribLocation_,2,o.FLOAT,!1,0,0),o.uniform2f(this.renderTargetUniformLocation_,a[0],a[1]),o.uniform1i(this.renderTargetTextureLocation_,0);var u=e.layerStatesArray[e.layerIndex].opacity;o.uniform1f(this.renderTargetOpacityLocation_,u),this.applyUniforms(e),r&&r(o,e),o.drawArrays(o.TRIANGLES,0,6),n&&n(o,e)},i.prototype.getFrameBuffer=function(){return this.frameBuffer_},i.prototype.applyUniforms=function(e){var t=this.getGL(),r,n=1;this.uniforms_.forEach(function(o){if(r=typeof o.value=="function"?o.value(e):o.value,r instanceof HTMLCanvasElement||r instanceof ImageData)o.texture||(o.texture=t.createTexture()),t.activeTexture(t["TEXTURE".concat(n)]),t.bindTexture(t.TEXTURE_2D,o.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,r.width,r.height,0,t.UNSIGNED_BYTE,new Uint8Array(r.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.uniform1i(o.location,n++);else if(Array.isArray(r))switch(r.length){case 2:t.uniform2f(o.location,r[0],r[1]);return;case 3:t.uniform3f(o.location,r[0],r[1],r[2]);return;case 4:t.uniform4f(o.location,r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&t.uniform1f(o.location,r)})},i}();const Io=rv;function ps(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Ar(i,e){return i[0]=e[0],i[1]=e[1],i[4]=e[2],i[5]=e[3],i[12]=e[4],i[13]=e[5],i}var nv=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),Ye={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution"},$e={UNSIGNED_BYTE:Vd,UNSIGNED_SHORT:kd,UNSIGNED_INT:Yd,FLOAT:us},Kr={};function Lo(i){return"shared/"+i}var Do=0;function iv(){var i="unique/"+Do;return Do+=1,i}function ov(i){var e=Kr[i];if(!e){var t=document.createElement("canvas");t.style.position="absolute",t.style.left="0",e={users:0,canvas:t},Kr[i]=e}return e.users+=1,e.canvas}function av(i){var e=Kr[i];if(e&&(e.users-=1,!(e.users>0))){var t=e.canvas,r=cs(t),n=r.getExtension("WEBGL_lose_context");n&&n.loseContext(),delete Kr[i]}}var sv=function(i){nv(e,i);function e(t){var r=i.call(this)||this,n=t||{};r.boundHandleWebGLContextLost_=r.handleWebGLContextLost.bind(r),r.boundHandleWebGLContextRestored_=r.handleWebGLContextRestored.bind(r),r.canvasCacheKey_=n.canvasCacheKey?Lo(n.canvasCacheKey):iv(),r.canvas_=ov(r.canvasCacheKey_),r.gl_=cs(r.canvas_),r.bufferCache_={},r.extensionCache_={},r.currentProgram_=null,r.canvas_.addEventListener(xr.LOST,r.boundHandleWebGLContextLost_),r.canvas_.addEventListener(xr.RESTORED,r.boundHandleWebGLContextRestored_),r.offsetRotateMatrix_=Ut(),r.offsetScaleMatrix_=Ut(),r.tmpMat4_=ps(),r.uniformLocations_={},r.attribLocations_={},r.uniforms_=[],n.uniforms&&r.setUniforms(n.uniforms);var o=r.getGL();return r.postProcessPasses_=n.postProcesses?n.postProcesses.map(function(a){return new Io({webGlContext:o,scaleRatio:a.scaleRatio,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,uniforms:a.uniforms})}):[new Io({webGlContext:o})],r.shaderCompileErrors_=null,r.startTime_=Date.now(),r}return e.prototype.setUniforms=function(t){this.uniforms_=[];for(var r in t)this.uniforms_.push({name:r,value:t[r]});this.uniformLocations_={}},e.prototype.canvasCacheKeyMatches=function(t){return this.canvasCacheKey_===Lo(t)},e.prototype.getExtension=function(t){if(t in this.extensionCache_)return this.extensionCache_[t];var r=this.gl_.getExtension(t);return this.extensionCache_[t]=r,r},e.prototype.bindBuffer=function(t){var r=this.getGL(),n=nt(t),o=this.bufferCache_[n];if(!o){var a=r.createBuffer();o={buffer:t,webGlBuffer:a},this.bufferCache_[n]=o}r.bindBuffer(t.getType(),o.webGlBuffer)},e.prototype.flushBufferData=function(t){var r=this.getGL();this.bindBuffer(t),r.bufferData(t.getType(),t.getArray(),t.getUsage())},e.prototype.deleteBuffer=function(t){var r=this.getGL(),n=nt(t),o=this.bufferCache_[n];o&&!r.isContextLost()&&r.deleteBuffer(o.webGlBuffer),delete this.bufferCache_[n]},e.prototype.disposeInternal=function(){this.canvas_.removeEventListener(xr.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(xr.RESTORED,this.boundHandleWebGLContextRestored_),av(this.canvasCacheKey_),delete this.gl_,delete this.canvas_},e.prototype.prepareDraw=function(t,r){var n=this.getGL(),o=this.getCanvas(),a=t.size,s=t.pixelRatio;o.width=a[0]*s,o.height=a[1]*s,o.style.width=a[0]+"px",o.style.height=a[1]+"px",n.useProgram(this.currentProgram_);for(var l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(t);n.bindTexture(n.TEXTURE_2D,null),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.ONE,r?n.ZERO:n.ONE_MINUS_SRC_ALPHA),n.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.prepareDrawToRenderTarget=function(t,r,n){var o=this.getGL(),a=r.getSize();o.bindFramebuffer(o.FRAMEBUFFER,r.getFramebuffer()),o.viewport(0,0,a[0],a[1]),o.bindTexture(o.TEXTURE_2D,r.getTexture()),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.enable(o.BLEND),o.blendFunc(o.ONE,n?o.ZERO:o.ONE_MINUS_SRC_ALPHA),o.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.drawElements=function(t,r){var n=this.getGL();this.getExtension("OES_element_index_uint");var o=n.UNSIGNED_INT,a=4,s=r-t,l=t*a;n.drawElements(n.TRIANGLES,s,o,l)},e.prototype.finalizeDraw=function(t,r,n){for(var o=0,a=this.postProcessPasses_.length;o<a;o++)o===a-1?this.postProcessPasses_[o].apply(t,null,r,n):this.postProcessPasses_[o].apply(t,this.postProcessPasses_[o+1])},e.prototype.getCanvas=function(){return this.canvas_},e.prototype.getGL=function(){return this.gl_},e.prototype.applyFrameState=function(t){var r=t.size,n=t.viewState.rotation,o=wr(this.offsetScaleMatrix_);Sn(o,2/r[0],2/r[1]);var a=wr(this.offsetRotateMatrix_);n!==0&&Ko(a,-n),this.setUniformMatrixValue(Ye.OFFSET_SCALE_MATRIX,Ar(this.tmpMat4_,o)),this.setUniformMatrixValue(Ye.OFFSET_ROTATION_MATRIX,Ar(this.tmpMat4_,a)),this.setUniformFloatValue(Ye.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Ye.ZOOM,t.viewState.zoom),this.setUniformFloatValue(Ye.RESOLUTION,t.viewState.resolution)},e.prototype.applyUniforms=function(t){var r=this.getGL(),n,o=0;this.uniforms_.forEach((function(a){if(n=typeof a.value=="function"?a.value(t):a.value,n instanceof HTMLCanvasElement||n instanceof HTMLImageElement||n instanceof ImageData){a.texture||(a.prevValue=void 0,a.texture=r.createTexture()),r.activeTexture(r["TEXTURE".concat(o)]),r.bindTexture(r.TEXTURE_2D,a.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);var s=!(n instanceof HTMLImageElement)||n.complete;s&&a.prevValue!==n&&(a.prevValue=n,r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n)),r.uniform1i(this.getUniformLocation(a.name),o++)}else if(Array.isArray(n)&&n.length===6)this.setUniformMatrixValue(a.name,Ar(this.tmpMat4_,n));else if(Array.isArray(n)&&n.length<=4)switch(n.length){case 2:r.uniform2f(this.getUniformLocation(a.name),n[0],n[1]);return;case 3:r.uniform3f(this.getUniformLocation(a.name),n[0],n[1],n[2]);return;case 4:r.uniform4f(this.getUniformLocation(a.name),n[0],n[1],n[2],n[3]);return;default:return}else typeof n=="number"&&r.uniform1f(this.getUniformLocation(a.name),n)}).bind(this))},e.prototype.useProgram=function(t){if(t==this.currentProgram_)return!1;var r=this.getGL();return r.useProgram(t),this.currentProgram_=t,this.uniformLocations_={},this.attribLocations_={},!0},e.prototype.compileShader=function(t,r){var n=this.getGL(),o=n.createShader(r);return n.shaderSource(o,t),n.compileShader(o),o},e.prototype.getProgram=function(t,r){var n=this.getGL(),o=this.compileShader(t,n.FRAGMENT_SHADER),a=this.compileShader(r,n.VERTEX_SHADER),s=n.createProgram();if(n.attachShader(s,o),n.attachShader(s,a),n.linkProgram(s),!n.getShaderParameter(o,n.COMPILE_STATUS)){var l="Fragment shader compliation failed: ".concat(n.getShaderInfoLog(o));throw new Error(l)}if(n.deleteShader(o),!n.getShaderParameter(a,n.COMPILE_STATUS)){var l="Vertex shader compilation failed: ".concat(n.getShaderInfoLog(a));throw new Error(l)}if(n.deleteShader(a),!n.getProgramParameter(s,n.LINK_STATUS)){var l="GL program linking failed: ".concat(n.getShaderInfoLog(a));throw new Error(l)}return s},e.prototype.getUniformLocation=function(t){return this.uniformLocations_[t]===void 0&&(this.uniformLocations_[t]=this.getGL().getUniformLocation(this.currentProgram_,t)),this.uniformLocations_[t]},e.prototype.getAttributeLocation=function(t){return this.attribLocations_[t]===void 0&&(this.attribLocations_[t]=this.getGL().getAttribLocation(this.currentProgram_,t)),this.attribLocations_[t]},e.prototype.makeProjectionTransform=function(t,r){var n=t.size,o=t.viewState.rotation,a=t.viewState.resolution,s=t.viewState.center;return wr(r),he(r,0,0,2/(a*n[0]),2/(a*n[1]),-o,-s[0],-s[1]),r},e.prototype.setUniformFloatValue=function(t,r){this.getGL().uniform1f(this.getUniformLocation(t),r)},e.prototype.setUniformFloatVec4=function(t,r){this.getGL().uniform4fv(this.getUniformLocation(t),r)},e.prototype.setUniformMatrixValue=function(t,r){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,r)},e.prototype.enableAttributeArray_=function(t,r,n,o,a){var s=this.getAttributeLocation(t);s<0||(this.getGL().enableVertexAttribArray(s),this.getGL().vertexAttribPointer(s,r,n,!1,o,a))},e.prototype.enableAttributes=function(t){for(var r=lv(t),n=0,o=0;o<t.length;o++){var a=t[o];this.enableAttributeArray_(a.name,a.size,a.type||us,r,n),n+=a.size*ds(a.type)}},e.prototype.handleWebGLContextLost=function(){nr(this.bufferCache_),this.currentProgram_=null},e.prototype.handleWebGLContextRestored=function(){},e.prototype.createTexture=function(t,r,n){var o=this.getGL(),a=n||o.createTexture(),s=0,l=o.RGBA,u=0,c=o.RGBA,h=o.UNSIGNED_BYTE;return o.bindTexture(o.TEXTURE_2D,a),r?o.texImage2D(o.TEXTURE_2D,s,l,c,h,r):o.texImage2D(o.TEXTURE_2D,s,l,t[0],t[1],u,c,h,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),a},e}(zr);function lv(i){for(var e=0,t=0;t<i.length;t++){var r=i[t];e+=r.size*ds(r.type)}return e}function ds(i){switch(i){case $e.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case $e.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case $e.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case $e.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}const uv=sv;var cv=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),hv=function(i){cv(e,i);function e(t,r){var n=i.call(this,t)||this,o=r||{};return n.inversePixelTransform_=Ut(),n.pixelContext_=null,n.postProcesses_=o.postProcesses,n.uniforms_=o.uniforms,n.helper,t.addChangeListener(z.MAP,n.removeHelper.bind(n)),n.dispatchPreComposeEvent=n.dispatchPreComposeEvent.bind(n),n.dispatchPostComposeEvent=n.dispatchPostComposeEvent.bind(n),n}return e.prototype.dispatchPreComposeEvent=function(t,r){var n=this.getLayer();if(n.hasListener(yt.PRECOMPOSE)){var o=new We(yt.PRECOMPOSE,void 0,r,t);n.dispatchEvent(o)}},e.prototype.dispatchPostComposeEvent=function(t,r){var n=this.getLayer();if(n.hasListener(yt.POSTCOMPOSE)){var o=new We(yt.POSTCOMPOSE,void 0,r,t);n.dispatchEvent(o)}},e.prototype.reset=function(t){this.uniforms_=t.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)},e.prototype.removeHelper=function(){this.helper&&(this.helper.dispose(),delete this.helper)},e.prototype.prepareFrame=function(t){if(this.getLayer().getRenderSource()){for(var r=!0,n=-1,o=void 0,a=0,s=t.layerStatesArray.length;a<s;a++){var l=t.layerStatesArray[a].layer,u=l.getRenderer();if(!(u instanceof e)){r=!0;continue}var c=l.getClassName();if((r||c!==o)&&(n+=1,r=!1),o=c,u===this)break}var h="map/"+t.mapId+"/group/"+n;(!this.helper||!this.helper.canvasCacheKeyMatches(h))&&(this.removeHelper(),this.helper=new uv({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:h}),o&&(this.helper.getCanvas().className=o),this.afterHelperCreated())}return this.prepareFrameInternal(t)},e.prototype.afterHelperCreated=function(){},e.prototype.prepareFrameInternal=function(t){return!0},e.prototype.disposeInternal=function(){this.removeHelper(),i.prototype.disposeInternal.call(this)},e.prototype.dispatchRenderEvent_=function(t,r,n){var o=this.getLayer();if(o.hasListener(t)){he(this.inversePixelTransform_,0,0,n.pixelRatio,-n.pixelRatio,0,0,-n.size[1]);var a=new We(t,this.inversePixelTransform_,n,r);o.dispatchEvent(a)}},e.prototype.preRender=function(t,r){this.dispatchRenderEvent_(yt.PRERENDER,t,r)},e.prototype.postRender=function(t,r){this.dispatchRenderEvent_(yt.POSTRENDER,t,r)},e.prototype.getDataAtPixel=function(t,r,n){var o=ct([r.pixelRatio,0,0,r.pixelRatio,0,0],t.slice()),a=this.helper.getGL();if(!a)return null;var s=this.getLayer(),l=s.getExtent();if(l){var u=ct(r.pixelToCoordinateTransform,t.slice());if(!fe(l,u))return null}var c=a.getContextAttributes();if(!c||!c.preserveDrawingBuffer)return new Uint8Array;var h=Math.round(o[0]),f=Math.round(o[1]),p=this.pixelContext_;if(!p){var d=document.createElement("canvas");d.width=1,d.height=1,p=d.getContext("2d"),this.pixelContext_=p}p.clearRect(0,0,1,1);var v;try{p.drawImage(a.canvas,h,f,1,1,0,0,1,1),v=p.getImageData(0,0,1,1).data}catch{return v}return v[3]===0?null:v},e}(pa);const fv=hv;var pv=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}(),D={TILE_TEXTURE_ARRAY:"u_tileTextures",TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY",RENDER_EXTENT:"u_renderExtent",RESOLUTION:"u_resolution",ZOOM:"u_zoom"},Pr={TEXTURE_COORD:"a_textureCoord"},dv=[{name:Pr.TEXTURE_COORD,size:2,type:$e.FLOAT}],vv={};function gv(i){return 2*(1-1/(i+1))-1}function Mo(i,e,t){t in i||(i[t]=[]),i[t].push(e)}function On(i,e){var t=i.layerStatesArray[i.layerIndex];t.extent&&(e=Vt(e,Qt(t.extent,i.viewState.projection)));var r=t.layer.getRenderSource();if(!r.getWrapX()){var n=r.getTileGridForProjection(i.viewState.projection).getExtent();n&&(e=Vt(e,n))}return e}function An(i,e){return"".concat(i.getKey(),",").concat(er(e))}var _v=function(i){pv(e,i);function e(t,r){var n=i.call(this,t,{uniforms:r.uniforms})||this;n.renderComplete=!1,n.tileTransform_=Ut(),n.tempMat4_=ps(),n.tempTileRange_=new hi(0,0,0,0),n.tempTileCoord_=jr(0,0,0),n.tempSize_=[0,0],n.program_,n.vertexShader_=r.vertexShader,n.fragmentShader_=r.fragmentShader,n.indices_=new hs(Di,Mi),n.indices_.fromArray([0,1,3,1,2,3]);var o=r.cacheSize!==void 0?r.cacheSize:512;return n.tileTextureCache_=new Ca(o),n.paletteTextures_=r.paletteTextures||[],n.frameState_=null,n}return e.prototype.reset=function(t){i.prototype.reset.call(this,{uniforms:t.uniforms}),this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.paletteTextures_=t.paletteTextures||[],this.helper&&(this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_))},e.prototype.afterHelperCreated=function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)},e.prototype.isDrawableTile_=function(t){var r=this.getLayer(),n=t.getState(),o=r.getUseInterimTilesOnError();return n==O.LOADED||n==O.EMPTY||n==O.ERROR&&!o},e.prototype.prepareFrameInternal=function(t){var r=this.getLayer(),n=r.getRenderSource();return!n||Jr(On(t,t.extent))?!1:n.getState()==="ready"},e.prototype.enqueueTiles=function(t,r,n,o){var a=t.viewState,s=this.getLayer(),l=s.getRenderSource(),u=l.getTileGridForProjection(a.projection),c=l.getGutterForProjection(a.projection),h=nt(l);h in t.wantedTiles||(t.wantedTiles[h]={});for(var f=t.wantedTiles[h],p=this.tileTextureCache_,d=Math.max(n-s.getPreload(),u.getMinZoom(),s.getMinZoom()),v=n;v>=d;--v)for(var g=u.getTileRangeForExtentAndZ(r,v,this.tempTileRange_),E=u.getResolution(v),_=g.minX;_<=g.maxX;++_)for(var m=g.minY;m<=g.maxY;++m){var y=jr(v,_,m,this.tempTileCoord_),T=An(l,y),R=void 0,x=void 0;if(p.containsKey(T)&&(R=p.get(T),x=R.tile),!R||R.tile.key!==l.getKey())if(x=l.getTile(v,_,m,t.pixelRatio,a.projection),!R)R=new Jd({tile:x,grid:u,helper:this.helper,gutter:c}),p.set(T,R);else if(this.isDrawableTile_(x))R.setTile(x);else{var C=x.getInterimTile();R.setTile(C)}Mo(o,R,v);var P=x.getKey();f[P]=!0,x.getState()===O.IDLE&&(t.tileQueue.isKeyQueued(P)||t.tileQueue.enqueue([x,h,u.getTileCoordCenter(y),E]))}},e.prototype.renderFrame=function(t){this.frameState_=t,this.renderComplete=!0;var r=this.helper.getGL();this.preRender(r,t);var n=t.viewState,o=this.getLayer(),a=o.getRenderSource(),s=a.getTileGridForProjection(n.projection),l=a.getGutterForProjection(n.projection),u=On(t,t.extent),c=s.getZForResolution(n.resolution,a.zDirection),h={};if(t.nextExtent){var f=s.getZForResolution(n.nextResolution,a.zDirection),p=On(t,t.nextExtent);this.enqueueTiles(t,p,f,h)}this.enqueueTiles(t,u,c,h);for(var d={},v=nt(this),g=t.time,E=!1,_=h[c],m=0,y=_.length;m<y;++m){var T=_[m],R=T.tile,x=R.tileCoord;if(T.loaded){var C=R.getAlpha(v,g);if(C===1){R.endTransition(v);continue}E=!0;var P=er(x);d[P]=C}this.renderComplete=!1;var I=this.findAltTiles_(s,x,c+1,h);if(!I)for(var S=s.getMinZoom(),X=c-1;X>=S;--X){var V=this.findAltTiles_(s,x,X,h);if(V)break}}this.helper.useProgram(this.program_),this.helper.prepareDraw(t,!E);for(var Z=Object.keys(h).map(Number).sort(Vr),j=n.center[0],F=n.center[1],G=0,L=Z.length;G<L;++G)for(var k=Z[G],B=s.getResolution(k),Q=gt(s.getTileSize(k),this.tempSize_),pt=s.getOrigin(k),st=Q[0]+2*l,it=Q[1]+2*l,U=st/it,ot=(j-pt[0])/(Q[0]*B),dt=(pt[1]-F)/(Q[1]*B),q=n.resolution/B,mt=gv(k),Et=h[k],m=0,y=Et.length;m<y;++m){var T=Et[m];if(T.loaded){var R=T.tile,x=R.tileCoord,P=er(x),Yt=x[1],It=x[2];wr(this.tileTransform_),Sn(this.tileTransform_,2/(t.size[0]*q/st),-2/(t.size[1]*q/st)),Ko(this.tileTransform_,n.rotation),Sn(this.tileTransform_,1,1/U),Js(this.tileTransform_,(Q[0]*(Yt-ot)-l)/st,(Q[1]*(It-dt)-l)/it),this.helper.setUniformMatrixValue(D.TILE_TRANSFORM,Ar(this.tempMat4_,this.tileTransform_)),this.helper.bindBuffer(T.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(dv);for(var wt=0;wt<T.textures.length;){var sn="TEXTURE"+wt,ur="".concat(D.TILE_TEXTURE_ARRAY,"[").concat(wt,"]");r.activeTexture(r[sn]),r.bindTexture(r.TEXTURE_2D,T.textures[wt]),r.uniform1i(this.helper.getUniformLocation(ur),wt),++wt}for(var ge=0;ge<this.paletteTextures_.length;++ge){var Xe=this.paletteTextures_[ge];r.activeTexture(r["TEXTURE"+wt]);var Ke=Xe.getTexture(r);r.bindTexture(r.TEXTURE_2D,Ke),r.uniform1i(this.helper.getUniformLocation(Xe.name),wt),++wt}var C=P in d?d[P]:1;C<1&&(t.animate=!0),this.helper.setUniformFloatValue(D.TRANSITION_ALPHA,C),this.helper.setUniformFloatValue(D.DEPTH,mt),this.helper.setUniformFloatValue(D.TEXTURE_PIXEL_WIDTH,st),this.helper.setUniformFloatValue(D.TEXTURE_PIXEL_HEIGHT,it),this.helper.setUniformFloatValue(D.TEXTURE_RESOLUTION,B),this.helper.setUniformFloatValue(D.TEXTURE_ORIGIN_X,pt[0]+Yt*Q[0]*B-l*B),this.helper.setUniformFloatValue(D.TEXTURE_ORIGIN_Y,pt[1]-It*Q[1]*B+l*B);var oe=u;l>0&&(oe=s.getTileCoordExtent(x),Vt(oe,u,oe)),this.helper.setUniformFloatVec4(D.RENDER_EXTENT,oe),this.helper.setUniformFloatValue(D.RESOLUTION,n.resolution),this.helper.setUniformFloatValue(D.ZOOM,n.zoom),this.helper.drawElements(0,this.indices_.getSize())}}this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);for(var _e=this.helper.getCanvas(),cr=this.tileTextureCache_;cr.canExpireCache();){var T=cr.pop();T.dispose()}var hr=function(Fi,fr){a.expireCache(fr.viewState.projection,vv)};return t.postRenderFunctions.push(hr),this.postRender(r,t),_e},e.prototype.getData=function(t){var r=this.helper.getGL();if(!r)return null;var n=this.frameState_;if(!n)return null;var o=this.getLayer(),a=ct(n.pixelToCoordinateTransform,t.slice()),s=n.viewState,l=o.getExtent();if(l&&!fe(Qt(l,s.projection),a))return null;var u=o.getSources(In([a]),s.resolution),c,h,f;for(c=u.length-1;c>=0;--c)if(h=u[c],h.getState()==="ready"){if(f=h.getTileGridForProjection(s.projection),h.getWrapX())break;var p=f.getExtent();if(!p||fe(p,a))break}if(c<0)return null;for(var d=this.tileTextureCache_,v=f.getZForResolution(s.resolution);v>=f.getMinZoom();--v){var g=f.getTileCoordForCoordAndZ(a,v),E=An(h,g);if(d.containsKey(E)){var _=d.get(E);if(_.loaded){var m=f.getOrigin(v),y=gt(f.getTileSize(v)),T=f.getResolution(v),R=(a[0]-m[0])/T-g[1]*y[0],x=(m[1]-a[1])/T-g[2]*y[1];return _.getPixelData(R,x)}}}return null},e.prototype.findAltTiles_=function(t,r,n,o){var a=t.getTileRangeForTileCoordAndZ(r,n,this.tempTileRange_);if(!a)return!1;for(var s=!0,l=this.tileTextureCache_,u=this.getLayer().getRenderSource(),c=a.minX;c<=a.maxX;++c)for(var h=a.minY;h<=a.maxY;++h){var f=An(u,[n,c,h]),p=!1;if(l.containsKey(f)){var d=l.get(f);d.loaded&&(Mo(o,d,n),p=!0)}p||(s=!1)}return s},e.prototype.removeHelper=function(){if(this.helper){var t=this.tileTextureCache_;t.forEach(function(r){return r.dispose()}),t.clear()}i.prototype.removeHelper.call(this)},e.prototype.disposeInternal=function(){var t=this.helper;if(t){var r=t.getGL();r.deleteProgram(this.program_),delete this.program_,t.deleteBuffer(this.indices_)}i.prototype.disposeInternal.call(this),delete this.indices_,delete this.tileTextureCache_,delete this.frameState_},e}(fv);const yv=_v;var mv=function(){function i(e,t){this.name=e,this.data=t,this.texture_=null}return i.prototype.getTexture=function(e){if(!this.texture_){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_},i}();const Ev=mv;var w={NUMBER:1,STRING:2,COLOR:4,BOOLEAN:8,NUMBER_ARRAY:16,ANY:31,NONE:0},N={};function Bt(i){if(typeof i=="number")return w.NUMBER;if(typeof i=="boolean")return w.BOOLEAN;if(typeof i=="string")return Tu(i)?w.COLOR|w.STRING:w.STRING;if(!Array.isArray(i))throw new Error("Unhandled value type: ".concat(JSON.stringify(i)));var e=i,t=e.every(function(n){return typeof n=="number"});if(t)return e.length===3||e.length===4?w.COLOR|w.NUMBER_ARRAY:w.NUMBER_ARRAY;if(typeof e[0]!="string")throw new Error("Expected an expression operator but received: ".concat(JSON.stringify(e)));var r=N[e[0]];if(r===void 0)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(e)));return r.getReturnType(e.slice(1))}function Tv(i){return $o(i)%1===0}function on(i){var e=i.toString();return e.indexOf(".")===-1?e+".0":e}function vs(i){if(i.length<2||i.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return"vec".concat(i.length,"(").concat(i.map(on).join(", "),")")}function Rv(i){var e=Gn(i).slice();return e.length<4&&e.push(1),vs(e.map(function(t,r){return r<3?t/255:t}))}function gs(i,e){return i.stringLiteralsMap[e]===void 0&&(i.stringLiteralsMap[e]=Object.keys(i.stringLiteralsMap).length),i.stringLiteralsMap[e]}function xv(i,e){return on(gs(i,e))}function A(i,e,t){if(Array.isArray(e)&&typeof e[0]=="string"){var r=N[e[0]];if(r===void 0)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(e)));return r.toGlsl(i,e.slice(1),t)}var n=Bt(e);if((n&w.NUMBER)>0)return on(e);if((n&w.BOOLEAN)>0)return e.toString();if((n&w.STRING)>0&&(t===void 0||t==w.STRING))return xv(i,e.toString());if((n&w.COLOR)>0&&(t===void 0||t==w.COLOR))return Rv(e);if((n&w.NUMBER_ARRAY)>0)return vs(e);throw new Error("Unexpected expression ".concat(e," (expected type ").concat(t,")"))}function _s(i){if(!(Bt(i)&w.NUMBER))throw new Error("A numeric value was expected, got ".concat(JSON.stringify(i)," instead"))}function rt(i){for(var e=0;e<i.length;e++)_s(i[e])}function ys(i){if(!(Bt(i)&w.STRING))throw new Error("A string value was expected, got ".concat(JSON.stringify(i)," instead"))}function bi(i){if(!(Bt(i)&w.BOOLEAN))throw new Error("A boolean value was expected, got ".concat(JSON.stringify(i)," instead"))}function W(i,e){if(i.length!==e)throw new Error("Exactly ".concat(e," arguments were expected, got ").concat(i.length," instead"))}function ie(i,e){if(i.length<e)throw new Error("At least ".concat(e," arguments were expected, got ").concat(i.length," instead"))}function an(i,e){if(i.length>e)throw new Error("At most ".concat(e," arguments were expected, got ").concat(i.length," instead"))}function ms(i){if(i.length%2!==0)throw new Error("An even amount of arguments was expected, got ".concat(i," instead"))}function wv(i){if(i.length%2===0)throw new Error("An odd amount of arguments was expected, got ".concat(i," instead"))}function Ni(i,e){if(!Tv(e))throw new Error("Could not infer only one type from the following expression: ".concat(JSON.stringify(i)))}N.get={getReturnType:function(i){return w.ANY},toGlsl:function(i,e){W(e,1),ys(e[0]);var t=e[0].toString();i.attributes.indexOf(t)===-1&&i.attributes.push(t);var r=i.inFragmentShader?"v_":"a_";return r+t}};function Es(i){return"u_var_"+i}N.var={getReturnType:function(i){return w.ANY},toGlsl:function(i,e){W(e,1),ys(e[0]);var t=e[0].toString();return i.variables.indexOf(t)===-1&&i.variables.push(t),Es(t)}};var Ts="u_paletteTextures";N.palette={getReturnType:function(i){return w.COLOR},toGlsl:function(i,e){W(e,2),_s(e[0]);var t=A(i,e[0]),r=e[1];if(!Array.isArray(r))throw new Error("The second argument of palette must be an array");for(var n=r.length,o=new Uint8Array(n*4),a=0;a<n;a++){var s=r[a],l=void 0;if(typeof s=="string")l=ha(s);else{if(!Array.isArray(s))throw new Error("The second argument of palette must be an array of strings or colors");var u=s.length;if(u===4)l=s;else{if(u!==3)throw new Error("Expected palette color to have 3 or 4 values, got ".concat(u));l=[s[0],s[1],s[2],1]}}var c=a*4;o[c]=l[0],o[c+1]=l[1],o[c+2]=l[2],o[c+3]=l[3]*255}i.paletteTextures||(i.paletteTextures=[]);var h="".concat(Ts,"[").concat(i.paletteTextures.length,"]"),f=new Ev(h,o);return i.paletteTextures.push(f),"texture2D(".concat(h,", vec2((").concat(t," + 0.5) / ").concat(n,".0, 0.5))")}};var Pn="getBandValue";N.band={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){ie(e,1),an(e,3);var t=e[0];if(!(Pn in i.functions)){for(var r="",n=i.bandCount||1,o=0;o<n;o++){var a=Math.floor(o/4),s=o%4;s===n-1&&s===1&&(s=3);var l="".concat(D.TILE_TEXTURE_ARRAY,"[").concat(a,"]");r+=`
          if (band == `.concat(o+1,`.0) {
            return texture2D(`).concat(l,", v_textureCoord + vec2(dx, dy))[").concat(s,`];
          }
        `)}i.functions[Pn]=`
        float getBandValue(float band, float xOffset, float yOffset) {
          float dx = xOffset / `.concat(D.TEXTURE_PIXEL_WIDTH,`;
          float dy = yOffset / `).concat(D.TEXTURE_PIXEL_HEIGHT,`;
          `).concat(r,`
        }
      `)}var u=A(i,t),c=A(i,e[1]||0),h=A(i,e[2]||0);return"".concat(Pn,"(").concat(u,", ").concat(c,", ").concat(h,")")}};N.time={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,0),"u_time"}};N.zoom={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,0),"u_zoom"}};N.resolution={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,0),"u_resolution"}};N["*"]={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,2),rt(e),"(".concat(A(i,e[0])," * ").concat(A(i,e[1]),")")}};N["/"]={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,2),rt(e),"(".concat(A(i,e[0])," / ").concat(A(i,e[1]),")")}};N["+"]={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,2),rt(e),"(".concat(A(i,e[0])," + ").concat(A(i,e[1]),")")}};N["-"]={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,2),rt(e),"(".concat(A(i,e[0])," - ").concat(A(i,e[1]),")")}};N.clamp={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){W(e,3),rt(e);var t=A(i,e[1]),r=A(i,e[2]);return"clamp(".concat(A(i,e[0]),", ").concat(t,", ").concat(r,")")}};N["%"]={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,2),rt(e),"mod(".concat(A(i,e[0]),", ").concat(A(i,e[1]),")")}};N["^"]={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,2),rt(e),"pow(".concat(A(i,e[0]),", ").concat(A(i,e[1]),")")}};N.abs={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,1),rt(e),"abs(".concat(A(i,e[0]),")")}};N.floor={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,1),rt(e),"floor(".concat(A(i,e[0]),")")}};N.round={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,1),rt(e),"floor(".concat(A(i,e[0])," + 0.5)")}};N.ceil={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,1),rt(e),"ceil(".concat(A(i,e[0]),")")}};N.sin={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,1),rt(e),"sin(".concat(A(i,e[0]),")")}};N.cos={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return W(e,1),rt(e),"cos(".concat(A(i,e[0]),")")}};N.atan={getReturnType:function(i){return w.NUMBER},toGlsl:function(i,e){return ie(e,1),an(e,2),rt(e),e.length===2?"atan(".concat(A(i,e[0]),", ").concat(A(i,e[1]),")"):"atan(".concat(A(i,e[0]),")")}};N[">"]={getReturnType:function(i){return w.BOOLEAN},toGlsl:function(i,e){return W(e,2),rt(e),"(".concat(A(i,e[0])," > ").concat(A(i,e[1]),")")}};N[">="]={getReturnType:function(i){return w.BOOLEAN},toGlsl:function(i,e){return W(e,2),rt(e),"(".concat(A(i,e[0])," >= ").concat(A(i,e[1]),")")}};N["<"]={getReturnType:function(i){return w.BOOLEAN},toGlsl:function(i,e){return W(e,2),rt(e),"(".concat(A(i,e[0])," < ").concat(A(i,e[1]),")")}};N["<="]={getReturnType:function(i){return w.BOOLEAN},toGlsl:function(i,e){return W(e,2),rt(e),"(".concat(A(i,e[0])," <= ").concat(A(i,e[1]),")")}};function Rs(i){return{getReturnType:function(e){return w.BOOLEAN},toGlsl:function(e,t){W(t,2);for(var r=w.ANY,n=0;n<t.length;n++)r&=Bt(t[n]);if(r===w.NONE)throw new Error("All arguments should be of compatible type, got ".concat(JSON.stringify(t)," instead"));return r&=~w.COLOR,"(".concat(A(e,t[0],r)," ").concat(i," ").concat(A(e,t[1],r),")")}}}N["=="]=Rs("==");N["!="]=Rs("!=");N["!"]={getReturnType:function(i){return w.BOOLEAN},toGlsl:function(i,e){return W(e,1),bi(e[0]),"(!".concat(A(i,e[0]),")")}};function xs(i){return{getReturnType:function(e){return w.BOOLEAN},toGlsl:function(e,t){ie(t,2);for(var r=0;r<t.length;r++)bi(t[r]);var n="";return n=t.map(function(o){return A(e,o)}).join(" ".concat(i," ")),n="(".concat(n,")"),n}}}N.all=xs("&&");N.any=xs("||");N.between={getReturnType:function(i){return w.BOOLEAN},toGlsl:function(i,e){W(e,3),rt(e);var t=A(i,e[1]),r=A(i,e[2]),n=A(i,e[0]);return"(".concat(n," >= ").concat(t," && ").concat(n," <= ").concat(r,")")}};N.array={getReturnType:function(i){return w.NUMBER_ARRAY},toGlsl:function(i,e){ie(e,2),an(e,4),rt(e);var t=e.map(function(r){return A(i,r,w.NUMBER)});return"vec".concat(e.length,"(").concat(t.join(", "),")")}};N.color={getReturnType:function(i){return w.COLOR},toGlsl:function(i,e){ie(e,3),an(e,4),rt(e);var t=e;e.length===3&&t.push(1);var r=e.map(function(n,o){return A(i,n,w.NUMBER)+(o<3?" / 255.0":"")});return"vec".concat(e.length,"(").concat(r.join(", "),")")}};N.interpolate={getReturnType:function(i){for(var e=w.COLOR|w.NUMBER,t=3;t<i.length;t+=2)e=e&Bt(i[t]);return e},toGlsl:function(i,e,t){ms(e),ie(e,6);var r=e[0],n;switch(r[0]){case"linear":n=1;break;case"exponential":n=r[1];break;default:n=null}if(!n)throw new Error('Invalid interpolation type for "interpolate" operator, received: '.concat(JSON.stringify(r)));var o=t!==void 0?t:w.ANY,a=N.interpolate.getReturnType(e)&o;Ni(e,a);for(var s=A(i,e[1]),l=on(n),u="",c=2;c<e.length-2;c+=2){var h=A(i,e[c]),f=u||A(i,e[c+1],a),p=A(i,e[c+2]),d=A(i,e[c+3],a);u="mix(".concat(f,", ").concat(d,", pow(clamp((").concat(s," - ").concat(h,") / (").concat(p," - ").concat(h,"), 0.0, 1.0), ").concat(l,"))")}return u}};N.match={getReturnType:function(i){for(var e=w.ANY,t=2;t<i.length;t+=2)e=e&Bt(i[t]);return e=e&Bt(i[i.length-1]),e},toGlsl:function(i,e,t){ms(e),ie(e,4);var r=t!==void 0?t:w.ANY,n=N.match.getReturnType(e)&r;Ni(e,n);for(var o=A(i,e[0]),a=A(i,e[e.length-1],n),s=null,l=e.length-3;l>=1;l-=2){var u=A(i,e[l]),c=A(i,e[l+1],n);s="(".concat(o," == ").concat(u," ? ").concat(c," : ").concat(s||a,")")}return s}};N.case={getReturnType:function(i){for(var e=w.ANY,t=1;t<i.length;t+=2)e=e&Bt(i[t]);return e=e&Bt(i[i.length-1]),e},toGlsl:function(i,e,t){wv(e),ie(e,3);var r=t!==void 0?t:w.ANY,n=N.case.getReturnType(e)&r;Ni(e,n);for(var o=0;o<e.length-1;o+=2)bi(e[o]);for(var a=A(i,e[e.length-1],n),s=null,o=e.length-3;o>=0;o-=2){var l=A(i,e[o]),u=A(i,e[o+1],n);s="(".concat(l," ? ").concat(u," : ").concat(s||a,")")}return s}};var Cv=globalThis&&globalThis.__extends||function(){var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},i(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();function bo(i,e){var t=`
    attribute vec2 `.concat(Pr.TEXTURE_COORD,`;
    uniform mat4 `).concat(D.TILE_TRANSFORM,`;
    uniform float `).concat(D.TEXTURE_PIXEL_WIDTH,`;
    uniform float `).concat(D.TEXTURE_PIXEL_HEIGHT,`;
    uniform float `).concat(D.TEXTURE_RESOLUTION,`;
    uniform float `).concat(D.TEXTURE_ORIGIN_X,`;
    uniform float `).concat(D.TEXTURE_ORIGIN_Y,`;
    uniform float `).concat(D.DEPTH,`;

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;

    void main() {
      v_textureCoord = `).concat(Pr.TEXTURE_COORD,`;
      v_mapCoord = vec2(
        `).concat(D.TEXTURE_ORIGIN_X," + ").concat(D.TEXTURE_RESOLUTION," * ").concat(D.TEXTURE_PIXEL_WIDTH,` * v_textureCoord[0],
        `).concat(D.TEXTURE_ORIGIN_Y," - ").concat(D.TEXTURE_RESOLUTION," * ").concat(D.TEXTURE_PIXEL_HEIGHT,` * v_textureCoord[1]
      );
      gl_Position = `).concat(D.TILE_TRANSFORM," * vec4(").concat(Pr.TEXTURE_COORD,", ").concat(D.DEPTH,`, 1.0);
    }
  `),r={inFragmentShader:!0,variables:[],attributes:[],stringLiteralsMap:{},functions:{},bandCount:e},n=[];if(i.color!==void 0){var o=A(r,i.color,w.COLOR);n.push("color = ".concat(o,";"))}if(i.contrast!==void 0){var a=A(r,i.contrast,w.NUMBER);n.push("color.rgb = clamp((".concat(a," + 1.0) * color.rgb - (").concat(a," / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(i.exposure!==void 0){var s=A(r,i.exposure,w.NUMBER);n.push("color.rgb = clamp((".concat(s," + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(i.saturation!==void 0){var l=A(r,i.saturation,w.NUMBER);n.push(`
      float saturation = `.concat(l,` + 1.0;
      float sr = (1.0 - saturation) * 0.2126;
      float sg = (1.0 - saturation) * 0.7152;
      float sb = (1.0 - saturation) * 0.0722;
      mat3 saturationMatrix = mat3(
        sr + saturation, sr, sr,
        sg, sg + saturation, sg,
        sb, sb, sb + saturation
      );
      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));
    `))}if(i.gamma!==void 0){var u=A(r,i.gamma,w.NUMBER);n.push("color.rgb = pow(color.rgb, vec3(1.0 / ".concat(u,"));"))}if(i.brightness!==void 0){var c=A(r,i.brightness,w.NUMBER);n.push("color.rgb = clamp(color.rgb + ".concat(c,", vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}var h={},f=r.variables.length;if(f>1&&!i.variables)throw new Error("Missing variables in style (expected ".concat(r.variables,")"));for(var p=function(m){var y=r.variables[m];if(!(y in i.variables))throw new Error("Missing '".concat(y,"' in style variables"));var T=Es(y);h[T]=function(){var R=i.variables[y];return typeof R=="string"&&(R=gs(r,R)),R!==void 0?R:-9999999}},d=0;d<f;++d)p(d);var v=Object.keys(h).map(function(m){return"uniform float ".concat(m,";")}),g=Math.ceil(e/4);v.push("uniform sampler2D ".concat(D.TILE_TEXTURE_ARRAY,"[").concat(g,"];")),r.paletteTextures&&v.push("uniform sampler2D ".concat(Ts,"[").concat(r.paletteTextures.length,"];"));var E=Object.keys(r.functions).map(function(m){return r.functions[m]}),_=`
    #ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    #else
    precision mediump float;
    #endif

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;
    uniform vec4 `.concat(D.RENDER_EXTENT,`;
    uniform float `).concat(D.TRANSITION_ALPHA,`;
    uniform float `).concat(D.TEXTURE_PIXEL_WIDTH,`;
    uniform float `).concat(D.TEXTURE_PIXEL_HEIGHT,`;
    uniform float `).concat(D.RESOLUTION,`;
    uniform float `).concat(D.ZOOM,`;

    `).concat(v.join(`
`),`

    `).concat(E.join(`
`),`

    void main() {
      if (
        v_mapCoord[0] < `).concat(D.RENDER_EXTENT,`[0] ||
        v_mapCoord[1] < `).concat(D.RENDER_EXTENT,`[1] ||
        v_mapCoord[0] > `).concat(D.RENDER_EXTENT,`[2] ||
        v_mapCoord[1] > `).concat(D.RENDER_EXTENT,`[3]
      ) {
        discard;
      }

      vec4 color = texture2D(`).concat(D.TILE_TEXTURE_ARRAY,`[0],  v_textureCoord);

      `).concat(n.join(`
`),`

      if (color.a == 0.0) {
        discard;
      }

      gl_FragColor = color;
      gl_FragColor.rgb *= gl_FragColor.a;
      gl_FragColor *= `).concat(D.TRANSITION_ALPHA,`;
    }`);return{vertexShader:t,fragmentShader:_,uniforms:h,paletteTextures:r.paletteTextures}}var ws=function(i){Cv(e,i);function e(t){var r=this,n=t?tt({},t):{},o=n.style||{};delete n.style;var a=n.cacheSize;return delete n.cacheSize,r=i.call(this,n)||this,r.sources_=n.sources,r.renderedSource_=null,r.renderedResolution_=NaN,r.style_=o,r.cacheSize_=a,r.styleVariables_=r.style_.variables||{},r.addChangeListener(z.SOURCE,r.handleSourceUpdate_),r}return e.prototype.getSources=function(t,r){var n=this.getSource();return this.sources_?typeof this.sources_=="function"?this.sources_(t,r):this.sources_:n?[n]:[]},e.prototype.getRenderSource=function(){return this.renderedSource_||this.getSource()},e.prototype.getSourceState=function(){var t=this.getRenderSource();return t?t.getState():"undefined"},e.prototype.handleSourceUpdate_=function(){this.getSource()&&this.setStyle(this.style_)},e.prototype.getSourceBandCount_=function(){var t=Number.MAX_SAFE_INTEGER,r=this.getSources([-t,-t,t,t],t);return r&&r.length&&"bandCount"in r[0]?r[0].bandCount:4},e.prototype.createRenderer=function(){var t=bo(this.style_,this.getSourceBandCount_());return new yv(this,{vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,cacheSize:this.cacheSize_,paletteTextures:t.paletteTextures})},e.prototype.renderSources=function(t,r){for(var n=this.getRenderer(),o,a=0,s=r.length;a<s;++a)this.renderedSource_=r[a],n.prepareFrame(t)&&(o=n.renderFrame(t));return o},e.prototype.render=function(t,r){var n=this;this.rendered=!0;for(var o=t.viewState,a=this.getSources(t.extent,o.resolution),s=!0,l=function(p,d){var v=a[p],g=v.getState();if(g=="loading"){var E=function(){v.getState()=="ready"&&(v.removeEventListener("change",E),n.changed())};v.addEventListener("change",E)}s=s&&g=="ready"},u=0,c=a.length;u<c;++u)l(u);var h=this.renderSources(t,a);if(this.getRenderer().renderComplete&&s)return this.renderedResolution_=o.resolution,h;if(this.renderedResolution_>.5*o.resolution){var f=this.getSources(t.extent,this.renderedResolution_).filter(function(p){return!a.includes(p)});if(f.length>0)return this.renderSources(t,f)}return h},e.prototype.setStyle=function(t){this.styleVariables_=t.variables||{},this.style_=t;var r=bo(this.style_,this.getSourceBandCount_()),n=this.getRenderer();n.reset({vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms,paletteTextures:r.paletteTextures}),this.changed()},e.prototype.updateStyleVariables=function(t){tt(this.styleVariables_,t),this.changed()},e}(Pa);ws.prototype.dispose;const Ov=ws,Av=new pf({source:new Gf}),Pv=new Ov({source:new Xd({sources:[{url:"fl_radiance_2015_01_01.tif"}]})});new Kh({target:"map",layers:[Av,Pv],view:new qt({center:[0,0],zoom:2})});export{jv as L,Bv as a,mi as g};
//# sourceMappingURL=index-5705e743.js.map
